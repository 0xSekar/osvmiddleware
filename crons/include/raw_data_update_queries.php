<?php
function update_raw_data_tickers($dates, $rawdata) {
	$report_tables = array("reports_balanceconsolidated","reports_balancefull","reports_cashflowconsolidated","reports_cashflowfull","reports_financialheader","reports_gf_data","reports_incomeconsolidated","reports_incomefull","reports_metadata_eol","reports_variable_ratios","reports_financialscustom","reports_key_ratios");
	$ticker_tables = array("tickers_activity_daily_ratios", "tickers_growth_ratios", "tickers_leverage_ratios", "tickers_metadata_eol", "tickers_mini_ratios", "tickers_profitability_ratios", "tickers_valuation_ratios");
	$ttm_tables = array("ttm_balanceconsolidated","ttm_balancefull","ttm_cashflowconsolidated","ttm_cashflowfull","ttm_incomeconsolidated","ttm_incomefull","ttm_financialscustom", "ttm_gf_data");
	$pttm_tables = array("pttm_balanceconsolidated","pttm_balancefull","pttm_cashflowconsolidated","pttm_cashflowfull","pttm_incomeconsolidated","pttm_incomefull","pttm_financialscustom", "pttm_gf_data");

        //Delete all reports before updating to be sure we do not miss any manual update
        //as this is a batch process, it will not impact on the UE
        foreach($report_tables as $table) {
                $query = "DELETE FROM $table WHERE report_id IN (SELECT id FROM reports_header WHERE ticker_id = ".$dates->ticker_id.")";
                mysql_query($query) or die (mysql_error());
        }
        $query = "DELETE FROM reports_header WHERE ticker_id = ".$dates->ticker_id;
        mysql_query($query) or die (mysql_error());
        foreach($ticker_tables as $table) {
                $query = "DELETE FROM $table WHERE ticker_id = ".$dates->ticker_id;
                mysql_query($query) or die (mysql_error());
        }
        foreach($ttm_tables as $table) {
                $query = "DELETE FROM $table WHERE ticker_id = ".$dates->ticker_id;
                mysql_query($query) or die (mysql_error());
        }
        foreach($pttm_tables as $table) {
                $query = "DELETE FROM $table WHERE ticker_id = ".$dates->ticker_id;
                mysql_query($query) or die (mysql_error());
        }

        //Update tickers_* tables (tables that hold only 1 data point per symbol)
        //tickers_activity_daily_ratios
        $query = "INSERT INTO `tickers_activity_daily_ratios` (`ticker_id`, `AccountsPayableTurnoverDaysFY`, `TradeCycleDaysFY`, `TradeCycleDaysTTM`, `AccountsPayableTurnoverDaysTTM`, `InventoryTurnoverDaysFY`, `InventoryTurnoverDaysTTM`, `NetOperatingProfitafterTaxFQ`, `NetOperatingProfitafterTaxFY`, `NetOperatingProfitafterTaxTTM`, `ReceivablesCollectionPeriodDaysFY`, `ReceivablesCollectionPeriodDaysTTM`, `TaxRatePctFQ`, `TaxRatePctFY`, `TaxRatePctTTM`, `Volume`, `AverageVolume`, `Beta1Year`, `Beta3Year`, `Beta5Year`, `Date52WeekHigh`, `Date52WeekLow`, `DatePreviousClose`, `DatePriceClose`, `PreviousVolume`, `Price52WeekHigh`, `Price52WeekLow`, `PriceClose`, `PricePctChange13Week`, `PricePctChange1Day`, `PricePctChange1Week`, `PricePctChange26Week`, `PricePctChange4Week`, `PricePctChange52Week`, `PricePctChangeYTD`, `PricePreviousClose`) VALUES (";
        $query .= "'".$dates->ticker_id."',";
        $query .= "'".$rawdata["AccountsPayableTurnoverDaysFY"][26]."',";
        $query .= "'".$rawdata["TradeCycleDaysFY"][26]."',";
        $query .= "'".$rawdata["TradeCycleDaysTTM"][26]."',";
        $query .= "'".$rawdata["AccountsPayableTurnoverDaysTTM"][26]."',";
        $query .= "'".$rawdata["InventoryTurnoverDaysFY"][26]."',";
        $query .= "'".$rawdata["InventoryTurnoverDaysTTM"][26]."',";
        $query .= "'".$rawdata["NetOperatingProfitafterTaxFQ"][26]."',";
        $query .= "'".$rawdata["NetOperatingProfitafterTaxFY"][26]."',";
        $query .= "'".$rawdata["NetOperatingProfitafterTaxTTM"][26]."',";
        $query .= "'".$rawdata["ReceivablesCollectionPeriodDaysFY"][26]."',";
        $query .= "'".$rawdata["ReceivablesCollectionPeriodDaysTTM"][26]."',";
        $query .= "'".$rawdata["TaxRatePctFQ"][26]."',";
        $query .= "'".$rawdata["TaxRatePctFY"][26]."',";
        $query .= "'".$rawdata["TaxRatePctTTM"][26]."',";
        $query .= "'".$rawdata["Volume"][26]."',";
        $query .= "'".$rawdata["AverageVolume"][26]."',";
        $query .= "'".$rawdata["Beta1Year"][26]."',";
        $query .= "'".$rawdata["Beta3Year"][26]."',";
        $query .= "'".$rawdata["Beta5Year"][26]."',";
        $query .= "'".date("Y-m-d",strtotime($rawdata["Date52WeekHigh"][26]))."',";
        $query .= "'".date("Y-m-d",strtotime($rawdata["Date52WeekLow"][26]))."',";
        $query .= "'".date("Y-m-d",strtotime($rawdata["DatePreviousClose"][26]))."',";
        $query .= "'".date("Y-m-d",strtotime($rawdata["DatePriceClose"][26]))."',";
        $query .= "'".$rawdata["PreviousVolume"][26]."',";
        $query .= "'".$rawdata["Price52WeekHigh"][26]."',";
        $query .= "'".$rawdata["Price52WeekLow"][26]."',";
        $query .= "'".$rawdata["PriceClose"][26]."',";
        $query .= "'".$rawdata["PricePctChange13Week"][26]."',";
        $query .= "'".$rawdata["PricePctChange1Day"][26]."',";
        $query .= "'".$rawdata["PricePctChange1Week"][26]."',";
        $query .= "'".$rawdata["PricePctChange26Week"][26]."',";
        $query .= "'".$rawdata["PricePctChange4Week"][26]."',";
        $query .= "'".$rawdata["PricePctChange52Week"][26]."',";
        $query .= "'".$rawdata["PricePctChangeYTD"][26]."',";
        $query .= "'".$rawdata["PricePreviousClose"][26]."'";
        $query .= ")";
        mysql_query($query) or die (mysql_error());
        //tickers_growth_ratios
        $query = "INSERT INTO `tickers_growth_ratios` (`ticker_id`, `AdjustedEBITDAPctGrowth3YearCAGRFY`, `AdjustedEBITDAPctGrowth5YearCAGRFY`, `AdjustedEBITDAPctGrowthFY`, `AdjustedEBITDAPctGrowthTTM`, `EBITDAPctGrowth3YearCAGRFY`, `EBITDAPctGrowth5YearCAGRFY`, `EBITDAPctGrowthFY`, `EBITDAPctGrowthTTM`, `EBITPctGrowth3YearCAGRFY`, `EBITPctGrowth5YearCAGRFY`, `EBITPctGrowthFY`, `EBITPctGrowthTTM`, `FreeCashFlowPctGrowth3YearCAGRFY`, `FreeCashFlowPctGrowth5YearCAGRFY`, `FreeCashFlowPctGrowthFY`, `FreeCashFlowPctGrowthTTM`, `NetIncomePctGrowth3YearCAGRFY`, `NetIncomePctGrowth5YearCAGRFY`, `NetIncomePctGrowthFY`, `NetIncomePctGrowthTTM`, `OperatingCashFlowPctGrowth3YearCAGRFY`, `OperatingCashFlowPctGrowth5YearCAGRFY`, `OperatingCashFlowPctGrowthFY`, `OperatingCashFlowPctGrowthTTM`, `OperatingProfitPctGrowth3YearCAGRFY`, `OperatingProfitPctGrowth5YearCAGRFY`, `OperatingProfitPctGrowthFY`, `OperatingProfitPctGrowthTTM`, `PriceEarningstoGrowthFY`, `PriceEarningstoGrowthTTM`, `RevenuePctGrowth3YearCAGRFY`, `RevenuePctGrowth5YearCAGRFY`, `RevenuePctGrowthFY`, `RevenuePctGrowthTTM`) VALUES (";
        $query .= "'".$dates->ticker_id."',";
        $query .= "'".$rawdata["AdjustedEBITDAPctGrowth3YearCAGRFY"][26]."',";
        $query .= "'".$rawdata["AdjustedEBITDAPctGrowth5YearCAGRFY"][26]."',";
        $query .= "'".$rawdata["AdjustedEBITDAPctGrowthFY"][26]."',";
        $query .= "'".$rawdata["AdjustedEBITDAPctGrowthTTM"][26]."',";
        $query .= "'".$rawdata["EBITDAPctGrowth3YearCAGRFY"][26]."',";
        $query .= "'".$rawdata["EBITDAPctGrowth5YearCAGRFY"][26]."',";
        $query .= "'".$rawdata["EBITDAPctGrowthFY"][26]."',";
        $query .= "'".$rawdata["EBITDAPctGrowthTTM"][26]."',";
        $query .= "'".$rawdata["EBITPctGrowth3YearCAGRFY"][26]."',";
        $query .= "'".$rawdata["EBITPctGrowth5YearCAGRFY"][26]."',";
        $query .= "'".$rawdata["EBITPctGrowthFY"][26]."',";
        $query .= "'".$rawdata["EBITPctGrowthTTM"][26]."',";
        $query .= "'".$rawdata["FreeCashFlowPctGrowth3YearCAGRFY"][26]."',";
        $query .= "'".$rawdata["FreeCashFlowPctGrowth5YearCAGRFY"][26]."',";
        $query .= "'".$rawdata["FreeCashFlowPctGrowthFY"][26]."',";
        $query .= "'".$rawdata["FreeCashFlowPctGrowthTTM"][26]."',";
        $query .= "'".$rawdata["NetIncomePctGrowth3YearCAGRFY"][26]."',";
        $query .= "'".$rawdata["NetIncomePctGrowth5YearCAGRFY"][26]."',";
        $query .= "'".$rawdata["NetIncomePctGrowthFY"][26]."',";
        $query .= "'".$rawdata["NetIncomePctGrowthTTM"][26]."',";
        $query .= "'".$rawdata["OperatingCashFlowPctGrowth3YearCAGRFY"][26]."',";
        $query .= "'".$rawdata["OperatingCashFlowPctGrowth5YearCAGRFY"][26]."',";
        $query .= "'".$rawdata["OperatingCashFlowPctGrowthFY"][26]."',";
        $query .= "'".$rawdata["OperatingCashFlowPctGrowthTTM"][26]."',";
        $query .= "'".$rawdata["OperatingProfitPctGrowth3YearCAGRFY"][26]."',";
        $query .= "'".$rawdata["OperatingProfitPctGrowth5YearCAGRFY"][26]."',";
        $query .= "'".$rawdata["OperatingProfitPctGrowthFY"][26]."',";
        $query .= "'".$rawdata["OperatingProfitPctGrowthTTM"][26]."',";
        $query .= "'".$rawdata["PriceEarningstoGrowthFY"][26]."',";
        $query .= "'".$rawdata["PriceEarningstoGrowthTTM"][26]."',";
        $query .= "'".$rawdata["RevenuePctGrowth3YearCAGRFY"][26]."',";
        $query .= "'".$rawdata["RevenuePctGrowth5YearCAGRFY"][26]."',";
        $query .= "'".$rawdata["RevenuePctGrowthFY"][26]."',";
        $query .= "'".$rawdata["RevenuePctGrowthTTM"][26]."'";
        $query .= ")";
        mysql_query($query) or die (mysql_error());
        //tickers_leverage_ratios
	$query = "INSERT INTO `tickers_leverage_ratios` (`ticker_id`, `TotalCapitalFY`, `TotalDebtFQ`, `TotalDebtFY`, `AltmanZscoreFY`, `AltmanZscoreTTM`, `BookEquityFQ`, `BookEquityFY`, `DebttoAssetsFQ`, `DebttoAssetsFY`, `DegreeofCombinedLeverageFY`, `DegreeofCombinedLeverageTTM`, `DegreeofFinancialLeverageFY`, `DegreeofFinancialLeverageTTM`, `DegreeofOperationalLeverageFY`, `DegreeofOperationalLeverageTTM`, `FreeCashFlowFQ`, `FreeCashFlowFY`, `FreeCashFlowtoEquityPctFY`, `FreeCashFlowtoEquityPctTTM`, `FreeCashFlowTTM`, `LongTermCapitalFQ`, `LongTermCapitalFY`, `LongTermDebttoLongTermCapitalFQ`, `LongTermDebttoLongTermCapitalFY`, `LongTermDebttoTotalCapitalFQ`, `LongTermDebttoTotalCapitalFY`, `NetDebtFQ`, `NetDebtFY`, `OperatingCashFlowFQ`, `OperatingCashFlowFY`, `OperatingCashFlowTTM`, `TotalCapitalFQ`) VALUES (";
        $query .= "'".$dates->ticker_id."',";
        $query .= "'".$rawdata["TotalCapitalFY"][26]."',";
        $query .= "'".$rawdata["TotalDebtFQ"][26]."',";
        $query .= "'".$rawdata["TotalDebtFY"][26]."',";
        $query .= "'".$rawdata["AltmanZscoreFY"][26]."',";
        $query .= "'".$rawdata["AltmanZscoreTTM"][26]."',";
        $query .= "'".$rawdata["BookEquityFQ"][26]."',";
        $query .= "'".$rawdata["BookEquityFY"][26]."',";
        $query .= "'".$rawdata["DebttoAssetsFQ"][26]."',";
        $query .= "'".$rawdata["DebttoAssetsFY"][26]."',";
        $query .= "'".$rawdata["DegreeofCombinedLeverageFY"][26]."',";
        $query .= "'".$rawdata["DegreeofCombinedLeverageTTM"][26]."',";
        $query .= "'".$rawdata["DegreeofFinancialLeverageFY"][26]."',";
        $query .= "'".$rawdata["DegreeofFinancialLeverageTTM"][26]."',";
        $query .= "'".$rawdata["DegreeofOperationalLeverageFY"][26]."',";
        $query .= "'".$rawdata["DegreeofOperationalLeverageTTM"][26]."',";
        $query .= "'".$rawdata["FreeCashFlowFQ"][26]."',";
        $query .= "'".$rawdata["FreeCashFlowFY"][26]."',";
        $query .= "'".$rawdata["FreeCashFlowtoEquityPctFY"][26]."',";
        $query .= "'".$rawdata["FreeCashFlowtoEquityPctTTM"][26]."',";
        $query .= "'".$rawdata["FreeCashFlowTTM"][26]."',";
        $query .= "'".$rawdata["LongTermCapitalFQ"][26]."',";
        $query .= "'".$rawdata["LongTermCapitalFY"][26]."',";
        $query .= "'".$rawdata["LongTermDebttoLongTermCapitalFQ"][26]."',";
        $query .= "'".$rawdata["LongTermDebttoLongTermCapitalFY"][26]."',";
        $query .= "'".$rawdata["LongTermDebttoTotalCapitalFQ"][26]."',";
        $query .= "'".$rawdata["LongTermDebttoTotalCapitalFY"][26]."',";
        $query .= "'".$rawdata["NetDebtFQ"][26]."',";
        $query .= "'".$rawdata["NetDebtFY"][26]."',";
        $query .= "'".$rawdata["OperatingCashFlowFQ"][26]."',";
        $query .= "'".$rawdata["OperatingCashFlowFY"][26]."',";
        $query .= "'".$rawdata["OperatingCashFlowTTM"][26]."',";
        $query .= "'".$rawdata["TotalCapitalFQ"][26]."'";
        $query .= ")";
        mysql_query($query) or die (mysql_error());
	//tickers_mini_ratios
	$query = "INSERT INTO `tickers_mini_ratios` (`ticker_id`, `DebttoEquityFQ`, `DebttoEquityFY`, `MarketCapBasic`, `MarketCapDiluted`, `MarketCapTSO`, `PriceBookFQ`, `PriceBookFY`, `PriceEarningsFY`, `PriceEarningsTTM`, `GrossMarginPctFQ`, `GrossMarginPctFY`, `GrossMarginPctTTM`, `OperatingMarginPctFQ`, `OperatingMarginPctFY`, `OperatingMarginPctTTM`, `CashRatioFQ`, `CashRatioFY`, `NetWorkingCapitalFQ`, `NetWorkingCapitalFY`, `CurrentRatioFQ`, `CurrentRatioFY`, `QuickRatioFQ`, `QuickRatioFY`) VALUES (";
        $query .= "'".$dates->ticker_id."',";
        $query .= "'".$rawdata["DebttoEquityFQ"][26]."',";
        $query .= "'".$rawdata["DebttoEquityFY"][26]."',";
        $query .= "'".$rawdata["MarketCapBasic"][26]."',";
        $query .= "'".$rawdata["MarketCapDiluted"][26]."',";
        $query .= "'".$rawdata["MarketCapTSO"][26]."',";
        $query .= "'".$rawdata["PriceBookFQ"][26]."',";
        $query .= "'".$rawdata["PriceBookFY"][26]."',";
        $query .= "'".$rawdata["PriceEarningsFY"][26]."',";
        $query .= "'".$rawdata["PriceEarningsTTM"][26]."',";
        $query .= "'".$rawdata["GrossMarginPctFQ"][26]."',";
        $query .= "'".$rawdata["GrossMarginPctFY"][26]."',";
        $query .= "'".$rawdata["GrossMarginPctTTM"][26]."',";
        $query .= "'".$rawdata["OperatingMarginPctFQ"][26]."',";
        $query .= "'".$rawdata["OperatingMarginPctFY"][26]."',";
        $query .= "'".$rawdata["OperatingMarginPctTTM"][26]."',";
        $query .= "'".$rawdata["CashRatioFQ"][26]."',";
        $query .= "'".$rawdata["CashRatioFY"][26]."',";
        $query .= "'".$rawdata["NetWorkingCapitalFQ"][26]."',";
        $query .= "'".$rawdata["NetWorkingCapitalFY"][26]."',";
        $query .= "'".$rawdata["CurrentRatioFQ"][26]."',";
        $query .= "'".$rawdata["CurrentRatioFY"][26]."',";
        $query .= "'".$rawdata["QuickRatioFQ"][26]."',";
        $query .= "'".$rawdata["QuickRatioFY"][26]."'";
        $query .= ")";
        mysql_query($query) or die (mysql_error());
	//tickers_profitability_ratios
	$query = "INSERT INTO `tickers_profitability_ratios` (`ticker_id`, `AdjustedEBITDAFQ`, `AdjustedEBITDAFY`, `AdjustedEBITDATTM`, `AdjustedEBITFQ`, `AdjustedEBITFY`, `AdjustedEBITPctGrowth3YearCAGRFY`, `AdjustedEBITPctGrowth5YearCAGRFY`, `AdjustedEBITPctGrowthFY`, `AdjustedEBITPctGrowthTTM`, `AdjustedEBITTTM`, `AdjustedNetIncomeFQ`, `AdjustedNetIncomeFY`, `AdjustedNetIncomePctGrowth3YearCAGRFY`, `AdjustedNetIncomePctGrowth5YearCAGRFY`, `AdjustedNetIncomePctGrowthFY`, `AdjustedNetIncomePctGrowthTTM`, `AdjustedNetIncomeTTM`, `AftertaxMarginPctFQ`, `AftertaxMarginPctFY`, `AftertaxMarginPctTTM`, `EBITDAFQ`, `EBITDAFY`, `EBITDATTM`, `EBITFQ`, `EBITFY`, `EBITTTM`, `FreeCashFlowMarginPctFQ`, `FreeCashFlowMarginPctFY`, `FreeCashFlowMarginPctTTM`, `FreeCashFlowReturnonAssetsPctFY`, `FreeCashFlowReturnonAssetsPctTTM`, `NetIncomeperEmployeeFY`, `NetIncomeperEmployeeTTM`, `PretaxMarginPctFQ`, `PretaxMarginPctFY`, `PretaxMarginPctTTM`, `ReturnonAssetsPctFY`, `ReturnonAssetsPctTTM`, `ReturnonEquityPctFY`, `ReturnonEquityPctTTM`, `ReturnonInvestedCapitalPctFY`, `ReturnonInvestedCapitalPctTTM`, `RevenueperEmployeeFY`, `RevenueperEmployeeTTM`) VALUES (";
        $query .= "'".$dates->ticker_id."',";
        $query .= "'".$rawdata["AdjustedEBITDAFQ"][26]."',";
        $query .= "'".$rawdata["AdjustedEBITDAFY"][26]."',";
        $query .= "'".$rawdata["AdjustedEBITDATTM"][26]."',";
        $query .= "'".$rawdata["AdjustedEBITFQ"][26]."',";
        $query .= "'".$rawdata["AdjustedEBITFY"][26]."',";
        $query .= "'".$rawdata["AdjustedEBITPctGrowth3YearCAGRFY"][26]."',";
        $query .= "'".$rawdata["AdjustedEBITPctGrowth5YearCAGRFY"][26]."',";
        $query .= "'".$rawdata["AdjustedEBITPctGrowthFY"][26]."',";
        $query .= "'".$rawdata["AdjustedEBITPctGrowthTTM"][26]."',";
        $query .= "'".$rawdata["AdjustedEBITTTM"][26]."',";
        $query .= "'".$rawdata["AdjustedNetIncomeFQ"][26]."',";
        $query .= "'".$rawdata["AdjustedNetIncomeFY"][26]."',";
        $query .= "'".$rawdata["AdjustedNetIncomePctGrowth3YearCAGRFY"][26]."',";
        $query .= "'".$rawdata["AdjustedNetIncomePctGrowth5YearCAGRFY"][26]."',";
        $query .= "'".$rawdata["AdjustedNetIncomePctGrowthFY"][26]."',";
        $query .= "'".$rawdata["AdjustedNetIncomePctGrowthTTM"][26]."',";
        $query .= "'".$rawdata["AdjustedNetIncomeTTM"][26]."',";
        $query .= "'".$rawdata["AftertaxMarginPctFQ"][26]."',";
        $query .= "'".$rawdata["AftertaxMarginPctFY"][26]."',";
        $query .= "'".$rawdata["AftertaxMarginPctTTM"][26]."',";
        $query .= "'".$rawdata["EBITDAFQ"][26]."',";
        $query .= "'".$rawdata["EBITDAFY"][26]."',";
        $query .= "'".$rawdata["EBITDATTM"][26]."',";
        $query .= "'".$rawdata["EBITFQ"][26]."',";
        $query .= "'".$rawdata["EBITFY"][26]."',";
        $query .= "'".$rawdata["EBITTTM"][26]."',";
        $query .= "'".$rawdata["FreeCashFlowMarginPctFQ"][26]."',";
        $query .= "'".$rawdata["FreeCashFlowMarginPctFY"][26]."',";
        $query .= "'".$rawdata["FreeCashFlowMarginPctTTM"][26]."',";
        $query .= "'".$rawdata["FreeCashFlowReturnonAssetsPctFY"][26]."',";
        $query .= "'".$rawdata["FreeCashFlowReturnonAssetsPctTTM"][26]."',";
        $query .= "'".$rawdata["NetIncomeperEmployeeFY"][26]."',";
        $query .= "'".$rawdata["NetIncomeperEmployeeTTM"][26]."',";
        $query .= "'".$rawdata["PretaxMarginPctFQ"][26]."',";
        $query .= "'".$rawdata["PretaxMarginPctFY"][26]."',";
        $query .= "'".$rawdata["PretaxMarginPctTTM"][26]."',";
        $query .= "'".$rawdata["ReturnonAssetsPctFY"][26]."',";
        $query .= "'".$rawdata["ReturnonAssetsPctTTM"][26]."',";
        $query .= "'".$rawdata["ReturnonEquityPctFY"][26]."',";
        $query .= "'".$rawdata["ReturnonEquityPctTTM"][26]."',";
        $query .= "'".$rawdata["ReturnonInvestedCapitalPctFY"][26]."',";
        $query .= "'".$rawdata["ReturnonInvestedCapitalPctTTM"][26]."',";
        $query .= "'".$rawdata["RevenueperEmployeeFY"][26]."',";
        $query .= "'".$rawdata["RevenueperEmployeeTTM"][26]."'";
        $query .= ")";
        mysql_query($query) or die (mysql_error());
	//tickers_valuation_ratios
	$query = "INSERT INTO `tickers_valuation_ratios` (`ticker_id`, `TotalEquityFQ`, `TotalEquityFY`, `EarningsperShareNormalizedDilutedFQ`, `EarningsperShareNormalizedDilutedFY`, `EarningsperShareNormalizedDilutedTTM`, `AdjustedEPSDilutedPctGrowth3YearCAGRFY`, `AdjustedEPSDilutedPctGrowth5YearCAGRFY`, `AdjustedEPSDilutedPctGrowthFY`, `AdjustedEPSDilutedPctGrowthTTM`, `BasicAverageShares`, `DilutedAverageShares`, `DividendsperShareFQ`, `DividendsperShareFY`, `DividendsperShareTTM`, `EarningsperShareBasicFQ`, `EarningsperShareBasicFY`, `EarningsperShareBasicTTM`, `EarningsperShareDilutedFQ`, `EarningsperShareDilutedFY`, `EarningsperShareDilutedTTM`, `EnterpriseValueEBITDAFY`, `EnterpriseValueEBITDATTM`, `EnterpriseValueEBITFY`, `EnterpriseValueEBITTTM`, `EnterpriseValueFQ`, `EnterpriseValueFY`, `ExpectedAnnualDividends`, `PriceBookExclIntangiblesFQ`, `PriceBookExclIntangiblesFY`, `PriceEarningsNormalizedFY`, `PriceEarningsNormalizedTTM`, `PriceFreeCashFlowFY`, `PriceFreeCashFlowTTM`, `PriceRevenueFY`, `PriceRevenueTTM`) VALUES (";
        $query .= "'".$dates->ticker_id."',";
        $query .= "'".$rawdata["TotalEquityFQ"][26]."',";
        $query .= "'".$rawdata["TotalEquityFY"][26]."',";
        $query .= "'".$rawdata["EarningsperShareNormalizedDilutedFQ"][26]."',";
        $query .= "'".$rawdata["EarningsperShareNormalizedDilutedFY"][26]."',";
        $query .= "'".$rawdata["EarningsperShareNormalizedDilutedTTM"][26]."',";
        $query .= "'".$rawdata["AdjustedEPSDilutedPctGrowth3YearCAGRFY"][26]."',";
        $query .= "'".$rawdata["AdjustedEPSDilutedPctGrowth5YearCAGRFY"][26]."',";
        $query .= "'".$rawdata["AdjustedEPSDilutedPctGrowthFY"][26]."',";
        $query .= "'".$rawdata["AdjustedEPSDilutedPctGrowthTTM"][26]."',";
        $query .= "'".$rawdata["BasicAverageShares"][26]."',";
        $query .= "'".$rawdata["DilutedAverageShares"][26]."',";
        $query .= "'".$rawdata["DividendsperShareFQ"][26]."',";
        $query .= "'".$rawdata["DividendsperShareFY"][26]."',";
        $query .= "'".$rawdata["DividendsperShareTTM"][26]."',";
        $query .= "'".$rawdata["EarningsperShareBasicFQ"][26]."',";
        $query .= "'".$rawdata["EarningsperShareBasicFY"][26]."',";
        $query .= "'".$rawdata["EarningsperShareBasicTTM"][26]."',";
        $query .= "'".$rawdata["EarningsperShareDilutedFQ"][26]."',";
        $query .= "'".$rawdata["EarningsperShareDilutedFY"][26]."',";
        $query .= "'".$rawdata["EarningsperShareDilutedTTM"][26]."',";
        $query .= "'".$rawdata["EnterpriseValueEBITDAFY"][26]."',";
        $query .= "'".$rawdata["EnterpriseValueEBITDATTM"][26]."',";
        $query .= "'".$rawdata["EnterpriseValueEBITFY"][26]."',";
        $query .= "'".$rawdata["EnterpriseValueEBITTTM"][26]."',";
        $query .= "'".$rawdata["EnterpriseValueFQ"][26]."',";
        $query .= "'".$rawdata["EnterpriseValueFY"][26]."',";
        $query .= "'".$rawdata["ExpectedAnnualDividends"][26]."',";
        $query .= "'".$rawdata["PriceBookExclIntangiblesFQ"][26]."',";
        $query .= "'".$rawdata["PriceBookExclIntangiblesFY"][26]."',";
        $query .= "'".$rawdata["PriceEarningsNormalizedFY"][26]."',";
        $query .= "'".$rawdata["PriceEarningsNormalizedTTM"][26]."',";
        $query .= "'".$rawdata["PriceFreeCashFlowFY"][26]."',";
        $query .= "'".$rawdata["PriceFreeCashFlowTTM"][26]."',";
        $query .= "'".$rawdata["PriceRevenueFY"][26]."',";
        $query .= "'".$rawdata["PriceRevenueTTM"][26]."'";
        $query .= ")";
        mysql_query($query) or die (mysql_error());
	//tickers_metadata_eol
	$query = "INSERT INTO `tickers_metadata_eol` (`ticker_id`, `TotalSharesOutstandingDate`, `BusinessDescription`, `CITY`, `Country`, `Formername`, `Industry`, `InvRelationsEmail`, `LastAnnualEPS`, `LastAnnualNetIncome`, `LastAnnualRevenue`, `LastAnnualTotalAssets`, `PhoneAreaCode`, `PhoneCountryCode`, `PhoneNumber`, `PublicFloat`, `PublicFloatDate`, `Sector`, `State`, `StateofIncorporation`, `StreetAddress1`, `StreetAddress2`, `TaxID`, `WebSiteURL`, `ZipCode`) VALUES (";
        $query .= "'".$dates->ticker_id."',";
        $query .= "'".date("Y-m-d",strtotime($rawdata["TotalSharesOutstandingDate"][26]))."',";
        $query .= "'".$rawdata["BusinessDescription"][26]."',";
        $query .= "'".$rawdata["CITY"][26]."',";
        $query .= "'".$rawdata["Country"][26]."',";
        $query .= "'".$rawdata["Formername"][26]."',";
        $query .= "'".$rawdata["Industry"][26]."',";
        $query .= "'".$rawdata["InvRelationsEmail"][26]."',";
        $query .= "'".$rawdata["LastAnnualEPS"][26]."',";
        $query .= "'".$rawdata["LastAnnualNetIncome"][26]."',";
        $query .= "'".$rawdata["LastAnnualRevenue"][26]."',";
        $query .= "'".$rawdata["LastAnnualTotalAssets"][26]."',";
        $query .= "'".$rawdata["PhoneAreaCode"][26]."',";
        $query .= "'".$rawdata["PhoneCountryCode"][26]."',";
        $query .= "'".$rawdata["PhoneNumber"][26]."',";
        $query .= "'".$rawdata["PublicFloat"][26]."',";
        $query .= "'".date("Y-m-d",strtotime($rawdata["PublicFloatDate"][26]))."',";
        $query .= "'".$rawdata["Sector"][26]."',";
        $query .= "'".$rawdata["State"][26]."',";
        $query .= "'".$rawdata["StateofIncorporation"][26]."',";
        $query .= "'".$rawdata["StreetAddress1"][26]."',";
        $query .= "'".$rawdata["StreetAddress2"][26]."',";
        $query .= "'".$rawdata["TaxID"][26]."',";
        $query .= "'".$rawdata["WebSiteURL"][26]."',";
        $query .= "'".$rawdata["ZipCode"][26]."'";
        $query .= ")";
        mysql_query($query) or die (mysql_error());

        //Update reports_* tables
	for($i=1; $i<27; $i++) {
	    if (!is_numeric($rawdata["duration"][$i])) {
        	//reports_header
		$query = "INSERT IGNORE INTO `reports_header` (`report_type`, `report_date`, `ticker_id`, `fiscal_year`, `fiscal_quarter`) VALUES (";
        	$query .= "'".$rawdata["duration"][$i]."',";
        	$query .= "'".date("Y-m-d",strtotime($rawdata["PeriodEndDate"][$i]))."',";
        	$query .= "'".$dates->ticker_id."',";
        	$query .= "'".$rawdata["fiscalYear"][$i]."',";
        	$query .= "'".$rawdata["FiscalQuarter"][$i]."'";
        	$query .= ")";
	        mysql_query($query) or die (mysql_error());
		if (mysql_affected_rows()>0) {
			$report_id = mysql_insert_id();
			//reports_balanceconsolidated
			$query = "INSERT INTO `reports_balanceconsolidated` (`report_id`, `CommitmentsContingencies`, `CommonStock`, `DeferredCharges`, `DeferredIncomeTaxesCurrent`, `DeferredIncomeTaxesLongterm`, `AccountsPayableandAccruedExpenses`, `AccruedInterest`, `AdditionalPaidinCapital`, `AdditionalPaidinCapitalPreferredStock`, `CashandCashEquivalents`, `CashCashEquivalentsandShorttermInvestments`, `Goodwill`, `IntangibleAssets`, `InventoriesNet`, `LongtermDeferredIncomeTaxLiabilities`, `LongtermDeferredLiabilityCharges`, `LongtermInvestments`, `MinorityInterest`, `OtherAccumulatedComprehensiveIncome`, `OtherAssets`, `OtherCurrentAssets`, `OtherCurrentLiabilities`, `OtherEquity`, `OtherInvestments`, `OtherLiabilities`, `PartnersCapital`, `PensionPostretirementObligation`, `PreferredStock`, `PrepaidExpenses`, `PropertyPlantEquipmentNet`, `RestrictedCash`, `RetainedEarnings`, `TemporaryEquity`, `TotalAssets`, `TotalCurrentAssets`, `TotalCurrentLiabilities`, `TotalLiabilities`, `TotalLongtermDebt`, `TotalReceivablesNet`, `TotalShorttermDebt`, `TotalStockholdersEquity`, `TreasuryStock`) VALUES (";
	        	$query .= "'".$report_id."',";
        		$query .= "'".$rawdata["CommitmentsContingencies"][$i]."',";
        		$query .= "'".$rawdata["CommonStock"][$i]."',";
	        	$query .= "'".$rawdata["DeferredCharges"][$i]."',";
        		$query .= "'".$rawdata["DeferredIncomeTaxesCurrent"][$i]."',";
        		$query .= "'".$rawdata["DeferredIncomeTaxesLongterm"][$i]."',";
	        	$query .= "'".$rawdata["AccountsPayableandAccruedExpenses"][$i]."',";
        		$query .= "'".$rawdata["AccruedInterest"][$i]."',";
        		$query .= "'".$rawdata["AdditionalPaidinCapital"][$i]."',";
	        	$query .= "'".$rawdata["AdditionalPaidinCapitalPreferredStock"][$i]."',";
        		$query .= "'".$rawdata["CashandCashEquivalents"][$i]."',";
        		$query .= "'".$rawdata["CashCashEquivalentsandShorttermInvestments"][$i]."',";
	        	$query .= "'".$rawdata["Goodwill"][$i]."',";
        		$query .= "'".$rawdata["IntangibleAssets"][$i]."',";
        		$query .= "'".$rawdata["InventoriesNet"][$i]."',";
	        	$query .= "'".$rawdata["LongtermDeferredIncomeTaxLiabilities"][$i]."',";
        		$query .= "'".$rawdata["LongtermDeferredLiabilityCharges"][$i]."',";
        		$query .= "'".$rawdata["LongtermInvestments"][$i]."',";
	        	$query .= "'".$rawdata["MinorityInterest"][$i]."',";
        		$query .= "'".$rawdata["OtherAccumulatedComprehensiveIncome"][$i]."',";
        		$query .= "'".$rawdata["OtherAssets"][$i]."',";
	        	$query .= "'".$rawdata["OtherCurrentAssets"][$i]."',";
        		$query .= "'".$rawdata["OtherCurrentLiabilities"][$i]."',";
        		$query .= "'".$rawdata["OtherEquity"][$i]."',";
	        	$query .= "'".$rawdata["OtherInvestments"][$i]."',";
        		$query .= "'".$rawdata["OtherLiabilities"][$i]."',";
        		$query .= "'".$rawdata["PartnersCapital"][$i]."',";
	        	$query .= "'".$rawdata["PensionPostretirementObligation"][$i]."',";
        		$query .= "'".$rawdata["PreferredStock"][$i]."',";
        		$query .= "'".$rawdata["PrepaidExpenses"][$i]."',";
	        	$query .= "'".$rawdata["PropertyPlantEquipmentNet"][$i]."',";
        		$query .= "'".$rawdata["RestrictedCash"][$i]."',";
        		$query .= "'".$rawdata["RetainedEarnings"][$i]."',";
	        	$query .= "'".$rawdata["TemporaryEquity"][$i]."',";
        		$query .= "'".$rawdata["TotalAssets"][$i]."',";
        		$query .= "'".$rawdata["TotalCurrentAssets"][$i]."',";
	        	$query .= "'".$rawdata["TotalCurrentLiabilities"][$i]."',";
        		$query .= "'".$rawdata["TotalLiabilities"][$i]."',";
        		$query .= "'".$rawdata["TotalLongtermDebt"][$i]."',";
	        	$query .= "'".$rawdata["TotalReceivablesNet"][$i]."',";
        		$query .= "'".$rawdata["TotalShorttermDebt"][$i]."',";
        		$query .= "'".$rawdata["TotalStockholdersEquity"][$i]."',";
	        	$query .= "'".$rawdata["TreasuryStock"][$i]."'";
        		$query .= ")";
	        	mysql_query($query) or die (mysql_error());
			//reports_balancefull
			$query = "INSERT INTO `reports_balancefull` (`report_id`, `TotalDebt`, `TotalAssetsFQ`, `TotalAssetsFY`, `CurrentPortionofLongtermDebt`, `DeferredIncomeTaxLiabilitiesShortterm`, `DeferredLiabilityCharges`, `AccountsNotesReceivableNet`, `AccountsPayable`, `AccountsReceivableTradeNet`, `AccruedExpenses`, `AccumulatedDepreciation`, `AmountsDuetoRelatedPartiesShortterm`, `GoodwillIntangibleAssetsNet`, `IncomeTaxesPayable`, `LiabilitiesStockholdersEquity`, `LongtermDebt`, `NotesPayable`, `OperatingLeases`, `OtherAccountsNotesReceivable`, `OtherAccountsPayableandAccruedExpenses`, `OtherBorrowings`, `OtherReceivables`, `PropertyandEquipmentGross`, `TotalLongtermAssets`, `TotalLongtermLiabilities`, `TotalSharesOutstanding`) VALUES (";
	        	$query .= "'".$report_id."',";
        		$query .= "'".$rawdata["TotalDebt"][$i]."',";
        		$query .= "'".$rawdata["TotalAssetsFQ"][$i]."',";
        		$query .= "'".$rawdata["TotalAssetsFY"][$i]."',";
        		$query .= "'".$rawdata["CurrentPortionofLongtermDebt"][$i]."',";
        		$query .= "'".$rawdata["DeferredIncomeTaxLiabilitiesShortterm"][$i]."',";
        		$query .= "'".$rawdata["DeferredLiabilityCharges"][$i]."',";
        		$query .= "'".$rawdata["AccountsNotesReceivableNet"][$i]."',";
        		$query .= "'".$rawdata["AccountsPayable"][$i]."',";
        		$query .= "'".$rawdata["AccountsReceivableTradeNet"][$i]."',";
        		$query .= "'".$rawdata["AccruedExpenses"][$i]."',";
        		$query .= "'".$rawdata["AccumulatedDepreciation"][$i]."',";
        		$query .= "'".$rawdata["AmountsDuetoRelatedPartiesShortterm"][$i]."',";
        		$query .= "'".$rawdata["GoodwillIntangibleAssetsNet"][$i]."',";
        		$query .= "'".$rawdata["IncomeTaxesPayable"][$i]."',";
        		$query .= "'".$rawdata["LiabilitiesStockholdersEquity"][$i]."',";
        		$query .= "'".$rawdata["LongtermDebt"][$i]."',";
        		$query .= "'".$rawdata["NotesPayable"][$i]."',";
        		$query .= "'".$rawdata["OperatingLeases"][$i]."',";
        		$query .= "'".$rawdata["OtherAccountsNotesReceivable"][$i]."',";
        		$query .= "'".$rawdata["OtherAccountsPayableandAccruedExpenses"][$i]."',";
        		$query .= "'".$rawdata["OtherBorrowings"][$i]."',";
        		$query .= "'".$rawdata["OtherReceivables"][$i]."',";
        		$query .= "'".$rawdata["PropertyandEquipmentGross"][$i]."',";
        		$query .= "'".$rawdata["TotalLongtermAssets"][$i]."',";
        		$query .= "'".$rawdata["TotalLongtermLiabilities"][$i]."',";
        		$query .= "'".$rawdata["TotalSharesOutstanding"][$i]."'";
        		$query .= ")";
	        	mysql_query($query) or die (mysql_error());
			//reports_cashflowconsolidated
			$query = "INSERT INTO `reports_cashflowconsolidated` (`report_id`, `ChangeinCurrentAssets`, `ChangeinCurrentLiabilities`, `ChangeinDebtNet`, `ChangeinDeferredRevenue`, `ChangeinEquityNet`, `ChangeinIncomeTaxesPayable`, `ChangeinInventories`, `ChangeinOperatingAssetsLiabilities`, `ChangeinOtherAssets`, `ChangeinOtherCurrentAssets`, `ChangeinOtherCurrentLiabilities`, `ChangeinOtherLiabilities`, `ChangeinPrepaidExpenses`, `DividendsPaid`, `EffectofExchangeRateonCash`, `EmployeeCompensation`, `AcquisitionSaleofBusinessNet`, `AdjustmentforEquityEarnings`, `AdjustmentforMinorityInterest`, `AdjustmentforSpecialCharges`, `CapitalExpenditures`, `CashfromDiscontinuedOperations`, `CashfromFinancingActivities`, `CashfromInvestingActivities`, `CashfromOperatingActivities`, `CFDepreciationAmortization`, `DeferredIncomeTaxes`, `ChangeinAccountsPayableAccruedExpenses`, `ChangeinAccountsReceivable`, `InvestmentChangesNet`, `NetChangeinCash`, `OtherAdjustments`, `OtherAssetLiabilityChangesNet`, `OtherFinancingActivitiesNet`, `OtherInvestingActivities`, `RealizedGainsLosses`, `SaleofPropertyPlantEquipment`, `StockOptionTaxBenefits`, `TotalAdjustments`) VALUES (";
	        	$query .= "'".$report_id."',";
        		$query .= "'".$rawdata["ChangeinCurrentAssets"][$i]."',";
        		$query .= "'".$rawdata["ChangeinCurrentLiabilities"][$i]."',";
        		$query .= "'".$rawdata["ChangeinDebtNet"][$i]."',";
        		$query .= "'".$rawdata["ChangeinDeferredRevenue"][$i]."',";
        		$query .= "'".$rawdata["ChangeinEquityNet"][$i]."',";
        		$query .= "'".$rawdata["ChangeinIncomeTaxesPayable"][$i]."',";
        		$query .= "'".$rawdata["ChangeinInventories"][$i]."',";
        		$query .= "'".$rawdata["ChangeinOperatingAssetsLiabilities"][$i]."',";
        		$query .= "'".$rawdata["ChangeinOtherAssets"][$i]."',";
        		$query .= "'".$rawdata["ChangeinOtherCurrentAssets"][$i]."',";
        		$query .= "'".$rawdata["ChangeinOtherCurrentLiabilities"][$i]."',";
        		$query .= "'".$rawdata["ChangeinOtherLiabilities"][$i]."',";
        		$query .= "'".$rawdata["ChangeinPrepaidExpenses"][$i]."',";
        		$query .= "'".$rawdata["DividendsPaid"][$i]."',";
        		$query .= "'".$rawdata["EffectofExchangeRateonCash"][$i]."',";
        		$query .= "'".$rawdata["EmployeeCompensation"][$i]."',";
        		$query .= "'".$rawdata["AcquisitionSaleofBusinessNet"][$i]."',";
        		$query .= "'".$rawdata["AdjustmentforEquityEarnings"][$i]."',";
        		$query .= "'".$rawdata["AdjustmentforMinorityInterest"][$i]."',";
        		$query .= "'".$rawdata["AdjustmentforSpecialCharges"][$i]."',";
        		$query .= "'".$rawdata["CapitalExpenditures"][$i]."',";
        		$query .= "'".$rawdata["CashfromDiscontinuedOperations"][$i]."',";
        		$query .= "'".$rawdata["CashfromFinancingActivities"][$i]."',";
        		$query .= "'".$rawdata["CashfromInvestingActivities"][$i]."',";
        		$query .= "'".$rawdata["CashfromOperatingActivities"][$i]."',";
        		$query .= "'".$rawdata["CFDepreciationAmortization"][$i]."',";
        		$query .= "'".$rawdata["DeferredIncomeTaxes"][$i]."',";
        		$query .= "'".$rawdata["ChangeinAccountsPayableAccruedExpenses"][$i]."',";
        		$query .= "'".$rawdata["ChangeinAccountsReceivable"][$i]."',";
        		$query .= "'".$rawdata["InvestmentChangesNet"][$i]."',";
        		$query .= "'".$rawdata["NetChangeinCash"][$i]."',";
        		$query .= "'".$rawdata["OtherAdjustments"][$i]."',";
        		$query .= "'".$rawdata["OtherAssetLiabilityChangesNet"][$i]."',";
        		$query .= "'".$rawdata["OtherFinancingActivitiesNet"][$i]."',";
        		$query .= "'".$rawdata["OtherInvestingActivities"][$i]."',";
        		$query .= "'".$rawdata["RealizedGainsLosses"][$i]."',";
        		$query .= "'".$rawdata["SaleofPropertyPlantEquipment"][$i]."',";
        		$query .= "'".$rawdata["StockOptionTaxBenefits"][$i]."',";
        		$query .= "'".$rawdata["TotalAdjustments"][$i]."'";
        		$query .= ")";
	        	mysql_query($query) or die (mysql_error());
			//reports_cashflowfull
			$query = "INSERT INTO `reports_cashflowfull` (`report_id`, `ChangeinLongtermDebtNet`, `ChangeinShorttermBorrowingsNet`, `CashandCashEquivalentsBeginningofYear`, `CashandCashEquivalentsEndofYear`, `CashPaidforIncomeTaxes`, `CashPaidforInterestExpense`, `CFNetIncome`, `IssuanceofEquity`, `LongtermDebtPayments`, `LongtermDebtProceeds`, `OtherDebtNet`, `OtherEquityTransactionsNet`, `OtherInvestmentChangesNet`, `PurchaseofInvestments`, `RepurchaseofEquity`, `SaleofInvestments`, `ShorttermBorrowings`, `ShorttermInvestments`, `TotalNoncashAdjustments`) VALUES (";
	        	$query .= "'".$report_id."',";
        		$query .= "'".$rawdata["ChangeinLongtermDebtNet"][$i]."',";
        		$query .= "'".$rawdata["ChangeinShorttermBorrowingsNet"][$i]."',";
        		$query .= "'".$rawdata["CashandCashEquivalentsBeginningofYear"][$i]."',";
        		$query .= "'".$rawdata["CashandCashEquivalentsEndofYear"][$i]."',";
        		$query .= "'".$rawdata["CashPaidforIncomeTaxes"][$i]."',";
        		$query .= "'".$rawdata["CashPaidforInterestExpense"][$i]."',";
        		$query .= "'".$rawdata["CFNetIncome"][$i]."',";
        		$query .= "'".$rawdata["IssuanceofEquity"][$i]."',";
        		$query .= "'".$rawdata["LongtermDebtPayments"][$i]."',";
        		$query .= "'".$rawdata["LongtermDebtProceeds"][$i]."',";
        		$query .= "'".$rawdata["OtherDebtNet"][$i]."',";
        		$query .= "'".$rawdata["OtherEquityTransactionsNet"][$i]."',";
        		$query .= "'".$rawdata["OtherInvestmentChangesNet"][$i]."',";
        		$query .= "'".$rawdata["PurchaseofInvestments"][$i]."',";
        		$query .= "'".$rawdata["RepurchaseofEquity"][$i]."',";
        		$query .= "'".$rawdata["SaleofInvestments"][$i]."',";
        		$query .= "'".$rawdata["ShorttermBorrowings"][$i]."',";
        		$query .= "'".$rawdata["ShorttermInvestments"][$i]."',";
        		$query .= "'".$rawdata["TotalNoncashAdjustments"][$i]."'";
        		$query .= ")";
	        	mysql_query($query) or die (mysql_error());
			//reports_financialheader
			$query = "INSERT INTO `reports_financialheader` (`report_id`, `USDConversionRate`, `Restated`, `ReceivedDate`, `Preliminary`, `PeriodLengthCode`, `PeriodLength`, `Original`, `FormType`, `FiledDate`, `DCN`, `CurrencyCode`, `CrossCalculated`, `Audited`, `Amended`) VALUES (";
	        	$query .= "'".$report_id."',";
        		$query .= "'".$rawdata["USDConversionRate"][$i]."',";
        		$query .= "'".($rawdata["Restated"][$i] == "false" ? 0 : 1)."',";
        		$query .= "'".date("Y-m-d",strtotime($rawdata["ReceivedDate"][$i]))."',";
        		$query .= "'".($rawdata["Preliminary"][$i] == "false" ? 0 : 1)."',";
        		$query .= "'".$rawdata["PeriodLengthCode"][$i]."',";
        		$query .= "'".$rawdata["PeriodLength"][$i]."',";
        		$query .= "'".($rawdata["Original"][$i] == "false" ? 0 : 1)."',";
        		$query .= "'".$rawdata["FormType"][$i]."',";
        		$query .= "'".date("Y-m-d",strtotime($rawdata["FiledDate"][$i]))."',";
        		$query .= "'".$rawdata["DCN"][$i]."',";
        		$query .= "'".$rawdata["CurrencyCode"][$i]."',";
        		$query .= "'".($rawdata["CrossCalculated"][$i] == "false" ? 0 : 1)."',";
        		$query .= "'".($rawdata["Audited"][$i] == "false" ? 0 : 1)."',";
        		$query .= "'".($rawdata["Amended"][$i] == "false" ? 0 : 1)."'";
        		$query .= ")";
	        	mysql_query($query) or die (mysql_error());
			//reports_gf_data
			$query = "INSERT INTO `reports_gf_data` (`report_id`, `fiscalPeriod_eol`, `fiscalPeriod_gf`, `InterestIncome`, `InterestExpense`, `EPSBasic`, `EPSDiluted`, `SharesOutstandingDiluted`, `InventoriesRawMaterialsComponents`, `InventoriesWorkInProcess`, `InventoriesInventoriesAdjustments`, `InventoriesFinishedGoods`, `InventoriesOther`, `TotalInventories`, `LandAndImprovements`, `BuildingsAndImprovements`, `MachineryFurnitureEquipment`, `ConstructionInProgress`, `GrossPropertyPlantandEquipment`, `SharesOutstandingBasic`) VALUES (";
	        	$query .= "'".$report_id."',";
        		$query .= "'".$rawdata["fiscalPeriod"][$i]."',";
        		$query .= "'".$rawdata["FiscalPeriod"][$i]."',";
        		$query .= "'".toFloat($rawdata["InterestIncome"][$i])."',";
        		$query .= "'".toFloat($rawdata["InterestExpense"][$i])."',";
        		$query .= "'".toFloat($rawdata["EPSBasic"][$i])."',";
        		$query .= "'".toFloat($rawdata["EPSDiluted"][$i])."',";
        		$query .= "'".toFloat($rawdata["SharesOutstandingDiluted"][$i])."',";
        		$query .= "'".toFloat($rawdata["InventoriesRawMaterialsComponents"][$i])."',";
        		$query .= "'".toFloat($rawdata["InventoriesWorkInProcess"][$i])."',";
        		$query .= "'".toFloat($rawdata["InventoriesInventoriesAdjustments"][$i])."',";
        		$query .= "'".toFloat($rawdata["InventoriesFinishedGoods"][$i])."',";
        		$query .= "'".toFloat($rawdata["InventoriesOther"][$i])."',";
        		$query .= "'".toFloat($rawdata["TotalInventories"][$i])."',";
        		$query .= "'".toFloat($rawdata["LandAndImprovements"][$i])."',";
        		$query .= "'".toFloat($rawdata["BuildingsAndImprovements"][$i])."',";
        		$query .= "'".toFloat($rawdata["MachineryFurnitureEquipment"][$i])."',";
        		$query .= "'".toFloat($rawdata["ConstructionInProgress"][$i])."',";
        		$query .= "'".toFloat($rawdata["GrossPropertyPlantandEquipment"][$i])."',";
        		$query .= "'".toFloat($rawdata["SharesOutstandingBasic"][$i])."'";
        		$query .= ")";
	        	mysql_query($query) or die (mysql_error());
			//reports_incomeconsolidated
			$query = "INSERT INTO `reports_incomeconsolidated` (`report_id`, `EBIT`, `CostofRevenue`, `DepreciationAmortizationExpense`, `DilutedEPSNetIncome`, `DiscontinuedOperations`, `EquityEarnings`, `AccountingChange`, `BasicEPSNetIncome`, `ExtraordinaryItems`, `GrossProfit`, `IncomebeforeExtraordinaryItems`, `IncomeBeforeTaxes`, `IncomeTaxes`, `InterestExpense`, `InterestIncome`, `MinorityInterestEquityEarnings`, `NetIncome`, `NetIncomeApplicabletoCommon`, `OperatingProfit`, `OtherNonoperatingIncomeExpense`, `OtherOperatingExpenses`, `ResearchDevelopmentExpense`, `RestructuringRemediationImpairmentProvisions`, `TotalRevenue`, `SellingGeneralAdministrativeExpenses`) VALUES (";
	        	$query .= "'".$report_id."',";
        		$query .= "'".$rawdata["EBIT"][$i]."',";
        		$query .= "'".$rawdata["CostofRevenue"][$i]."',";
        		$query .= "'".$rawdata["DepreciationAmortizationExpense"][$i]."',";
        		$query .= "'".$rawdata["DilutedEPSNetIncome"][$i]."',";
        		$query .= "'".$rawdata["DiscontinuedOperations"][$i]."',";
        		$query .= "'".$rawdata["EquityEarnings"][$i]."',";
        		$query .= "'".$rawdata["AccountingChange"][$i]."',";
        		$query .= "'".$rawdata["BasicEPSNetIncome"][$i]."',";
        		$query .= "'".$rawdata["ExtraordinaryItems"][$i]."',";
        		$query .= "'".$rawdata["GrossProfit"][$i]."',";
        		$query .= "'".$rawdata["IncomebeforeExtraordinaryItems"][$i]."',";
        		$query .= "'".$rawdata["IncomeBeforeTaxes"][$i]."',";
        		$query .= "'".$rawdata["IncomeTaxes"][$i]."',";
        		$query .= "'".$rawdata["InterestExpense"][$i]."',";
        		$query .= "'".$rawdata["InterestIncome"][$i]."',";
        		$query .= "'".$rawdata["MinorityInterestEquityEarnings"][$i]."',";
        		$query .= "'".$rawdata["NetIncome"][$i]."',";
        		$query .= "'".$rawdata["NetIncomeApplicabletoCommon"][$i]."',";
        		$query .= "'".$rawdata["OperatingProfit"][$i]."',";
        		$query .= "'".$rawdata["OtherNonoperatingIncomeExpense"][$i]."',";
        		$query .= "'".$rawdata["OtherOperatingExpenses"][$i]."',";
        		$query .= "'".$rawdata["ResearchDevelopmentExpense"][$i]."',";
        		$query .= "'".$rawdata["RestructuringRemediationImpairmentProvisions"][$i]."',";
        		$query .= "'".$rawdata["TotalRevenue"][$i]."',";
        		$query .= "'".$rawdata["SellingGeneralAdministrativeExpenses"][$i]."'";
        		$query .= ")";
	        	mysql_query($query) or die (mysql_error());
			//reports_incomefull
			$query = "INSERT INTO `reports_incomefull` (`report_id`, `AdjustedEBIT`, `AdjustedEBITDA`, `AdjustedNetIncome`, `AftertaxMargin`, `EBITDA`, `GrossMargin`, `NetOperatingProfitafterTax`, `OperatingMargin`, `RevenueFQ`, `RevenueFY`, `RevenueTTM`, `CostOperatingExpenses`, `DepreciationExpense`, `DilutedEPSNetIncomefromContinuingOperations`, `DilutedWeightedAverageShares`, `AmortizationExpense`, `BasicEPSNetIncomefromContinuingOperations`, `BasicWeightedAverageShares`, `GeneralAdministrativeExpense`, `IncomeAfterTaxes`, `LaborExpense`, `NetIncomefromContinuingOperationsApplicabletoCommon`, `InterestIncomeExpenseNet`, `NoncontrollingInterest`, `NonoperatingGainsLosses`, `OperatingExpenses`, `OtherGeneralAdministrativeExpense`, `OtherInterestIncomeExpenseNet`, `OtherRevenue`, `OtherSellingGeneralAdministrativeExpenses`, `PreferredDividends`, `SalesMarketingExpense`, `TotalNonoperatingIncomeExpense`, `TotalOperatingExpenses`, `OperatingRevenue`) VALUES (";
	        	$query .= "'".$report_id."',";
        		$query .= "'".$rawdata["AdjustedEBIT"][$i]."',";
        		$query .= "'".$rawdata["AdjustedEBITDA"][$i]."',";
        		$query .= "'".$rawdata["AdjustedNetIncome"][$i]."',";
        		$query .= "'".$rawdata["AftertaxMargin"][$i]."',";
        		$query .= "'".$rawdata["EBITDA"][$i]."',";
        		$query .= "'".$rawdata["GrossMargin"][$i]."',";
        		$query .= "'".$rawdata["NetOperatingProfitafterTax"][$i]."',";
        		$query .= "'".$rawdata["OperatingMargin"][$i]."',";
        		$query .= "'".$rawdata["RevenueFQ"][$i]."',";
        		$query .= "'".$rawdata["RevenueFY"][$i]."',";
        		$query .= "'".$rawdata["RevenueTTM"][$i]."',";
        		$query .= "'".$rawdata["CostOperatingExpenses"][$i]."',";
        		$query .= "'".$rawdata["DepreciationExpense"][$i]."',";
        		$query .= "'".$rawdata["DilutedEPSNetIncomefromContinuingOperations"][$i]."',";
        		$query .= "'".$rawdata["DilutedWeightedAverageShares"][$i]."',";
        		$query .= "'".$rawdata["AmortizationExpense"][$i]."',";
        		$query .= "'".$rawdata["BasicEPSNetIncomefromContinuingOperations"][$i]."',";
        		$query .= "'".$rawdata["BasicWeightedAverageShares"][$i]."',";
        		$query .= "'".$rawdata["GeneralAdministrativeExpense"][$i]."',";
        		$query .= "'".$rawdata["IncomeAfterTaxes"][$i]."',";
        		$query .= "'".$rawdata["LaborExpense"][$i]."',";
        		$query .= "'".$rawdata["NetIncomefromContinuingOperationsApplicabletoCommon"][$i]."',";
        		$query .= "'".$rawdata["InterestIncomeExpenseNet"][$i]."',";
        		$query .= "'".$rawdata["NoncontrollingInterest"][$i]."',";
        		$query .= "'".$rawdata["NonoperatingGainsLosses"][$i]."',";
        		$query .= "'".$rawdata["OperatingExpenses"][$i]."',";
        		$query .= "'".$rawdata["OtherGeneralAdministrativeExpense"][$i]."',";
        		$query .= "'".$rawdata["OtherInterestIncomeExpenseNet"][$i]."',";
        		$query .= "'".$rawdata["OtherRevenue"][$i]."',";
        		$query .= "'".$rawdata["OtherSellingGeneralAdministrativeExpenses"][$i]."',";
        		$query .= "'".$rawdata["PreferredDividends"][$i]."',";
        		$query .= "'".$rawdata["SalesMarketingExpense"][$i]."',";
        		$query .= "'".$rawdata["TotalNonoperatingIncomeExpense"][$i]."',";
        		$query .= "'".$rawdata["TotalOperatingExpenses"][$i]."',";
        		$query .= "'".$rawdata["OperatingRevenue"][$i]."'";
        		$query .= ")";
	        	mysql_query($query) or die (mysql_error());
			//reports_metadata_eol
			$query = "INSERT INTO `reports_metadata_eol` (`report_id`, `CoverSheetTSO`, `CoverSheetTSODate`, `AuditorCode`, `AuditorOpinion`, `InventoryPolicy`, `NumberofShareholders`, `NumberofEmployees`) VALUES (";
	        	$query .= "'".$report_id."',";
        		$query .= "'".$rawdata["CoverSheetTSO"][$i]."',";
        		$query .= "'".date("Y-m-d",strtotime($rawdata["CoverSheetTSODate"][$i]))."',";
        		$query .= "'".$rawdata["AuditorCode"][$i]."',";
        		$query .= "'".$rawdata["AuditorOpinion"][$i]."',";
        		$query .= "'".$rawdata["InventoryPolicy"][$i]."',";
        		$query .= "'".$rawdata["NumberofShareholders"][$i]."',";
        		$query .= "'".$rawdata["NumberofEmployees"][$i]."'";
        		$query .= ")";
	        	mysql_query($query) or die (mysql_error());
			//reports_variable_ratios
			$query = "INSERT INTO `reports_variable_ratios` (`report_id`, `BookEquity`, `DebttoAssets`, `DegreeofCombinedLeverage`, `DegreeofFinancialLeverage`, `DegreeofOperationalLeverage`, `FreeCashFlow`, `DebttoEquity`, `AdjustedEPSBasic`, `AdjustedEPSDiluted`, `FreeCashFlowReturnonAssets`, `ReturnonAssets`, `ReturnonEquity`, `ReturnonInvestedCapital`, `RevenueperEmployee`, `CashRatio`, `CurrentRatio`, `FreeCashFlowMargin`, `LongTermCapital`, `LongTermDebttoLongTermCapital`, `LongTermDebttoTotalCapital`, `NetDebt`, `NetIncomeperEmployee`, `NetWorkingCapital`, `PretaxMargin`, `QuickRatio`, `TaxRate`, `TotalCapital`) VALUES (";
	        	$query .= "'".$report_id."',";
        		$query .= "'".$rawdata["BookEquity"][$i]."',";
        		$query .= "'".$rawdata["DebttoAssets"][$i]."',";
        		$query .= "'".$rawdata["DegreeofCombinedLeverage"][$i]."',";
        		$query .= "'".$rawdata["DegreeofFinancialLeverage"][$i]."',";
        		$query .= "'".$rawdata["DegreeofOperationalLeverage"][$i]."',";
        		$query .= "'".$rawdata["FreeCashFlow"][$i]."',";
        		$query .= "'".$rawdata["DebttoEquity"][$i]."',";
        		$query .= "'".$rawdata["AdjustedEPSBasic"][$i]."',";
        		$query .= "'".$rawdata["AdjustedEPSDiluted"][$i]."',";
        		$query .= "'".$rawdata["FreeCashFlowReturnonAssets"][$i]."',";
        		$query .= "'".$rawdata["ReturnonAssets"][$i]."',";
        		$query .= "'".$rawdata["ReturnonEquity"][$i]."',";
        		$query .= "'".$rawdata["ReturnonInvestedCapital"][$i]."',";
        		$query .= "'".$rawdata["RevenueperEmployee"][$i]."',";
        		$query .= "'".$rawdata["CashRatio"][$i]."',";
        		$query .= "'".$rawdata["CurrentRatio"][$i]."',";
        		$query .= "'".$rawdata["FreeCashFlowMargin"][$i]."',";
        		$query .= "'".$rawdata["LongTermCapital"][$i]."',";
        		$query .= "'".$rawdata["LongTermDebttoLongTermCapital"][$i]."',";
        		$query .= "'".$rawdata["LongTermDebttoTotalCapital"][$i]."',";
        		$query .= "'".$rawdata["NetDebt"][$i]."',";
        		$query .= "'".$rawdata["NetIncomeperEmployee"][$i]."',";
        		$query .= "'".$rawdata["NetWorkingCapital"][$i]."',";
        		$query .= "'".$rawdata["PretaxMargin"][$i]."',";
        		$query .= "'".$rawdata["QuickRatio"][$i]."',";
        		$query .= "'".$rawdata["TaxRate"][$i]."',";
        		$query .= "'".$rawdata["TotalCapital"][$i]."'";
        		$query .= ")";
	        	mysql_query($query) or die (mysql_error());
			//reports_financialscustom (computed data)
                        $query = "INSERT INTO `reports_financialscustom` (`report_id`, `COGSPercent`, `GrossMarginPercent`, `SGAPercent`, `RDPercent`, `DepreciationAmortizationPercent`, `EBITDAPercent`, `OperatingMarginPercent`, `EBITPercent`, `TaxRatePercent`, `IncomeAfterTaxes`, `NetMarginPercent`, `DividendsPerShare`, `ShortTermDebtAndCurrentPortion`, `TotalLongTermDebtAndNotesPayable`, `NetChangeLongTermDebt`, `CapEx`, `FreeCashFlow`, `OwnerEarningsFCF`) VALUES (";
                        $query .= "'".$report_id."',";
                        $query .= "'".($rawdata["CostofRevenue"][$i]/$rawdata["TotalRevenue"][$i])."',";
                        $query .= "'".($rawdata["GrossProfit"][$i]/$rawdata["TotalRevenue"][$i])."',";
                        $query .= "'".($rawdata["SellingGeneralAdministrativeExpenses"][$i]/$rawdata["TotalRevenue"][$i])."',";
                        $query .= "'".($rawdata["ResearchDevelopmentExpense"][$i]/$rawdata["TotalRevenue"][$i])."',";
                        $query .= "'".($rawdata["CFDepreciationAmortization"][$i]/$rawdata["TotalRevenue"][$i])."',";
                        $query .= "'".($rawdata["EBITDA"][$i]/$rawdata["TotalRevenue"][$i])."',";
                        $query .= "'".($rawdata["OperatingProfit"][$i]/$rawdata["TotalRevenue"][$i])."',";
                        $query .= "'".($rawdata["EBIT"][$i]/$rawdata["TotalRevenue"][$i])."',";
                        $query .= "'".($rawdata["IncomeTaxes"][$i]/$rawdata["IncomeBeforeTaxes"][$i])."',";
                        $query .= "'".($rawdata["IncomeBeforeTaxes"][$i]-$rawdata["IncomeTaxes"][$i])."',";
                        $query .= "'".($rawdata["NetIncome"][$i]/$rawdata["TotalRevenue"][$i])."',";
                        $query .= "'".(-($rawdata["DividendsPaid"][$i])/(toFloat($rawdata["SharesOutstandingBasic"][$i])*1000000))."',";
                        $query .= "'".($rawdata["CurrentPortionofLongtermDebt"][$i]+$rawdata["ShorttermBorrowings"][$i])."',";
                        $query .= "'".($rawdata["TotalLongtermDebt"][$i]+$rawdata["NotesPayable"][$i])."',";
                        $query .= "'".($rawdata["LongtermDebtProceeds"][$i]+$rawdata["LongtermDebtPayments"][$i])."',";
                        $query .= "'".(-$rawdata["CapitalExpenditures"][$i])."',";
                        $query .= "'".($rawdata["CashfromOperatingActivities"][$i]+$rawdata["CapitalExpenditures"][$i])."',";
                        $query .= "'".($rawdata["CFNetIncome"][$i]+$rawdata["CFDepreciationAmortization"][$i]+$rawdata["EmployeeCompensation"][$i]+$rawdata["AdjustmentforSpecialCharges"][$i]+$rawdata["DeferredIncomeTaxes"][$i]+$rawdata["CapitalExpenditures"][$i]-($rawdata["ChangeinCurrentAssets"][$i]-$rawdata["ChangeinCurrentLiabilities"][$i]))."'";
        		$query .= ")";
	        	mysql_query($query) or die (mysql_error());

			//Populate Key Ratios only for annual reports
/*			if($i < 11) {
				$rdate = date("Y-m-d",strtotime($rawdata["PeriodEndDate"][$i]));
				$qquote = "Select * from tickers_yahoo_historical_data where ticker_id = '".$dates->ticker_id."' and report_date = '".$rdate."'";
				$price = 0;
				$rquote = mysql_query($qquote) or die (mysql_error());
				if(mysql_num_rows($rquote) < 1) {
					$rdate = date("Y-m-d",strtotime($rawdata["PeriodEndDate"][$i] . " - 2 days"));
					$qquote = "Select * from tickers_yahoo_historical_data where ticker_id = '".$dates->ticker_id."' and report_date = '".$rdate."'";
					$rquote = mysql_query($qquote) or die (mysql_error());
					if(mysql_num_rows($rquote) < 1) {
						$rdate = date("Y-m-d",strtotime($rawdata["PeriodEndDate"][$i] . " - 4 days"));
						$qquote = "Select * from tickers_yahoo_historical_data where ticker_id = '".$dates->ticker_id."' and report_date = '".$rdate."'";
						$rquote = mysql_query($qquote) or die (mysql_error());
						if(mysql_num_rows($rquote) > 0) {
	                                        	$price = mysql_fetch_assoc($rquote);
		                                        $price = $price["close"];
						}
					} else {
	                                        $price = mysql_fetch_assoc($rquote);
	                                        $price = $price["close"];
					}
				} else {
					$price = mysql_fetch_assoc($rquote);
					$price = $price["close"];
				}
				$query = "INSERT INTO `reports_key_ratios` (`report_id`, `ReportDate`, `ReportDateAdjusted`, `SharesOutstandingDiluted`, `ReportDatePrice`, `CashFlow`, `MarketCap`, `EnterpriseValue`, `GoodwillIntangibleAssetsNet`, `TangibleBookValue`, `ExcessCash`, `TotalInvestedCapital`, `WorkingCapital`, `P_E`, `P_E_CashAdjusted`, `EV_EBITDA`, `EV_EBIT`, `P_S`, `P_BV`, `P_Tang_BV`, `P_CF`, `P_FCF`, `P_OwnerEarnings`, `FCF_S`, `FCFYield`, `MagicFormulaEarningsYield`, `ROE`, `ROA`, `ROIC`, `CROIC`, `GPA`, `BooktoMarket`, `QuickRatio`, `CurrentRatio`, `TotalDebt_EquityRatio`, `LongTermDebt_EquityRatio`, `ShortTermDebt_EquityRatio`, `AssetTurnover`, `CashPercofRevenue`, `ReceivablesPercofRevenue`, `SG_APercofRevenue`, `R_DPercofRevenue`, `DaysSalesOutstanding`, `DaysInventoryOutstanding`, `DaysPayableOutstanding`, `CashConversionCycle`, `ReceivablesTurnover`, `InventoryTurnover`, `AverageAgeofInventory`, `IntangiblesPercofBookValue`, `InventoryPercofRevenue`, `LT_DebtasPercofInvestedCapital`, `ST_DebtasPercofInvestedCapital`, `LT_DebtasPercofTotalDebt`, `ST_DebtasPercofTotalDebt`, `TotalDebtPercofTotalAssets`, `WorkingCapitalPercofPrice`) VALUES (";
				$query .= "'".$report_id."',";
				
        	                $query .= ")";
	                        mysql_query($query) or die (mysql_error());
			}*/
		}
	    }
	}

	//Update TTM and PTTM data
	//Determine if USA stock or ADR
	$stock_type = "ADR";
	$MRQRow = 10;
	$PMRQRow = 9;
	if($rawdata["Country"][10] == "UNITED STATES OF AMERICA" || $rawdata["Country"][26] == "UNITED STATES OF AMERICA") {
		$stock_type = "USA";
		$MRQRow = 26;
		$PMRQRow = 22;
	}

	//Load Balance MRQ data
	$query = "INSERT INTO `ttm_balanceconsolidated` (`ticker_id`, `CommitmentsContingencies`, `CommonStock`, `DeferredCharges`, `DeferredIncomeTaxesCurrent`, `DeferredIncomeTaxesLongterm`, `AccountsPayableandAccruedExpenses`, `AccruedInterest`, `AdditionalPaidinCapital`, `AdditionalPaidinCapitalPreferredStock`, `CashandCashEquivalents`, `CashCashEquivalentsandShorttermInvestments`, `Goodwill`, `IntangibleAssets`, `InventoriesNet`, `LongtermDeferredIncomeTaxLiabilities`, `LongtermDeferredLiabilityCharges`, `LongtermInvestments`, `MinorityInterest`, `OtherAccumulatedComprehensiveIncome`, `OtherAssets`, `OtherCurrentAssets`, `OtherCurrentLiabilities`, `OtherEquity`, `OtherInvestments`, `OtherLiabilities`, `PartnersCapital`, `PensionPostretirementObligation`, `PreferredStock`, `PrepaidExpenses`, `PropertyPlantEquipmentNet`, `RestrictedCash`, `RetainedEarnings`, `TemporaryEquity`, `TotalAssets`, `TotalCurrentAssets`, `TotalCurrentLiabilities`, `TotalLiabilities`, `TotalLongtermDebt`, `TotalReceivablesNet`, `TotalShorttermDebt`, `TotalStockholdersEquity`, `TreasuryStock`) VALUES (";
       	$query .= "'".$dates->ticker_id."',";
	$query .= "'".$rawdata["CommitmentsContingencies"][$MRQRow]."',";
      	$query .= "'".$rawdata["CommonStock"][$MRQRow]."',";
       	$query .= "'".$rawdata["DeferredCharges"][$MRQRow]."',";
       	$query .= "'".$rawdata["DeferredIncomeTaxesCurrent"][$MRQRow]."',";
       	$query .= "'".$rawdata["DeferredIncomeTaxesLongterm"][$MRQRow]."',";
       	$query .= "'".$rawdata["AccountsPayableandAccruedExpenses"][$MRQRow]."',";
       	$query .= "'".$rawdata["AccruedInterest"][$MRQRow]."',";
       	$query .= "'".$rawdata["AdditionalPaidinCapital"][$MRQRow]."',";
       	$query .= "'".$rawdata["AdditionalPaidinCapitalPreferredStock"][$MRQRow]."',";
       	$query .= "'".$rawdata["CashandCashEquivalents"][$MRQRow]."',";
       	$query .= "'".$rawdata["CashCashEquivalentsandShorttermInvestments"][$MRQRow]."',";
       	$query .= "'".$rawdata["Goodwill"][$MRQRow]."',";
       	$query .= "'".$rawdata["IntangibleAssets"][$MRQRow]."',";
       	$query .= "'".$rawdata["InventoriesNet"][$MRQRow]."',";
       	$query .= "'".$rawdata["LongtermDeferredIncomeTaxLiabilities"][$MRQRow]."',";
       	$query .= "'".$rawdata["LongtermDeferredLiabilityCharges"][$MRQRow]."',";
       	$query .= "'".$rawdata["LongtermInvestments"][$MRQRow]."',";
       	$query .= "'".$rawdata["MinorityInterest"][$MRQRow]."',";
       	$query .= "'".$rawdata["OtherAccumulatedComprehensiveIncome"][$MRQRow]."',";
       	$query .= "'".$rawdata["OtherAssets"][$MRQRow]."',";
       	$query .= "'".$rawdata["OtherCurrentAssets"][$MRQRow]."',";
       	$query .= "'".$rawdata["OtherCurrentLiabilities"][$MRQRow]."',";
       	$query .= "'".$rawdata["OtherEquity"][$MRQRow]."',";
       	$query .= "'".$rawdata["OtherInvestments"][$MRQRow]."',";
       	$query .= "'".$rawdata["OtherLiabilities"][$MRQRow]."',";
       	$query .= "'".$rawdata["PartnersCapital"][$MRQRow]."',";
       	$query .= "'".$rawdata["PensionPostretirementObligation"][$MRQRow]."',";
       	$query .= "'".$rawdata["PreferredStock"][$MRQRow]."',";
       	$query .= "'".$rawdata["PrepaidExpenses"][$MRQRow]."',";
       	$query .= "'".$rawdata["PropertyPlantEquipmentNet"][$MRQRow]."',";
       	$query .= "'".$rawdata["RestrictedCash"][$MRQRow]."',";
       	$query .= "'".$rawdata["RetainedEarnings"][$MRQRow]."',";
       	$query .= "'".$rawdata["TemporaryEquity"][$MRQRow]."',";
       	$query .= "'".$rawdata["TotalAssets"][$MRQRow]."',";
       	$query .= "'".$rawdata["TotalCurrentAssets"][$MRQRow]."',";
       	$query .= "'".$rawdata["TotalCurrentLiabilities"][$MRQRow]."',";
       	$query .= "'".$rawdata["TotalLiabilities"][$MRQRow]."',";
       	$query .= "'".$rawdata["TotalLongtermDebt"][$MRQRow]."',";
       	$query .= "'".$rawdata["TotalReceivablesNet"][$MRQRow]."',";
       	$query .= "'".$rawdata["TotalShorttermDebt"][$MRQRow]."',";
       	$query .= "'".$rawdata["TotalStockholdersEquity"][$MRQRow]."',";
       	$query .= "'".$rawdata["TreasuryStock"][$MRQRow]."'";
       	$query .= ")";
       	mysql_query($query) or die (mysql_error());

	$query = "INSERT INTO `pttm_balanceconsolidated` (`ticker_id`, `CommitmentsContingencies`, `CommonStock`, `DeferredCharges`, `DeferredIncomeTaxesCurrent`, `DeferredIncomeTaxesLongterm`, `AccountsPayableandAccruedExpenses`, `AccruedInterest`, `AdditionalPaidinCapital`, `AdditionalPaidinCapitalPreferredStock`, `CashandCashEquivalents`, `CashCashEquivalentsandShorttermInvestments`, `Goodwill`, `IntangibleAssets`, `InventoriesNet`, `LongtermDeferredIncomeTaxLiabilities`, `LongtermDeferredLiabilityCharges`, `LongtermInvestments`, `MinorityInterest`, `OtherAccumulatedComprehensiveIncome`, `OtherAssets`, `OtherCurrentAssets`, `OtherCurrentLiabilities`, `OtherEquity`, `OtherInvestments`, `OtherLiabilities`, `PartnersCapital`, `PensionPostretirementObligation`, `PreferredStock`, `PrepaidExpenses`, `PropertyPlantEquipmentNet`, `RestrictedCash`, `RetainedEarnings`, `TemporaryEquity`, `TotalAssets`, `TotalCurrentAssets`, `TotalCurrentLiabilities`, `TotalLiabilities`, `TotalLongtermDebt`, `TotalReceivablesNet`, `TotalShorttermDebt`, `TotalStockholdersEquity`, `TreasuryStock`) VALUES (";
       	$query .= "'".$dates->ticker_id."',";
	$query .= "'".$rawdata["CommitmentsContingencies"][$PMRQRow]."',";
      	$query .= "'".$rawdata["CommonStock"][$PMRQRow]."',";
       	$query .= "'".$rawdata["DeferredCharges"][$PMRQRow]."',";
       	$query .= "'".$rawdata["DeferredIncomeTaxesCurrent"][$PMRQRow]."',";
       	$query .= "'".$rawdata["DeferredIncomeTaxesLongterm"][$PMRQRow]."',";
       	$query .= "'".$rawdata["AccountsPayableandAccruedExpenses"][$PMRQRow]."',";
       	$query .= "'".$rawdata["AccruedInterest"][$PMRQRow]."',";
       	$query .= "'".$rawdata["AdditionalPaidinCapital"][$PMRQRow]."',";
       	$query .= "'".$rawdata["AdditionalPaidinCapitalPreferredStock"][$PMRQRow]."',";
       	$query .= "'".$rawdata["CashandCashEquivalents"][$PMRQRow]."',";
       	$query .= "'".$rawdata["CashCashEquivalentsandShorttermInvestments"][$PMRQRow]."',";
       	$query .= "'".$rawdata["Goodwill"][$PMRQRow]."',";
       	$query .= "'".$rawdata["IntangibleAssets"][$PMRQRow]."',";
       	$query .= "'".$rawdata["InventoriesNet"][$PMRQRow]."',";
       	$query .= "'".$rawdata["LongtermDeferredIncomeTaxLiabilities"][$PMRQRow]."',";
       	$query .= "'".$rawdata["LongtermDeferredLiabilityCharges"][$PMRQRow]."',";
       	$query .= "'".$rawdata["LongtermInvestments"][$PMRQRow]."',";
       	$query .= "'".$rawdata["MinorityInterest"][$PMRQRow]."',";
       	$query .= "'".$rawdata["OtherAccumulatedComprehensiveIncome"][$PMRQRow]."',";
       	$query .= "'".$rawdata["OtherAssets"][$PMRQRow]."',";
       	$query .= "'".$rawdata["OtherCurrentAssets"][$PMRQRow]."',";
       	$query .= "'".$rawdata["OtherCurrentLiabilities"][$PMRQRow]."',";
       	$query .= "'".$rawdata["OtherEquity"][$PMRQRow]."',";
       	$query .= "'".$rawdata["OtherInvestments"][$PMRQRow]."',";
       	$query .= "'".$rawdata["OtherLiabilities"][$PMRQRow]."',";
       	$query .= "'".$rawdata["PartnersCapital"][$PMRQRow]."',";
       	$query .= "'".$rawdata["PensionPostretirementObligation"][$PMRQRow]."',";
       	$query .= "'".$rawdata["PreferredStock"][$PMRQRow]."',";
       	$query .= "'".$rawdata["PrepaidExpenses"][$PMRQRow]."',";
       	$query .= "'".$rawdata["PropertyPlantEquipmentNet"][$PMRQRow]."',";
       	$query .= "'".$rawdata["RestrictedCash"][$PMRQRow]."',";
       	$query .= "'".$rawdata["RetainedEarnings"][$PMRQRow]."',";
       	$query .= "'".$rawdata["TemporaryEquity"][$PMRQRow]."',";
       	$query .= "'".$rawdata["TotalAssets"][$PMRQRow]."',";
       	$query .= "'".$rawdata["TotalCurrentAssets"][$PMRQRow]."',";
       	$query .= "'".$rawdata["TotalCurrentLiabilities"][$PMRQRow]."',";
       	$query .= "'".$rawdata["TotalLiabilities"][$PMRQRow]."',";
       	$query .= "'".$rawdata["TotalLongtermDebt"][$PMRQRow]."',";
       	$query .= "'".$rawdata["TotalReceivablesNet"][$PMRQRow]."',";
       	$query .= "'".$rawdata["TotalShorttermDebt"][$PMRQRow]."',";
       	$query .= "'".$rawdata["TotalStockholdersEquity"][$PMRQRow]."',";
       	$query .= "'".$rawdata["TreasuryStock"][$PMRQRow]."'";
       	$query .= ")";
       	mysql_query($query) or die (mysql_error());

	$query = "INSERT INTO `ttm_balancefull` (`ticker_id`, `TotalDebt`, `TotalAssetsFQ`, `TotalAssetsFY`, `CurrentPortionofLongtermDebt`, `DeferredIncomeTaxLiabilitiesShortterm`, `DeferredLiabilityCharges`, `AccountsNotesReceivableNet`, `AccountsPayable`, `AccountsReceivableTradeNet`, `AccruedExpenses`, `AccumulatedDepreciation`, `AmountsDuetoRelatedPartiesShortterm`, `GoodwillIntangibleAssetsNet`, `IncomeTaxesPayable`, `LiabilitiesStockholdersEquity`, `LongtermDebt`, `NotesPayable`, `OperatingLeases`, `OtherAccountsNotesReceivable`, `OtherAccountsPayableandAccruedExpenses`, `OtherBorrowings`, `OtherReceivables`, `PropertyandEquipmentGross`, `TotalLongtermAssets`, `TotalLongtermLiabilities`, `TotalSharesOutstanding`) VALUES (";
       	$query .= "'".$dates->ticker_id."',";
       	$query .= "'".$rawdata["TotalDebt"][$MRQRow]."',";
       	$query .= "'".$rawdata["TotalAssetsFQ"][$MRQRow]."',";
       	$query .= "'".$rawdata["TotalAssetsFY"][$MRQRow]."',";
       	$query .= "'".$rawdata["CurrentPortionofLongtermDebt"][$MRQRow]."',";
       	$query .= "'".$rawdata["DeferredIncomeTaxLiabilitiesShortterm"][$MRQRow]."',";
       	$query .= "'".$rawdata["DeferredLiabilityCharges"][$MRQRow]."',";
       	$query .= "'".$rawdata["AccountsNotesReceivableNet"][$MRQRow]."',";
       	$query .= "'".$rawdata["AccountsPayable"][$MRQRow]."',";
       	$query .= "'".$rawdata["AccountsReceivableTradeNet"][$MRQRow]."',";
       	$query .= "'".$rawdata["AccruedExpenses"][$MRQRow]."',";
       	$query .= "'".$rawdata["AccumulatedDepreciation"][$MRQRow]."',";
       	$query .= "'".$rawdata["AmountsDuetoRelatedPartiesShortterm"][$MRQRow]."',";
       	$query .= "'".$rawdata["GoodwillIntangibleAssetsNet"][$MRQRow]."',";
       	$query .= "'".$rawdata["IncomeTaxesPayable"][$MRQRow]."',";
       	$query .= "'".$rawdata["LiabilitiesStockholdersEquity"][$MRQRow]."',";
       	$query .= "'".$rawdata["LongtermDebt"][$MRQRow]."',";
       	$query .= "'".$rawdata["NotesPayable"][$MRQRow]."',";
       	$query .= "'".$rawdata["OperatingLeases"][$MRQRow]."',";
       	$query .= "'".$rawdata["OtherAccountsNotesReceivable"][$MRQRow]."',";
       	$query .= "'".$rawdata["OtherAccountsPayableandAccruedExpenses"][$MRQRow]."',";
       	$query .= "'".$rawdata["OtherBorrowings"][$MRQRow]."',";
       	$query .= "'".$rawdata["OtherReceivables"][$MRQRow]."',";
       	$query .= "'".$rawdata["PropertyandEquipmentGross"][$MRQRow]."',";
       	$query .= "'".$rawdata["TotalLongtermAssets"][$MRQRow]."',";
       	$query .= "'".$rawdata["TotalLongtermLiabilities"][$MRQRow]."',";
       	$query .= "'".$rawdata["TotalSharesOutstanding"][$MRQRow]."'";
       	$query .= ")";
       	mysql_query($query) or die (mysql_error());

	$query = "INSERT INTO `pttm_balancefull` (`ticker_id`, `TotalDebt`, `TotalAssetsFQ`, `TotalAssetsFY`, `CurrentPortionofLongtermDebt`, `DeferredIncomeTaxLiabilitiesShortterm`, `DeferredLiabilityCharges`, `AccountsNotesReceivableNet`, `AccountsPayable`, `AccountsReceivableTradeNet`, `AccruedExpenses`, `AccumulatedDepreciation`, `AmountsDuetoRelatedPartiesShortterm`, `GoodwillIntangibleAssetsNet`, `IncomeTaxesPayable`, `LiabilitiesStockholdersEquity`, `LongtermDebt`, `NotesPayable`, `OperatingLeases`, `OtherAccountsNotesReceivable`, `OtherAccountsPayableandAccruedExpenses`, `OtherBorrowings`, `OtherReceivables`, `PropertyandEquipmentGross`, `TotalLongtermAssets`, `TotalLongtermLiabilities`, `TotalSharesOutstanding`) VALUES (";
       	$query .= "'".$dates->ticker_id."',";
       	$query .= "'".$rawdata["TotalDebt"][$PMRQRow]."',";
       	$query .= "'".$rawdata["TotalAssetsFQ"][$PMRQRow]."',";
       	$query .= "'".$rawdata["TotalAssetsFY"][$PMRQRow]."',";
       	$query .= "'".$rawdata["CurrentPortionofLongtermDebt"][$PMRQRow]."',";
       	$query .= "'".$rawdata["DeferredIncomeTaxLiabilitiesShortterm"][$PMRQRow]."',";
       	$query .= "'".$rawdata["DeferredLiabilityCharges"][$PMRQRow]."',";
       	$query .= "'".$rawdata["AccountsNotesReceivableNet"][$PMRQRow]."',";
       	$query .= "'".$rawdata["AccountsPayable"][$PMRQRow]."',";
       	$query .= "'".$rawdata["AccountsReceivableTradeNet"][$PMRQRow]."',";
       	$query .= "'".$rawdata["AccruedExpenses"][$PMRQRow]."',";
       	$query .= "'".$rawdata["AccumulatedDepreciation"][$PMRQRow]."',";
       	$query .= "'".$rawdata["AmountsDuetoRelatedPartiesShortterm"][$PMRQRow]."',";
       	$query .= "'".$rawdata["GoodwillIntangibleAssetsNet"][$PMRQRow]."',";
       	$query .= "'".$rawdata["IncomeTaxesPayable"][$PMRQRow]."',";
       	$query .= "'".$rawdata["LiabilitiesStockholdersEquity"][$PMRQRow]."',";
       	$query .= "'".$rawdata["LongtermDebt"][$PMRQRow]."',";
       	$query .= "'".$rawdata["NotesPayable"][$PMRQRow]."',";
       	$query .= "'".$rawdata["OperatingLeases"][$PMRQRow]."',";
       	$query .= "'".$rawdata["OtherAccountsNotesReceivable"][$PMRQRow]."',";
       	$query .= "'".$rawdata["OtherAccountsPayableandAccruedExpenses"][$PMRQRow]."',";
       	$query .= "'".$rawdata["OtherBorrowings"][$PMRQRow]."',";
       	$query .= "'".$rawdata["OtherReceivables"][$PMRQRow]."',";
       	$query .= "'".$rawdata["PropertyandEquipmentGross"][$PMRQRow]."',";
       	$query .= "'".$rawdata["TotalLongtermAssets"][$PMRQRow]."',";
       	$query .= "'".$rawdata["TotalLongtermLiabilities"][$PMRQRow]."',";
       	$query .= "'".$rawdata["TotalSharesOutstanding"][$PMRQRow]."'";
       	$query .= ")";
       	mysql_query($query) or die (mysql_error());

	//Cashflow and Financial
	if($stock_type == "ADR") {
                $query = "INSERT INTO `ttm_gf_data` (`ticker_id`, `InterestIncome`, `InterestExpense`, `EPSBasic`, `EPSDiluted`, `SharesOutstandingDiluted`, `InventoriesRawMaterialsComponents`, `InventoriesWorkInProcess`, `InventoriesInventoriesAdjustments`, `InventoriesFinishedGoods`, `InventoriesOther`, `TotalInventories`, `LandAndImprovements`, `BuildingsAndImprovements`, `MachineryFurnitureEquipment`, `ConstructionInProgress`, `GrossPropertyPlantandEquipment`, `SharesOutstandingBasic`) VALUES (";
                $query .= "'".$dates->ticker_id."',";
                $query .= "'".toFloat($rawdata["InterestIncome"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["InterestExpense"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["EPSBasic"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["EPSDiluted"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["SharesOutstandingDiluted"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["InventoriesRawMaterialsComponents"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["InventoriesWorkInProcess"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["InventoriesInventoriesAdjustments"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["InventoriesFinishedGoods"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["InventoriesOther"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["TotalInventories"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["LandAndImprovements"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["BuildingsAndImprovements"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["MachineryFurnitureEquipment"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["ConstructionInProgress"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["GrossPropertyPlantandEquipment"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["SharesOutstandingBasic"][$MRQRow])."'";
                $query .= ")";
                mysql_query($query) or die (mysql_error());

                $query = "INSERT INTO `pttm_gf_data` (`ticker_id`, `InterestIncome`, `InterestExpense`, `EPSBasic`, `EPSDiluted`, `SharesOutstandingDiluted`, `InventoriesRawMaterialsComponents`, `InventoriesWorkInProcess`, `InventoriesInventoriesAdjustments`, `InventoriesFinishedGoods`, `InventoriesOther`, `TotalInventories`, `LandAndImprovements`, `BuildingsAndImprovements`, `MachineryFurnitureEquipment`, `ConstructionInProgress`, `GrossPropertyPlantandEquipment`, `SharesOutstandingBasic`) VALUES (";
                $query .= "'".$dates->ticker_id."',";
                $query .= "'".toFloat($rawdata["InterestIncome"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["InterestExpense"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["EPSBasic"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["EPSDiluted"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["SharesOutstandingDiluted"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["InventoriesRawMaterialsComponents"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["InventoriesWorkInProcess"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["InventoriesInventoriesAdjustments"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["InventoriesFinishedGoods"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["InventoriesOther"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["TotalInventories"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["LandAndImprovements"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["BuildingsAndImprovements"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["MachineryFurnitureEquipment"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["ConstructionInProgress"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["GrossPropertyPlantandEquipment"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["SharesOutstandingBasic"][$PMRQRow])."'";
                $query .= ")";
                mysql_query($query) or die (mysql_error());

		$query = "INSERT INTO `ttm_cashflowconsolidated` (`ticker_id`, `ChangeinCurrentAssets`, `ChangeinCurrentLiabilities`, `ChangeinDebtNet`, `ChangeinDeferredRevenue`, `ChangeinEquityNet`, `ChangeinIncomeTaxesPayable`, `ChangeinInventories`, `ChangeinOperatingAssetsLiabilities`, `ChangeinOtherAssets`, `ChangeinOtherCurrentAssets`, `ChangeinOtherCurrentLiabilities`, `ChangeinOtherLiabilities`, `ChangeinPrepaidExpenses`, `DividendsPaid`, `EffectofExchangeRateonCash`, `EmployeeCompensation`, `AcquisitionSaleofBusinessNet`, `AdjustmentforEquityEarnings`, `AdjustmentforMinorityInterest`, `AdjustmentforSpecialCharges`, `CapitalExpenditures`, `CashfromDiscontinuedOperations`, `CashfromFinancingActivities`, `CashfromInvestingActivities`, `CashfromOperatingActivities`, `CFDepreciationAmortization`, `DeferredIncomeTaxes`, `ChangeinAccountsPayableAccruedExpenses`, `ChangeinAccountsReceivable`, `InvestmentChangesNet`, `NetChangeinCash`, `OtherAdjustments`, `OtherAssetLiabilityChangesNet`, `OtherFinancingActivitiesNet`, `OtherInvestingActivities`, `RealizedGainsLosses`, `SaleofPropertyPlantEquipment`, `StockOptionTaxBenefits`, `TotalAdjustments`) VALUES (";
	       	$query .= "'".$dates->ticker_id."',";
        	$query .= "'".$rawdata["ChangeinCurrentAssets"][$MRQRow]."',";
        	$query .= "'".$rawdata["ChangeinCurrentLiabilities"][$MRQRow]."',";
        	$query .= "'".$rawdata["ChangeinDebtNet"][$MRQRow]."',";
        	$query .= "'".$rawdata["ChangeinDeferredRevenue"][$MRQRow]."',";
        	$query .= "'".$rawdata["ChangeinEquityNet"][$MRQRow]."',";
        	$query .= "'".$rawdata["ChangeinIncomeTaxesPayable"][$MRQRow]."',";
        	$query .= "'".$rawdata["ChangeinInventories"][$MRQRow]."',";
        	$query .= "'".$rawdata["ChangeinOperatingAssetsLiabilities"][$MRQRow]."',";
        	$query .= "'".$rawdata["ChangeinOtherAssets"][$MRQRow]."',";
        	$query .= "'".$rawdata["ChangeinOtherCurrentAssets"][$MRQRow]."',";
        	$query .= "'".$rawdata["ChangeinOtherCurrentLiabilities"][$MRQRow]."',";
        	$query .= "'".$rawdata["ChangeinOtherLiabilities"][$MRQRow]."',";
        	$query .= "'".$rawdata["ChangeinPrepaidExpenses"][$MRQRow]."',";
        	$query .= "'".$rawdata["DividendsPaid"][$MRQRow]."',";
        	$query .= "'".$rawdata["EffectofExchangeRateonCash"][$MRQRow]."',";
        	$query .= "'".$rawdata["EmployeeCompensation"][$MRQRow]."',";
        	$query .= "'".$rawdata["AcquisitionSaleofBusinessNet"][$MRQRow]."',";
        	$query .= "'".$rawdata["AdjustmentforEquityEarnings"][$MRQRow]."',";
        	$query .= "'".$rawdata["AdjustmentforMinorityInterest"][$MRQRow]."',";
        	$query .= "'".$rawdata["AdjustmentforSpecialCharges"][$MRQRow]."',";
        	$query .= "'".$rawdata["CapitalExpenditures"][$MRQRow]."',";
        	$query .= "'".$rawdata["CashfromDiscontinuedOperations"][$MRQRow]."',";
        	$query .= "'".$rawdata["CashfromFinancingActivities"][$MRQRow]."',";
        	$query .= "'".$rawdata["CashfromInvestingActivities"][$MRQRow]."',";
        	$query .= "'".$rawdata["CashfromOperatingActivities"][$MRQRow]."',";
        	$query .= "'".$rawdata["CFDepreciationAmortization"][$MRQRow]."',";
        	$query .= "'".$rawdata["DeferredIncomeTaxes"][$MRQRow]."',";
        	$query .= "'".$rawdata["ChangeinAccountsPayableAccruedExpenses"][$MRQRow]."',";
        	$query .= "'".$rawdata["ChangeinAccountsReceivable"][$MRQRow]."',";
        	$query .= "'".$rawdata["InvestmentChangesNet"][$MRQRow]."',";
        	$query .= "'".$rawdata["NetChangeinCash"][$MRQRow]."',";
        	$query .= "'".$rawdata["OtherAdjustments"][$MRQRow]."',";
        	$query .= "'".$rawdata["OtherAssetLiabilityChangesNet"][$MRQRow]."',";
        	$query .= "'".$rawdata["OtherFinancingActivitiesNet"][$MRQRow]."',";
        	$query .= "'".$rawdata["OtherInvestingActivities"][$MRQRow]."',";
        	$query .= "'".$rawdata["RealizedGainsLosses"][$MRQRow]."',";
        	$query .= "'".$rawdata["SaleofPropertyPlantEquipment"][$MRQRow]."',";
        	$query .= "'".$rawdata["StockOptionTaxBenefits"][$MRQRow]."',";
        	$query .= "'".$rawdata["TotalAdjustments"][$MRQRow]."'";
        	$query .= ")";
	       	mysql_query($query) or die (mysql_error());
		
		$query = "INSERT INTO `pttm_cashflowconsolidated` (`ticker_id`, `ChangeinCurrentAssets`, `ChangeinCurrentLiabilities`, `ChangeinDebtNet`, `ChangeinDeferredRevenue`, `ChangeinEquityNet`, `ChangeinIncomeTaxesPayable`, `ChangeinInventories`, `ChangeinOperatingAssetsLiabilities`, `ChangeinOtherAssets`, `ChangeinOtherCurrentAssets`, `ChangeinOtherCurrentLiabilities`, `ChangeinOtherLiabilities`, `ChangeinPrepaidExpenses`, `DividendsPaid`, `EffectofExchangeRateonCash`, `EmployeeCompensation`, `AcquisitionSaleofBusinessNet`, `AdjustmentforEquityEarnings`, `AdjustmentforMinorityInterest`, `AdjustmentforSpecialCharges`, `CapitalExpenditures`, `CashfromDiscontinuedOperations`, `CashfromFinancingActivities`, `CashfromInvestingActivities`, `CashfromOperatingActivities`, `CFDepreciationAmortization`, `DeferredIncomeTaxes`, `ChangeinAccountsPayableAccruedExpenses`, `ChangeinAccountsReceivable`, `InvestmentChangesNet`, `NetChangeinCash`, `OtherAdjustments`, `OtherAssetLiabilityChangesNet`, `OtherFinancingActivitiesNet`, `OtherInvestingActivities`, `RealizedGainsLosses`, `SaleofPropertyPlantEquipment`, `StockOptionTaxBenefits`, `TotalAdjustments`) VALUES (";
	       	$query .= "'".$dates->ticker_id."',";
        	$query .= "'".$rawdata["ChangeinCurrentAssets"][$PMRQRow]."',";
        	$query .= "'".$rawdata["ChangeinCurrentLiabilities"][$PMRQRow]."',";
        	$query .= "'".$rawdata["ChangeinDebtNet"][$PMRQRow]."',";
        	$query .= "'".$rawdata["ChangeinDeferredRevenue"][$PMRQRow]."',";
        	$query .= "'".$rawdata["ChangeinEquityNet"][$PMRQRow]."',";
        	$query .= "'".$rawdata["ChangeinIncomeTaxesPayable"][$PMRQRow]."',";
        	$query .= "'".$rawdata["ChangeinInventories"][$PMRQRow]."',";
        	$query .= "'".$rawdata["ChangeinOperatingAssetsLiabilities"][$PMRQRow]."',";
        	$query .= "'".$rawdata["ChangeinOtherAssets"][$PMRQRow]."',";
        	$query .= "'".$rawdata["ChangeinOtherCurrentAssets"][$PMRQRow]."',";
        	$query .= "'".$rawdata["ChangeinOtherCurrentLiabilities"][$PMRQRow]."',";
        	$query .= "'".$rawdata["ChangeinOtherLiabilities"][$PMRQRow]."',";
        	$query .= "'".$rawdata["ChangeinPrepaidExpenses"][$PMRQRow]."',";
        	$query .= "'".$rawdata["DividendsPaid"][$PMRQRow]."',";
        	$query .= "'".$rawdata["EffectofExchangeRateonCash"][$PMRQRow]."',";
        	$query .= "'".$rawdata["EmployeeCompensation"][$PMRQRow]."',";
        	$query .= "'".$rawdata["AcquisitionSaleofBusinessNet"][$PMRQRow]."',";
        	$query .= "'".$rawdata["AdjustmentforEquityEarnings"][$PMRQRow]."',";
        	$query .= "'".$rawdata["AdjustmentforMinorityInterest"][$PMRQRow]."',";
        	$query .= "'".$rawdata["AdjustmentforSpecialCharges"][$PMRQRow]."',";
        	$query .= "'".$rawdata["CapitalExpenditures"][$PMRQRow]."',";
        	$query .= "'".$rawdata["CashfromDiscontinuedOperations"][$PMRQRow]."',";
        	$query .= "'".$rawdata["CashfromFinancingActivities"][$PMRQRow]."',";
        	$query .= "'".$rawdata["CashfromInvestingActivities"][$PMRQRow]."',";
        	$query .= "'".$rawdata["CashfromOperatingActivities"][$PMRQRow]."',";
        	$query .= "'".$rawdata["CFDepreciationAmortization"][$PMRQRow]."',";
        	$query .= "'".$rawdata["DeferredIncomeTaxes"][$PMRQRow]."',";
        	$query .= "'".$rawdata["ChangeinAccountsPayableAccruedExpenses"][$PMRQRow]."',";
        	$query .= "'".$rawdata["ChangeinAccountsReceivable"][$PMRQRow]."',";
        	$query .= "'".$rawdata["InvestmentChangesNet"][$PMRQRow]."',";
        	$query .= "'".$rawdata["NetChangeinCash"][$PMRQRow]."',";
        	$query .= "'".$rawdata["OtherAdjustments"][$PMRQRow]."',";
        	$query .= "'".$rawdata["OtherAssetLiabilityChangesNet"][$PMRQRow]."',";
        	$query .= "'".$rawdata["OtherFinancingActivitiesNet"][$PMRQRow]."',";
        	$query .= "'".$rawdata["OtherInvestingActivities"][$PMRQRow]."',";
        	$query .= "'".$rawdata["RealizedGainsLosses"][$PMRQRow]."',";
        	$query .= "'".$rawdata["SaleofPropertyPlantEquipment"][$PMRQRow]."',";
        	$query .= "'".$rawdata["StockOptionTaxBenefits"][$PMRQRow]."',";
        	$query .= "'".$rawdata["TotalAdjustments"][$PMRQRow]."'";
        	$query .= ")";
	       	mysql_query($query) or die (mysql_error());

		$query = "INSERT INTO `ttm_cashflowfull` (`ticker_id`, `ChangeinLongtermDebtNet`, `ChangeinShorttermBorrowingsNet`, `CashandCashEquivalentsBeginningofYear`, `CashandCashEquivalentsEndofYear`, `CashPaidforIncomeTaxes`, `CashPaidforInterestExpense`, `CFNetIncome`, `IssuanceofEquity`, `LongtermDebtPayments`, `LongtermDebtProceeds`, `OtherDebtNet`, `OtherEquityTransactionsNet`, `OtherInvestmentChangesNet`, `PurchaseofInvestments`, `RepurchaseofEquity`, `SaleofInvestments`, `ShorttermBorrowings`, `ShorttermInvestments`, `TotalNoncashAdjustments`) VALUES (";
        	$query .= "'".$dates->ticker_id."',";
       		$query .= "'".$rawdata["ChangeinLongtermDebtNet"][$MRQRow]."',";
       		$query .= "'".$rawdata["ChangeinShorttermBorrowingsNet"][$MRQRow]."',";
       		$query .= "'".$rawdata["CashandCashEquivalentsBeginningofYear"][$MRQRow]."',";
       		$query .= "'".$rawdata["CashandCashEquivalentsEndofYear"][$MRQRow]."',";
       		$query .= "'".$rawdata["CashPaidforIncomeTaxes"][$MRQRow]."',";
      		$query .= "'".$rawdata["CashPaidforInterestExpense"][$MRQRow]."',";
       		$query .= "'".$rawdata["CFNetIncome"][$MRQRow]."',";
       		$query .= "'".$rawdata["IssuanceofEquity"][$MRQRow]."',";
       		$query .= "'".$rawdata["LongtermDebtPayments"][$MRQRow]."',";
       		$query .= "'".$rawdata["LongtermDebtProceeds"][$MRQRow]."',";
      		$query .= "'".$rawdata["OtherDebtNet"][$MRQRow]."',";
       		$query .= "'".$rawdata["OtherEquityTransactionsNet"][$MRQRow]."',";
       		$query .= "'".$rawdata["OtherInvestmentChangesNet"][$MRQRow]."',";
       		$query .= "'".$rawdata["PurchaseofInvestments"][$MRQRow]."',";
       		$query .= "'".$rawdata["RepurchaseofEquity"][$MRQRow]."',";
       		$query .= "'".$rawdata["SaleofInvestments"][$MRQRow]."',";
       		$query .= "'".$rawdata["ShorttermBorrowings"][$MRQRow]."',";
       		$query .= "'".$rawdata["ShorttermInvestments"][$MRQRow]."',";
       		$query .= "'".$rawdata["TotalNoncashAdjustments"][$MRQRow]."'";
       		$query .= ")";
        	mysql_query($query) or die (mysql_error());

		$query = "INSERT INTO `pttm_cashflowfull` (`ticker_id`, `ChangeinLongtermDebtNet`, `ChangeinShorttermBorrowingsNet`, `CashandCashEquivalentsBeginningofYear`, `CashandCashEquivalentsEndofYear`, `CashPaidforIncomeTaxes`, `CashPaidforInterestExpense`, `CFNetIncome`, `IssuanceofEquity`, `LongtermDebtPayments`, `LongtermDebtProceeds`, `OtherDebtNet`, `OtherEquityTransactionsNet`, `OtherInvestmentChangesNet`, `PurchaseofInvestments`, `RepurchaseofEquity`, `SaleofInvestments`, `ShorttermBorrowings`, `ShorttermInvestments`, `TotalNoncashAdjustments`) VALUES (";
        	$query .= "'".$dates->ticker_id."',";
       		$query .= "'".$rawdata["ChangeinLongtermDebtNet"][$PMRQRow]."',";
       		$query .= "'".$rawdata["ChangeinShorttermBorrowingsNet"][$PMRQRow]."',";
       		$query .= "'".$rawdata["CashandCashEquivalentsBeginningofYear"][$PMRQRow]."',";
       		$query .= "'".$rawdata["CashandCashEquivalentsEndofYear"][$PMRQRow]."',";
       		$query .= "'".$rawdata["CashPaidforIncomeTaxes"][$PMRQRow]."',";
      		$query .= "'".$rawdata["CashPaidforInterestExpense"][$PMRQRow]."',";
       		$query .= "'".$rawdata["CFNetIncome"][$PMRQRow]."',";
       		$query .= "'".$rawdata["IssuanceofEquity"][$PMRQRow]."',";
       		$query .= "'".$rawdata["LongtermDebtPayments"][$PMRQRow]."',";
       		$query .= "'".$rawdata["LongtermDebtProceeds"][$PMRQRow]."',";
      		$query .= "'".$rawdata["OtherDebtNet"][$PMRQRow]."',";
       		$query .= "'".$rawdata["OtherEquityTransactionsNet"][$PMRQRow]."',";
       		$query .= "'".$rawdata["OtherInvestmentChangesNet"][$PMRQRow]."',";
       		$query .= "'".$rawdata["PurchaseofInvestments"][$PMRQRow]."',";
       		$query .= "'".$rawdata["RepurchaseofEquity"][$PMRQRow]."',";
       		$query .= "'".$rawdata["SaleofInvestments"][$PMRQRow]."',";
       		$query .= "'".$rawdata["ShorttermBorrowings"][$PMRQRow]."',";
       		$query .= "'".$rawdata["ShorttermInvestments"][$PMRQRow]."',";
       		$query .= "'".$rawdata["TotalNoncashAdjustments"][$PMRQRow]."'";
       		$query .= ")";
        	mysql_query($query) or die (mysql_error());

		$query = "INSERT INTO `ttm_incomeconsolidated` (`ticker_id`, `EBIT`, `CostofRevenue`, `DepreciationAmortizationExpense`, `DilutedEPSNetIncome`, `DiscontinuedOperations`, `EquityEarnings`, `AccountingChange`, `BasicEPSNetIncome`, `ExtraordinaryItems`, `GrossProfit`, `IncomebeforeExtraordinaryItems`, `IncomeBeforeTaxes`, `IncomeTaxes`, `InterestExpense`, `InterestIncome`, `MinorityInterestEquityEarnings`, `NetIncome`, `NetIncomeApplicabletoCommon`, `OperatingProfit`, `OtherNonoperatingIncomeExpense`, `OtherOperatingExpenses`, `ResearchDevelopmentExpense`, `RestructuringRemediationImpairmentProvisions`, `TotalRevenue`, `SellingGeneralAdministrativeExpenses`) VALUES (";
        	$query .= "'".$dates->ticker_id."',";
       		$query .= "'".$rawdata["EBIT"][$MRQRow]."',";
       		$query .= "'".$rawdata["CostofRevenue"][$MRQRow]."',";
       		$query .= "'".$rawdata["DepreciationAmortizationExpense"][$MRQRow]."',";
      		$query .= "'".$rawdata["DilutedEPSNetIncome"][$MRQRow]."',";
       		$query .= "'".$rawdata["DiscontinuedOperations"][$MRQRow]."',";
       		$query .= "'".$rawdata["EquityEarnings"][$MRQRow]."',";
      		$query .= "'".$rawdata["AccountingChange"][$MRQRow]."',";
       		$query .= "'".$rawdata["BasicEPSNetIncome"][$MRQRow]."',";
       		$query .= "'".$rawdata["ExtraordinaryItems"][$MRQRow]."',";
       		$query .= "'".$rawdata["GrossProfit"][$MRQRow]."',";
       		$query .= "'".$rawdata["IncomebeforeExtraordinaryItems"][$MRQRow]."',";
       		$query .= "'".$rawdata["IncomeBeforeTaxes"][$MRQRow]."',";
       		$query .= "'".$rawdata["IncomeTaxes"][$MRQRow]."',";
       		$query .= "'".$rawdata["InterestExpense"][$MRQRow]."',";
       		$query .= "'".$rawdata["InterestIncome"][$MRQRow]."',";
       		$query .= "'".$rawdata["MinorityInterestEquityEarnings"][$MRQRow]."',";
       		$query .= "'".$rawdata["NetIncome"][$MRQRow]."',";
       		$query .= "'".$rawdata["NetIncomeApplicabletoCommon"][$MRQRow]."',";
       		$query .= "'".$rawdata["OperatingProfit"][$MRQRow]."',";
       		$query .= "'".$rawdata["OtherNonoperatingIncomeExpense"][$MRQRow]."',";
      		$query .= "'".$rawdata["OtherOperatingExpenses"][$MRQRow]."',";
       		$query .= "'".$rawdata["ResearchDevelopmentExpense"][$MRQRow]."',";
       		$query .= "'".$rawdata["RestructuringRemediationImpairmentProvisions"][$MRQRow]."',";
       		$query .= "'".$rawdata["TotalRevenue"][$MRQRow]."',";
       		$query .= "'".$rawdata["SellingGeneralAdministrativeExpenses"][$MRQRow]."'";
       		$query .= ")";
        	mysql_query($query) or die (mysql_error());

		$query = "INSERT INTO `pttm_incomeconsolidated` (`ticker_id`, `EBIT`, `CostofRevenue`, `DepreciationAmortizationExpense`, `DilutedEPSNetIncome`, `DiscontinuedOperations`, `EquityEarnings`, `AccountingChange`, `BasicEPSNetIncome`, `ExtraordinaryItems`, `GrossProfit`, `IncomebeforeExtraordinaryItems`, `IncomeBeforeTaxes`, `IncomeTaxes`, `InterestExpense`, `InterestIncome`, `MinorityInterestEquityEarnings`, `NetIncome`, `NetIncomeApplicabletoCommon`, `OperatingProfit`, `OtherNonoperatingIncomeExpense`, `OtherOperatingExpenses`, `ResearchDevelopmentExpense`, `RestructuringRemediationImpairmentProvisions`, `TotalRevenue`, `SellingGeneralAdministrativeExpenses`) VALUES (";
        	$query .= "'".$dates->ticker_id."',";
       		$query .= "'".$rawdata["EBIT"][$PMRQRow]."',";
       		$query .= "'".$rawdata["CostofRevenue"][$PMRQRow]."',";
       		$query .= "'".$rawdata["DepreciationAmortizationExpense"][$PMRQRow]."',";
      		$query .= "'".$rawdata["DilutedEPSNetIncome"][$PMRQRow]."',";
       		$query .= "'".$rawdata["DiscontinuedOperations"][$PMRQRow]."',";
       		$query .= "'".$rawdata["EquityEarnings"][$PMRQRow]."',";
      		$query .= "'".$rawdata["AccountingChange"][$PMRQRow]."',";
       		$query .= "'".$rawdata["BasicEPSNetIncome"][$PMRQRow]."',";
       		$query .= "'".$rawdata["ExtraordinaryItems"][$PMRQRow]."',";
       		$query .= "'".$rawdata["GrossProfit"][$PMRQRow]."',";
       		$query .= "'".$rawdata["IncomebeforeExtraordinaryItems"][$PMRQRow]."',";
       		$query .= "'".$rawdata["IncomeBeforeTaxes"][$PMRQRow]."',";
       		$query .= "'".$rawdata["IncomeTaxes"][$PMRQRow]."',";
       		$query .= "'".$rawdata["InterestExpense"][$PMRQRow]."',";
       		$query .= "'".$rawdata["InterestIncome"][$PMRQRow]."',";
       		$query .= "'".$rawdata["MinorityInterestEquityEarnings"][$PMRQRow]."',";
       		$query .= "'".$rawdata["NetIncome"][$PMRQRow]."',";
       		$query .= "'".$rawdata["NetIncomeApplicabletoCommon"][$PMRQRow]."',";
       		$query .= "'".$rawdata["OperatingProfit"][$PMRQRow]."',";
       		$query .= "'".$rawdata["OtherNonoperatingIncomeExpense"][$PMRQRow]."',";
      		$query .= "'".$rawdata["OtherOperatingExpenses"][$PMRQRow]."',";
       		$query .= "'".$rawdata["ResearchDevelopmentExpense"][$PMRQRow]."',";
       		$query .= "'".$rawdata["RestructuringRemediationImpairmentProvisions"][$PMRQRow]."',";
       		$query .= "'".$rawdata["TotalRevenue"][$PMRQRow]."',";
       		$query .= "'".$rawdata["SellingGeneralAdministrativeExpenses"][$PMRQRow]."'";
       		$query .= ")";
        	mysql_query($query) or die (mysql_error());

		$query = "INSERT INTO `ttm_incomefull` (`ticker_id`, `AdjustedEBIT`, `AdjustedEBITDA`, `AdjustedNetIncome`, `AftertaxMargin`, `EBITDA`, `GrossMargin`, `NetOperatingProfitafterTax`, `OperatingMargin`, `RevenueFQ`, `RevenueFY`, `RevenueTTM`, `CostOperatingExpenses`, `DepreciationExpense`, `DilutedEPSNetIncomefromContinuingOperations`, `DilutedWeightedAverageShares`, `AmortizationExpense`, `BasicEPSNetIncomefromContinuingOperations`, `BasicWeightedAverageShares`, `GeneralAdministrativeExpense`, `IncomeAfterTaxes`, `LaborExpense`, `NetIncomefromContinuingOperationsApplicabletoCommon`, `InterestIncomeExpenseNet`, `NoncontrollingInterest`, `NonoperatingGainsLosses`, `OperatingExpenses`, `OtherGeneralAdministrativeExpense`, `OtherInterestIncomeExpenseNet`, `OtherRevenue`, `OtherSellingGeneralAdministrativeExpenses`, `PreferredDividends`, `SalesMarketingExpense`, `TotalNonoperatingIncomeExpense`, `TotalOperatingExpenses`, `OperatingRevenue`) VALUES (";
        	$query .= "'".$dates->ticker_id."',";
       		$query .= "'".$rawdata["AdjustedEBIT"][$MRQRow]."',";
       		$query .= "'".$rawdata["AdjustedEBITDA"][$MRQRow]."',";
      		$query .= "'".$rawdata["AdjustedNetIncome"][$MRQRow]."',";
       		$query .= "'".$rawdata["AftertaxMargin"][$MRQRow]."',";
       		$query .= "'".$rawdata["EBITDA"][$MRQRow]."',";
      		$query .= "'".$rawdata["GrossMargin"][$MRQRow]."',";
       		$query .= "'".$rawdata["NetOperatingProfitafterTax"][$MRQRow]."',";
       		$query .= "'".$rawdata["OperatingMargin"][$MRQRow]."',";
       		$query .= "'".$rawdata["RevenueFQ"][$MRQRow]."',";
      		$query .= "'".$rawdata["RevenueFY"][$MRQRow]."',";
       		$query .= "'".$rawdata["RevenueTTM"][$MRQRow]."',";
       		$query .= "'".$rawdata["CostOperatingExpenses"][$MRQRow]."',";
       		$query .= "'".$rawdata["DepreciationExpense"][$MRQRow]."',";
      		$query .= "'".$rawdata["DilutedEPSNetIncomefromContinuingOperations"][$MRQRow]."',";
       		$query .= "'".$rawdata["DilutedWeightedAverageShares"][$MRQRow]."',";
       		$query .= "'".$rawdata["AmortizationExpense"][$MRQRow]."',";
       		$query .= "'".$rawdata["BasicEPSNetIncomefromContinuingOperations"][$MRQRow]."',";
       		$query .= "'".$rawdata["BasicWeightedAverageShares"][$MRQRow]."',";
      		$query .= "'".$rawdata["GeneralAdministrativeExpense"][$MRQRow]."',";
       		$query .= "'".$rawdata["IncomeAfterTaxes"][$MRQRow]."',";
       		$query .= "'".$rawdata["LaborExpense"][$MRQRow]."',";
       		$query .= "'".$rawdata["NetIncomefromContinuingOperationsApplicabletoCommon"][$MRQRow]."',";
       		$query .= "'".$rawdata["InterestIncomeExpenseNet"][$MRQRow]."',";
       		$query .= "'".$rawdata["NoncontrollingInterest"][$MRQRow]."',";
       		$query .= "'".$rawdata["NonoperatingGainsLosses"][$MRQRow]."',";
       		$query .= "'".$rawdata["OperatingExpenses"][$MRQRow]."',";
       		$query .= "'".$rawdata["OtherGeneralAdministrativeExpense"][$MRQRow]."',";
       		$query .= "'".$rawdata["OtherInterestIncomeExpenseNet"][$MRQRow]."',";
       		$query .= "'".$rawdata["OtherRevenue"][$MRQRow]."',";
       		$query .= "'".$rawdata["OtherSellingGeneralAdministrativeExpenses"][$MRQRow]."',";
      		$query .= "'".$rawdata["PreferredDividends"][$MRQRow]."',";
       		$query .= "'".$rawdata["SalesMarketingExpense"][$MRQRow]."',";
       		$query .= "'".$rawdata["TotalNonoperatingIncomeExpense"][$MRQRow]."',";
       		$query .= "'".$rawdata["TotalOperatingExpenses"][$MRQRow]."',";
       		$query .= "'".$rawdata["OperatingRevenue"][$MRQRow]."'";
       		$query .= ")";
        	mysql_query($query) or die (mysql_error());

		$query = "INSERT INTO `pttm_incomefull` (`ticker_id`, `AdjustedEBIT`, `AdjustedEBITDA`, `AdjustedNetIncome`, `AftertaxMargin`, `EBITDA`, `GrossMargin`, `NetOperatingProfitafterTax`, `OperatingMargin`, `RevenueFQ`, `RevenueFY`, `RevenueTTM`, `CostOperatingExpenses`, `DepreciationExpense`, `DilutedEPSNetIncomefromContinuingOperations`, `DilutedWeightedAverageShares`, `AmortizationExpense`, `BasicEPSNetIncomefromContinuingOperations`, `BasicWeightedAverageShares`, `GeneralAdministrativeExpense`, `IncomeAfterTaxes`, `LaborExpense`, `NetIncomefromContinuingOperationsApplicabletoCommon`, `InterestIncomeExpenseNet`, `NoncontrollingInterest`, `NonoperatingGainsLosses`, `OperatingExpenses`, `OtherGeneralAdministrativeExpense`, `OtherInterestIncomeExpenseNet`, `OtherRevenue`, `OtherSellingGeneralAdministrativeExpenses`, `PreferredDividends`, `SalesMarketingExpense`, `TotalNonoperatingIncomeExpense`, `TotalOperatingExpenses`, `OperatingRevenue`) VALUES (";
        	$query .= "'".$dates->ticker_id."',";
       		$query .= "'".$rawdata["AdjustedEBIT"][$PMRQRow]."',";
       		$query .= "'".$rawdata["AdjustedEBITDA"][$PMRQRow]."',";
      		$query .= "'".$rawdata["AdjustedNetIncome"][$PMRQRow]."',";
       		$query .= "'".$rawdata["AftertaxMargin"][$PMRQRow]."',";
       		$query .= "'".$rawdata["EBITDA"][$PMRQRow]."',";
      		$query .= "'".$rawdata["GrossMargin"][$PMRQRow]."',";
       		$query .= "'".$rawdata["NetOperatingProfitafterTax"][$PMRQRow]."',";
       		$query .= "'".$rawdata["OperatingMargin"][$PMRQRow]."',";
       		$query .= "'".$rawdata["RevenueFQ"][$PMRQRow]."',";
      		$query .= "'".$rawdata["RevenueFY"][$PMRQRow]."',";
       		$query .= "'".$rawdata["RevenueTTM"][$PMRQRow]."',";
       		$query .= "'".$rawdata["CostOperatingExpenses"][$PMRQRow]."',";
       		$query .= "'".$rawdata["DepreciationExpense"][$PMRQRow]."',";
      		$query .= "'".$rawdata["DilutedEPSNetIncomefromContinuingOperations"][$PMRQRow]."',";
       		$query .= "'".$rawdata["DilutedWeightedAverageShares"][$PMRQRow]."',";
       		$query .= "'".$rawdata["AmortizationExpense"][$PMRQRow]."',";
       		$query .= "'".$rawdata["BasicEPSNetIncomefromContinuingOperations"][$PMRQRow]."',";
       		$query .= "'".$rawdata["BasicWeightedAverageShares"][$PMRQRow]."',";
      		$query .= "'".$rawdata["GeneralAdministrativeExpense"][$PMRQRow]."',";
       		$query .= "'".$rawdata["IncomeAfterTaxes"][$PMRQRow]."',";
       		$query .= "'".$rawdata["LaborExpense"][$PMRQRow]."',";
       		$query .= "'".$rawdata["NetIncomefromContinuingOperationsApplicabletoCommon"][$PMRQRow]."',";
       		$query .= "'".$rawdata["InterestIncomeExpenseNet"][$PMRQRow]."',";
       		$query .= "'".$rawdata["NoncontrollingInterest"][$PMRQRow]."',";
       		$query .= "'".$rawdata["NonoperatingGainsLosses"][$PMRQRow]."',";
       		$query .= "'".$rawdata["OperatingExpenses"][$PMRQRow]."',";
       		$query .= "'".$rawdata["OtherGeneralAdministrativeExpense"][$PMRQRow]."',";
       		$query .= "'".$rawdata["OtherInterestIncomeExpenseNet"][$PMRQRow]."',";
       		$query .= "'".$rawdata["OtherRevenue"][$PMRQRow]."',";
       		$query .= "'".$rawdata["OtherSellingGeneralAdministrativeExpenses"][$PMRQRow]."',";
      		$query .= "'".$rawdata["PreferredDividends"][$PMRQRow]."',";
       		$query .= "'".$rawdata["SalesMarketingExpense"][$PMRQRow]."',";
       		$query .= "'".$rawdata["TotalNonoperatingIncomeExpense"][$PMRQRow]."',";
       		$query .= "'".$rawdata["TotalOperatingExpenses"][$PMRQRow]."',";
       		$query .= "'".$rawdata["OperatingRevenue"][$PMRQRow]."'";
       		$query .= ")";
        	mysql_query($query) or die (mysql_error());

                $query = "INSERT INTO `ttm_financialscustom` (`ticker_id`, `COGSPercent`, `GrossMarginPercent`, `SGAPercent`, `RDPercent`, `DepreciationAmortizationPercent`, `EBITDAPercent`, `OperatingMarginPercent`, `EBITPercent`, `TaxRatePercent`, `IncomeAfterTaxes`, `NetMarginPercent`, `DividendsPerShare`, `ShortTermDebtAndCurrentPortion`, `TotalLongTermDebtAndNotesPayable`, `NetChangeLongTermDebt`, `CapEx`, `FreeCashFlow`, `OwnerEarningsFCF`) VALUES (";
                $query .= "'".$dates->ticker_id."',";
                $query .= "'".($rawdata["CostofRevenue"][$MRQRow]/$rawdata["TotalRevenue"][$MRQRow])."',";
                $query .= "'".($rawdata["GrossProfit"][$MRQRow]/$rawdata["TotalRevenue"][$MRQRow])."',";
                $query .= "'".($rawdata["SellingGeneralAdministrativeExpenses"][$MRQRow]/$rawdata["TotalRevenue"][$MRQRow])."',";
                $query .= "'".($rawdata["ResearchDevelopmentExpense"][$MRQRow]/$rawdata["TotalRevenue"][$MRQRow])."',";
                $query .= "'".($rawdata["CFDepreciationAmortization"][$MRQRow]/$rawdata["TotalRevenue"][$MRQRow])."',";
                $query .= "'".($rawdata["EBITDA"][$MRQRow]/$rawdata["TotalRevenue"][$MRQRow])."',";
                $query .= "'".($rawdata["OperatingProfit"][$MRQRow]/$rawdata["TotalRevenue"][$MRQRow])."',";
                $query .= "'".($rawdata["EBIT"][$MRQRow]/$rawdata["TotalRevenue"][$MRQRow])."',";
                $query .= "'".($rawdata["IncomeTaxes"][$MRQRow]/$rawdata["IncomeBeforeTaxes"][$MRQRow])."',";
                $query .= "'".($rawdata["IncomeBeforeTaxes"][$MRQRow]-$rawdata["IncomeTaxes"][$MRQRow])."',";
                $query .= "'".($rawdata["NetIncome"][$MRQRow]/$rawdata["TotalRevenue"][$MRQRow])."',";
		$query .= "'".(-($rawdata["DividendsPaid"][$MRQRow])/(toFloat($rawdata["SharesOutstandingBasic"][$MRQRow])*1000000))."',";
                $query .= "'".($rawdata["CurrentPortionofLongtermDebt"][$MRQRow]+$rawdata["ShorttermBorrowings"][$MRQRow])."',";
                $query .= "'".($rawdata["TotalLongtermDebt"][$MRQRow]+$rawdata["NotesPayable"][$MRQRow])."',";
                $query .= "'".($rawdata["LongtermDebtProceeds"][$MRQRow]+$rawdata["LongtermDebtPayments"][$MRQRow])."',";
                $query .= "'".(-$rawdata["CapitalExpenditures"][$MRQRow])."',";
                $query .= "'".($rawdata["CashfromOperatingActivities"][$MRQRow]+$rawdata["CapitalExpenditures"][$MRQRow])."',";
                $query .= "'".($rawdata["CFNetIncome"][$MRQRow]+$rawdata["CFDepreciationAmortization"][$MRQRow]+$rawdata["EmployeeCompensation"][$MRQRow]+$rawdata["AdjustmentforSpecialCharges"][$MRQRow]+$rawdata["DeferredIncomeTaxes"][$MRQRow]+$rawdata["CapitalExpenditures"][$MRQRow]-($rawdata["ChangeinCurrentAssets"][$MRQRow]-$rawdata["ChangeinCurrentLiabilities"][$MRQRow]))."'";
        	$query .= ")";
	       	mysql_query($query) or die (mysql_error());

                $query = "INSERT INTO `pttm_financialscustom` (`ticker_id`, `COGSPercent`, `GrossMarginPercent`, `SGAPercent`, `RDPercent`, `DepreciationAmortizationPercent`, `EBITDAPercent`, `OperatingMarginPercent`, `EBITPercent`, `TaxRatePercent`, `IncomeAfterTaxes`, `NetMarginPercent`, `DividendsPerShare`, `ShortTermDebtAndCurrentPortion`, `TotalLongTermDebtAndNotesPayable`, `NetChangeLongTermDebt`, `CapEx`, `FreeCashFlow`, `OwnerEarningsFCF`) VALUES (";
                $query .= "'".$dates->ticker_id."',";
                $query .= "'".($rawdata["CostofRevenue"][$PMRQRow]/$rawdata["TotalRevenue"][$PMRQRow])."',";
                $query .= "'".($rawdata["GrossProfit"][$PMRQRow]/$rawdata["TotalRevenue"][$PMRQRow])."',";
                $query .= "'".($rawdata["SellingGeneralAdministrativeExpenses"][$PMRQRow]/$rawdata["TotalRevenue"][$PMRQRow])."',";
                $query .= "'".($rawdata["ResearchDevelopmentExpense"][$PMRQRow]/$rawdata["TotalRevenue"][$PMRQRow])."',";
                $query .= "'".($rawdata["CFDepreciationAmortization"][$PMRQRow]/$rawdata["TotalRevenue"][$PMRQRow])."',";
                $query .= "'".($rawdata["EBITDA"][$PMRQRow]/$rawdata["TotalRevenue"][$PMRQRow])."',";
                $query .= "'".($rawdata["OperatingProfit"][$PMRQRow]/$rawdata["TotalRevenue"][$PMRQRow])."',";
                $query .= "'".($rawdata["EBIT"][$PMRQRow]/$rawdata["TotalRevenue"][$PMRQRow])."',";
                $query .= "'".($rawdata["IncomeTaxes"][$PMRQRow]/$rawdata["IncomeBeforeTaxes"][$PMRQRow])."',";
                $query .= "'".($rawdata["IncomeBeforeTaxes"][$PMRQRow]-$rawdata["IncomeTaxes"][$PMRQRow])."',";
                $query .= "'".($rawdata["NetIncome"][$PMRQRow]/$rawdata["TotalRevenue"][$PMRQRow])."',";
		$query .= "'".(-($rawdata["DividendsPaid"][$PMRQRow])/(toFloat($rawdata["SharesOutstandingBasic"][$PMRQRow])*1000000))."',";
                $query .= "'".($rawdata["CurrentPortionofLongtermDebt"][$PMRQRow]+$rawdata["ShorttermBorrowings"][$PMRQRow])."',";
                $query .= "'".($rawdata["TotalLongtermDebt"][$PMRQRow]+$rawdata["NotesPayable"][$PMRQRow])."',";
                $query .= "'".($rawdata["LongtermDebtProceeds"][$PMRQRow]+$rawdata["LongtermDebtPayments"][$PMRQRow])."',";
                $query .= "'".(-$rawdata["CapitalExpenditures"][$PMRQRow])."',";
                $query .= "'".($rawdata["CashfromOperatingActivities"][$PMRQRow]+$rawdata["CapitalExpenditures"][$PMRQRow])."',";
                $query .= "'".($rawdata["CFNetIncome"][$PMRQRow]+$rawdata["CFDepreciationAmortization"][$PMRQRow]+$rawdata["EmployeeCompensation"][$PMRQRow]+$rawdata["AdjustmentforSpecialCharges"][$PMRQRow]+$rawdata["DeferredIncomeTaxes"][$PMRQRow]+$rawdata["CapitalExpenditures"][$PMRQRow]-($rawdata["ChangeinCurrentAssets"][$PMRQRow]-$rawdata["ChangeinCurrentLiabilities"][$PMRQRow]))."'";
        	$query .= ")";
	       	mysql_query($query) or die (mysql_error());
	} else {
                $query = "INSERT INTO `ttm_gf_data` (`ticker_id`, `InterestIncome`, `InterestExpense`, `EPSBasic`, `EPSDiluted`, `SharesOutstandingDiluted`, `InventoriesRawMaterialsComponents`, `InventoriesWorkInProcess`, `InventoriesInventoriesAdjustments`, `InventoriesFinishedGoods`, `InventoriesOther`, `TotalInventories`, `LandAndImprovements`, `BuildingsAndImprovements`, `MachineryFurnitureEquipment`, `ConstructionInProgress`, `GrossPropertyPlantandEquipment`, `SharesOutstandingBasic`) VALUES (";
                $query .= "'".$dates->ticker_id."',";
                $query .= "'".(toFloat($rawdata["InterestIncome"][23])+toFloat($rawdata["InterestIncome"][24])+toFloat($rawdata["InterestIncome"][25])+toFloat($rawdata["InterestIncome"][26]))."',";
                $query .= "'".(toFloat($rawdata["InterestExpense"][23])+toFloat($rawdata["InterestExpense"][24])+toFloat($rawdata["InterestExpense"][25])+toFloat($rawdata["InterestExpense"][26]))."',";
                $query .= "'".(toFloat($rawdata["EPSBasic"][23])+toFloat($rawdata["EPSBasic"][24])+toFloat($rawdata["EPSBasic"][25])+toFloat($rawdata["EPSBasic"][26]))."',";
                $query .= "'".(toFloat($rawdata["EPSDiluted"][23])+toFloat($rawdata["EPSDiluted"][24])+toFloat($rawdata["EPSDiluted"][25])+toFloat($rawdata["EPSDiluted"][26]))."',";
                $query .= "'".toFloat($rawdata["SharesOutstandingDiluted"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["InventoriesRawMaterialsComponents"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["InventoriesWorkInProcess"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["InventoriesInventoriesAdjustments"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["InventoriesFinishedGoods"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["InventoriesOther"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["TotalInventories"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["LandAndImprovements"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["BuildingsAndImprovements"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["MachineryFurnitureEquipment"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["ConstructionInProgress"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["GrossPropertyPlantandEquipment"][$MRQRow])."',";
                $query .= "'".toFloat($rawdata["SharesOutstandingBasic"][$MRQRow])."'";
                $query .= ")";
                mysql_query($query) or die (mysql_error());

                $query = "INSERT INTO `pttm_gf_data` (`ticker_id`, `InterestIncome`, `InterestExpense`, `EPSBasic`, `EPSDiluted`, `SharesOutstandingDiluted`, `InventoriesRawMaterialsComponents`, `InventoriesWorkInProcess`, `InventoriesInventoriesAdjustments`, `InventoriesFinishedGoods`, `InventoriesOther`, `TotalInventories`, `LandAndImprovements`, `BuildingsAndImprovements`, `MachineryFurnitureEquipment`, `ConstructionInProgress`, `GrossPropertyPlantandEquipment`, `SharesOutstandingBasic`) VALUES (";
                $query .= "'".$dates->ticker_id."',";
                $query .= "'".(toFloat($rawdata["InterestIncome"][19])+toFloat($rawdata["InterestIncome"][20])+toFloat($rawdata["InterestIncome"][21])+toFloat($rawdata["InterestIncome"][22]))."',";
                $query .= "'".(toFloat($rawdata["InterestExpense"][19])+toFloat($rawdata["InterestExpense"][20])+toFloat($rawdata["InterestExpense"][21])+toFloat($rawdata["InterestExpense"][22]))."',";
                $query .= "'".(toFloat($rawdata["EPSBasic"][19])+toFloat($rawdata["EPSBasic"][20])+toFloat($rawdata["EPSBasic"][21])+toFloat($rawdata["EPSBasic"][22]))."',";
                $query .= "'".(toFloat($rawdata["EPSDiluted"][19])+toFloat($rawdata["EPSDiluted"][20])+toFloat($rawdata["EPSDiluted"][21])+toFloat($rawdata["EPSDiluted"][22]))."',";
                $query .= "'".toFloat($rawdata["SharesOutstandingDiluted"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["InventoriesRawMaterialsComponents"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["InventoriesWorkInProcess"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["InventoriesInventoriesAdjustments"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["InventoriesFinishedGoods"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["InventoriesOther"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["TotalInventories"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["LandAndImprovements"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["BuildingsAndImprovements"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["MachineryFurnitureEquipment"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["ConstructionInProgress"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["GrossPropertyPlantandEquipment"][$PMRQRow])."',";
                $query .= "'".toFloat($rawdata["SharesOutstandingBasic"][$PMRQRow])."'";
                $query .= ")";
                mysql_query($query) or die (mysql_error());

		$query = "INSERT INTO `ttm_cashflowconsolidated` (`ticker_id`, `ChangeinCurrentAssets`, `ChangeinCurrentLiabilities`, `ChangeinDebtNet`, `ChangeinDeferredRevenue`, `ChangeinEquityNet`, `ChangeinIncomeTaxesPayable`, `ChangeinInventories`, `ChangeinOperatingAssetsLiabilities`, `ChangeinOtherAssets`, `ChangeinOtherCurrentAssets`, `ChangeinOtherCurrentLiabilities`, `ChangeinOtherLiabilities`, `ChangeinPrepaidExpenses`, `DividendsPaid`, `EffectofExchangeRateonCash`, `EmployeeCompensation`, `AcquisitionSaleofBusinessNet`, `AdjustmentforEquityEarnings`, `AdjustmentforMinorityInterest`, `AdjustmentforSpecialCharges`, `CapitalExpenditures`, `CashfromDiscontinuedOperations`, `CashfromFinancingActivities`, `CashfromInvestingActivities`, `CashfromOperatingActivities`, `CFDepreciationAmortization`, `DeferredIncomeTaxes`, `ChangeinAccountsPayableAccruedExpenses`, `ChangeinAccountsReceivable`, `InvestmentChangesNet`, `NetChangeinCash`, `OtherAdjustments`, `OtherAssetLiabilityChangesNet`, `OtherFinancingActivitiesNet`, `OtherInvestingActivities`, `RealizedGainsLosses`, `SaleofPropertyPlantEquipment`, `StockOptionTaxBenefits`, `TotalAdjustments`) VALUES (";
	       	$query .= "'".$dates->ticker_id."',";
        	$query .= "'".($rawdata["ChangeinCurrentAssets"][23]+$rawdata["ChangeinCurrentAssets"][24]+$rawdata["ChangeinCurrentAssets"][25]+$rawdata["ChangeinCurrentAssets"][26])."',";
        	$query .= "'".($rawdata["ChangeinCurrentLiabilities"][23]+$rawdata["ChangeinCurrentLiabilities"][24]+$rawdata["ChangeinCurrentLiabilities"][25]+$rawdata["ChangeinCurrentLiabilities"][26])."',";
        	$query .= "'".($rawdata["ChangeinDebtNet"][23]+$rawdata["ChangeinDebtNet"][24]+$rawdata["ChangeinDebtNet"][25]+$rawdata["ChangeinDebtNet"][26])."',";
        	$query .= "'".($rawdata["ChangeinDeferredRevenue"][23]+$rawdata["ChangeinDeferredRevenue"][24]+$rawdata["ChangeinDeferredRevenue"][25]+$rawdata["ChangeinDeferredRevenue"][26])."',";
        	$query .= "'".($rawdata["ChangeinEquityNet"][23]+$rawdata["ChangeinEquityNet"][24]+$rawdata["ChangeinEquityNet"][25]+$rawdata["ChangeinEquityNet"][26])."',";
        	$query .= "'".($rawdata["ChangeinIncomeTaxesPayable"][23]+$rawdata["ChangeinIncomeTaxesPayable"][24]+$rawdata["ChangeinIncomeTaxesPayable"][25]+$rawdata["ChangeinIncomeTaxesPayable"][26])."',";
        	$query .= "'".($rawdata["ChangeinInventories"][23]+$rawdata["ChangeinInventories"][24]+$rawdata["ChangeinInventories"][25]+$rawdata["ChangeinInventories"][26])."',";
        	$query .= "'".($rawdata["ChangeinOperatingAssetsLiabilities"][23]+$rawdata["ChangeinOperatingAssetsLiabilities"][24]+$rawdata["ChangeinOperatingAssetsLiabilities"][25]+$rawdata["ChangeinOperatingAssetsLiabilities"][26])."',";
        	$query .= "'".($rawdata["ChangeinOtherAssets"][23]+$rawdata["ChangeinOtherAssets"][24]+$rawdata["ChangeinOtherAssets"][25]+$rawdata["ChangeinOtherAssets"][26])."',";
        	$query .= "'".($rawdata["ChangeinOtherCurrentAssets"][23]+$rawdata["ChangeinOtherCurrentAssets"][24]+$rawdata["ChangeinOtherCurrentAssets"][25]+$rawdata["ChangeinOtherCurrentAssets"][26])."',";
        	$query .= "'".($rawdata["ChangeinOtherCurrentLiabilities"][23]+$rawdata["ChangeinOtherCurrentLiabilities"][24]+$rawdata["ChangeinOtherCurrentLiabilities"][25]+$rawdata["ChangeinOtherCurrentLiabilities"][26])."',";
        	$query .= "'".($rawdata["ChangeinOtherLiabilities"][23]+$rawdata["ChangeinOtherLiabilities"][24]+$rawdata["ChangeinOtherLiabilities"][25]+$rawdata["ChangeinOtherLiabilities"][26])."',";
        	$query .= "'".($rawdata["ChangeinPrepaidExpenses"][23]+$rawdata["ChangeinPrepaidExpenses"][24]+$rawdata["ChangeinPrepaidExpenses"][25]+$rawdata["ChangeinPrepaidExpenses"][26])."',";
        	$query .= "'".($rawdata["DividendsPaid"][23]+$rawdata["DividendsPaid"][24]+$rawdata["DividendsPaid"][25]+$rawdata["DividendsPaid"][26])."',";
        	$query .= "'".($rawdata["EffectofExchangeRateonCash"][23]+$rawdata["EffectofExchangeRateonCash"][24]+$rawdata["EffectofExchangeRateonCash"][25]+$rawdata["EffectofExchangeRateonCash"][26])."',";
        	$query .= "'".($rawdata["EmployeeCompensation"][23]+$rawdata["EmployeeCompensation"][24]+$rawdata["EmployeeCompensation"][25]+$rawdata["EmployeeCompensation"][26])."',";
        	$query .= "'".($rawdata["AcquisitionSaleofBusinessNet"][23]+$rawdata["AcquisitionSaleofBusinessNet"][24]+$rawdata["AcquisitionSaleofBusinessNet"][25]+$rawdata["AcquisitionSaleofBusinessNet"][26])."',";
        	$query .= "'".($rawdata["AdjustmentforEquityEarnings"][23]+$rawdata["AdjustmentforEquityEarnings"][24]+$rawdata["AdjustmentforEquityEarnings"][25]+$rawdata["AdjustmentforEquityEarnings"][26])."',";
        	$query .= "'".($rawdata["AdjustmentforMinorityInterest"][23]+$rawdata["AdjustmentforMinorityInterest"][24]+$rawdata["AdjustmentforMinorityInterest"][25]+$rawdata["AdjustmentforMinorityInterest"][26])."',";
        	$query .= "'".($rawdata["AdjustmentforSpecialCharges"][23]+$rawdata["AdjustmentforSpecialCharges"][24]+$rawdata["AdjustmentforSpecialCharges"][25]+$rawdata["AdjustmentforSpecialCharges"][26])."',";
        	$query .= "'".($rawdata["CapitalExpenditures"][23]+$rawdata["CapitalExpenditures"][24]+$rawdata["CapitalExpenditures"][25]+$rawdata["CapitalExpenditures"][26])."',";
        	$query .= "'".($rawdata["CashfromDiscontinuedOperations"][23]+$rawdata["CashfromDiscontinuedOperations"][24]+$rawdata["CashfromDiscontinuedOperations"][25]+$rawdata["CashfromDiscontinuedOperations"][26])."',";
        	$query .= "'".($rawdata["CashfromFinancingActivities"][23]+$rawdata["CashfromFinancingActivities"][24]+$rawdata["CashfromFinancingActivities"][25]+$rawdata["CashfromFinancingActivities"][26])."',";
        	$query .= "'".($rawdata["CashfromInvestingActivities"][23]+$rawdata["CashfromInvestingActivities"][24]+$rawdata["CashfromInvestingActivities"][25]+$rawdata["CashfromInvestingActivities"][26])."',";
        	$query .= "'".($rawdata["CashfromOperatingActivities"][23]+$rawdata["CashfromOperatingActivities"][24]+$rawdata["CashfromOperatingActivities"][25]+$rawdata["CashfromOperatingActivities"][26])."',";
        	$query .= "'".($rawdata["CFDepreciationAmortization"][23]+$rawdata["CFDepreciationAmortization"][24]+$rawdata["CFDepreciationAmortization"][25]+$rawdata["CFDepreciationAmortization"][26])."',";
        	$query .= "'".($rawdata["DeferredIncomeTaxes"][23]+$rawdata["DeferredIncomeTaxes"][24]+$rawdata["DeferredIncomeTaxes"][25]+$rawdata["DeferredIncomeTaxes"][26])."',";
        	$query .= "'".($rawdata["ChangeinAccountsPayableAccruedExpenses"][23]+$rawdata["ChangeinAccountsPayableAccruedExpenses"][24]+$rawdata["ChangeinAccountsPayableAccruedExpenses"][25]+$rawdata["ChangeinAccountsPayableAccruedExpenses"][26])."',";
        	$query .= "'".($rawdata["ChangeinAccountsReceivable"][23]+$rawdata["ChangeinAccountsReceivable"][24]+$rawdata["ChangeinAccountsReceivable"][25]+$rawdata["ChangeinAccountsReceivable"][26])."',";
        	$query .= "'".($rawdata["InvestmentChangesNet"][23]+$rawdata["InvestmentChangesNet"][24]+$rawdata["InvestmentChangesNet"][25]+$rawdata["InvestmentChangesNet"][26])."',";
        	$query .= "'".($rawdata["NetChangeinCash"][23]+$rawdata["NetChangeinCash"][24]+$rawdata["NetChangeinCash"][25]+$rawdata["NetChangeinCash"][26])."',";
        	$query .= "'".($rawdata["OtherAdjustments"][23]+$rawdata["OtherAdjustments"][24]+$rawdata["OtherAdjustments"][25]+$rawdata["OtherAdjustments"][26])."',";
        	$query .= "'".($rawdata["OtherAssetLiabilityChangesNet"][23]+$rawdata["OtherAssetLiabilityChangesNet"][24]+$rawdata["OtherAssetLiabilityChangesNet"][25]+$rawdata["OtherAssetLiabilityChangesNet"][26])."',";
        	$query .= "'".($rawdata["OtherFinancingActivitiesNet"][23]+$rawdata["OtherFinancingActivitiesNet"][24]+$rawdata["OtherFinancingActivitiesNet"][25]+$rawdata["OtherFinancingActivitiesNet"][26])."',";
        	$query .= "'".($rawdata["OtherInvestingActivities"][23]+$rawdata["OtherInvestingActivities"][24]+$rawdata["OtherInvestingActivities"][25]+$rawdata["OtherInvestingActivities"][26])."',";
        	$query .= "'".($rawdata["RealizedGainsLosses"][23]+$rawdata["RealizedGainsLosses"][24]+$rawdata["RealizedGainsLosses"][25]+$rawdata["RealizedGainsLosses"][26])."',";
        	$query .= "'".($rawdata["SaleofPropertyPlantEquipment"][23]+$rawdata["SaleofPropertyPlantEquipment"][24]+$rawdata["SaleofPropertyPlantEquipment"][25]+$rawdata["SaleofPropertyPlantEquipment"][26])."',";
        	$query .= "'".($rawdata["StockOptionTaxBenefits"][23]+$rawdata["StockOptionTaxBenefits"][24]+$rawdata["StockOptionTaxBenefits"][25]+$rawdata["StockOptionTaxBenefits"][26])."',";
        	$query .= "'".($rawdata["TotalAdjustments"][23]+$rawdata["TotalAdjustments"][24]+$rawdata["TotalAdjustments"][25]+$rawdata["TotalAdjustments"][26])."'";
        	$query .= ")";
	       	mysql_query($query) or die (mysql_error());
		
		$query = "INSERT INTO `pttm_cashflowconsolidated` (`ticker_id`, `ChangeinCurrentAssets`, `ChangeinCurrentLiabilities`, `ChangeinDebtNet`, `ChangeinDeferredRevenue`, `ChangeinEquityNet`, `ChangeinIncomeTaxesPayable`, `ChangeinInventories`, `ChangeinOperatingAssetsLiabilities`, `ChangeinOtherAssets`, `ChangeinOtherCurrentAssets`, `ChangeinOtherCurrentLiabilities`, `ChangeinOtherLiabilities`, `ChangeinPrepaidExpenses`, `DividendsPaid`, `EffectofExchangeRateonCash`, `EmployeeCompensation`, `AcquisitionSaleofBusinessNet`, `AdjustmentforEquityEarnings`, `AdjustmentforMinorityInterest`, `AdjustmentforSpecialCharges`, `CapitalExpenditures`, `CashfromDiscontinuedOperations`, `CashfromFinancingActivities`, `CashfromInvestingActivities`, `CashfromOperatingActivities`, `CFDepreciationAmortization`, `DeferredIncomeTaxes`, `ChangeinAccountsPayableAccruedExpenses`, `ChangeinAccountsReceivable`, `InvestmentChangesNet`, `NetChangeinCash`, `OtherAdjustments`, `OtherAssetLiabilityChangesNet`, `OtherFinancingActivitiesNet`, `OtherInvestingActivities`, `RealizedGainsLosses`, `SaleofPropertyPlantEquipment`, `StockOptionTaxBenefits`, `TotalAdjustments`) VALUES (";
	       	$query .= "'".$dates->ticker_id."',";
        	$query .= "'".($rawdata["ChangeinCurrentAssets"][19]+$rawdata["ChangeinCurrentAssets"][20]+$rawdata["ChangeinCurrentAssets"][21]+$rawdata["ChangeinCurrentAssets"][22])."',";
        	$query .= "'".($rawdata["ChangeinCurrentLiabilities"][19]+$rawdata["ChangeinCurrentLiabilities"][20]+$rawdata["ChangeinCurrentLiabilities"][21]+$rawdata["ChangeinCurrentLiabilities"][22])."',";
        	$query .= "'".($rawdata["ChangeinDebtNet"][19]+$rawdata["ChangeinDebtNet"][20]+$rawdata["ChangeinDebtNet"][21]+$rawdata["ChangeinDebtNet"][22])."',";
        	$query .= "'".($rawdata["ChangeinDeferredRevenue"][19]+$rawdata["ChangeinDeferredRevenue"][20]+$rawdata["ChangeinDeferredRevenue"][21]+$rawdata["ChangeinDeferredRevenue"][22])."',";
        	$query .= "'".($rawdata["ChangeinEquityNet"][19]+$rawdata["ChangeinEquityNet"][20]+$rawdata["ChangeinEquityNet"][21]+$rawdata["ChangeinEquityNet"][22])."',";
        	$query .= "'".($rawdata["ChangeinIncomeTaxesPayable"][19]+$rawdata["ChangeinIncomeTaxesPayable"][20]+$rawdata["ChangeinIncomeTaxesPayable"][21]+$rawdata["ChangeinIncomeTaxesPayable"][22])."',";
        	$query .= "'".($rawdata["ChangeinInventories"][19]+$rawdata["ChangeinInventories"][20]+$rawdata["ChangeinInventories"][21]+$rawdata["ChangeinInventories"][22])."',";
        	$query .= "'".($rawdata["ChangeinOperatingAssetsLiabilities"][19]+$rawdata["ChangeinOperatingAssetsLiabilities"][20]+$rawdata["ChangeinOperatingAssetsLiabilities"][21]+$rawdata["ChangeinOperatingAssetsLiabilities"][22])."',";
        	$query .= "'".($rawdata["ChangeinOtherAssets"][19]+$rawdata["ChangeinOtherAssets"][20]+$rawdata["ChangeinOtherAssets"][21]+$rawdata["ChangeinOtherAssets"][22])."',";
        	$query .= "'".($rawdata["ChangeinOtherCurrentAssets"][19]+$rawdata["ChangeinOtherCurrentAssets"][20]+$rawdata["ChangeinOtherCurrentAssets"][21]+$rawdata["ChangeinOtherCurrentAssets"][22])."',";
        	$query .= "'".($rawdata["ChangeinOtherCurrentLiabilities"][19]+$rawdata["ChangeinOtherCurrentLiabilities"][20]+$rawdata["ChangeinOtherCurrentLiabilities"][21]+$rawdata["ChangeinOtherCurrentLiabilities"][22])."',";
        	$query .= "'".($rawdata["ChangeinOtherLiabilities"][19]+$rawdata["ChangeinOtherLiabilities"][20]+$rawdata["ChangeinOtherLiabilities"][21]+$rawdata["ChangeinOtherLiabilities"][22])."',";
        	$query .= "'".($rawdata["ChangeinPrepaidExpenses"][19]+$rawdata["ChangeinPrepaidExpenses"][20]+$rawdata["ChangeinPrepaidExpenses"][21]+$rawdata["ChangeinPrepaidExpenses"][22])."',";
        	$query .= "'".($rawdata["DividendsPaid"][19]+$rawdata["DividendsPaid"][20]+$rawdata["DividendsPaid"][21]+$rawdata["DividendsPaid"][22])."',";
        	$query .= "'".($rawdata["EffectofExchangeRateonCash"][19]+$rawdata["EffectofExchangeRateonCash"][20]+$rawdata["EffectofExchangeRateonCash"][21]+$rawdata["EffectofExchangeRateonCash"][22])."',";
        	$query .= "'".($rawdata["EmployeeCompensation"][19]+$rawdata["EmployeeCompensation"][20]+$rawdata["EmployeeCompensation"][21]+$rawdata["EmployeeCompensation"][22])."',";
        	$query .= "'".($rawdata["AcquisitionSaleofBusinessNet"][19]+$rawdata["AcquisitionSaleofBusinessNet"][20]+$rawdata["AcquisitionSaleofBusinessNet"][21]+$rawdata["AcquisitionSaleofBusinessNet"][22])."',";
        	$query .= "'".($rawdata["AdjustmentforEquityEarnings"][19]+$rawdata["AdjustmentforEquityEarnings"][20]+$rawdata["AdjustmentforEquityEarnings"][21]+$rawdata["AdjustmentforEquityEarnings"][22])."',";
        	$query .= "'".($rawdata["AdjustmentforMinorityInterest"][19]+$rawdata["AdjustmentforMinorityInterest"][20]+$rawdata["AdjustmentforMinorityInterest"][21]+$rawdata["AdjustmentforMinorityInterest"][22])."',";
        	$query .= "'".($rawdata["AdjustmentforSpecialCharges"][19]+$rawdata["AdjustmentforSpecialCharges"][20]+$rawdata["AdjustmentforSpecialCharges"][21]+$rawdata["AdjustmentforSpecialCharges"][22])."',";
        	$query .= "'".($rawdata["CapitalExpenditures"][19]+$rawdata["CapitalExpenditures"][20]+$rawdata["CapitalExpenditures"][21]+$rawdata["CapitalExpenditures"][22])."',";
        	$query .= "'".($rawdata["CashfromDiscontinuedOperations"][19]+$rawdata["CashfromDiscontinuedOperations"][20]+$rawdata["CashfromDiscontinuedOperations"][21]+$rawdata["CashfromDiscontinuedOperations"][22])."',";
        	$query .= "'".($rawdata["CashfromFinancingActivities"][19]+$rawdata["CashfromFinancingActivities"][20]+$rawdata["CashfromFinancingActivities"][21]+$rawdata["CashfromFinancingActivities"][22])."',";
        	$query .= "'".($rawdata["CashfromInvestingActivities"][19]+$rawdata["CashfromInvestingActivities"][20]+$rawdata["CashfromInvestingActivities"][21]+$rawdata["CashfromInvestingActivities"][22])."',";
        	$query .= "'".($rawdata["CashfromOperatingActivities"][19]+$rawdata["CashfromOperatingActivities"][20]+$rawdata["CashfromOperatingActivities"][21]+$rawdata["CashfromOperatingActivities"][22])."',";
        	$query .= "'".($rawdata["CFDepreciationAmortization"][19]+$rawdata["CFDepreciationAmortization"][20]+$rawdata["CFDepreciationAmortization"][21]+$rawdata["CFDepreciationAmortization"][22])."',";
        	$query .= "'".($rawdata["DeferredIncomeTaxes"][19]+$rawdata["DeferredIncomeTaxes"][20]+$rawdata["DeferredIncomeTaxes"][21]+$rawdata["DeferredIncomeTaxes"][22])."',";
        	$query .= "'".($rawdata["ChangeinAccountsPayableAccruedExpenses"][19]+$rawdata["ChangeinAccountsPayableAccruedExpenses"][20]+$rawdata["ChangeinAccountsPayableAccruedExpenses"][21]+$rawdata["ChangeinAccountsPayableAccruedExpenses"][22])."',";
        	$query .= "'".($rawdata["ChangeinAccountsReceivable"][19]+$rawdata["ChangeinAccountsReceivable"][20]+$rawdata["ChangeinAccountsReceivable"][21]+$rawdata["ChangeinAccountsReceivable"][22])."',";
        	$query .= "'".($rawdata["InvestmentChangesNet"][19]+$rawdata["InvestmentChangesNet"][20]+$rawdata["InvestmentChangesNet"][21]+$rawdata["InvestmentChangesNet"][22])."',";
        	$query .= "'".($rawdata["NetChangeinCash"][19]+$rawdata["NetChangeinCash"][20]+$rawdata["NetChangeinCash"][21]+$rawdata["NetChangeinCash"][22])."',";
        	$query .= "'".($rawdata["OtherAdjustments"][19]+$rawdata["OtherAdjustments"][20]+$rawdata["OtherAdjustments"][21]+$rawdata["OtherAdjustments"][22])."',";
        	$query .= "'".($rawdata["OtherAssetLiabilityChangesNet"][19]+$rawdata["OtherAssetLiabilityChangesNet"][20]+$rawdata["OtherAssetLiabilityChangesNet"][21]+$rawdata["OtherAssetLiabilityChangesNet"][22])."',";
        	$query .= "'".($rawdata["OtherFinancingActivitiesNet"][19]+$rawdata["OtherFinancingActivitiesNet"][20]+$rawdata["OtherFinancingActivitiesNet"][21]+$rawdata["OtherFinancingActivitiesNet"][22])."',";
        	$query .= "'".($rawdata["OtherInvestingActivities"][19]+$rawdata["OtherInvestingActivities"][20]+$rawdata["OtherInvestingActivities"][21]+$rawdata["OtherInvestingActivities"][22])."',";
        	$query .= "'".($rawdata["RealizedGainsLosses"][19]+$rawdata["RealizedGainsLosses"][20]+$rawdata["RealizedGainsLosses"][21]+$rawdata["RealizedGainsLosses"][22])."',";
        	$query .= "'".($rawdata["SaleofPropertyPlantEquipment"][19]+$rawdata["SaleofPropertyPlantEquipment"][20]+$rawdata["SaleofPropertyPlantEquipment"][21]+$rawdata["SaleofPropertyPlantEquipment"][22])."',";
        	$query .= "'".($rawdata["StockOptionTaxBenefits"][19]+$rawdata["StockOptionTaxBenefits"][20]+$rawdata["StockOptionTaxBenefits"][21]+$rawdata["StockOptionTaxBenefits"][22])."',";
        	$query .= "'".($rawdata["TotalAdjustments"][19]+$rawdata["TotalAdjustments"][20]+$rawdata["TotalAdjustments"][21]+$rawdata["TotalAdjustments"][22])."'";
        	$query .= ")";
	       	mysql_query($query) or die (mysql_error());

		$query = "INSERT INTO `ttm_cashflowfull` (`ticker_id`, `ChangeinLongtermDebtNet`, `ChangeinShorttermBorrowingsNet`, `CashandCashEquivalentsBeginningofYear`, `CashandCashEquivalentsEndofYear`, `CashPaidforIncomeTaxes`, `CashPaidforInterestExpense`, `CFNetIncome`, `IssuanceofEquity`, `LongtermDebtPayments`, `LongtermDebtProceeds`, `OtherDebtNet`, `OtherEquityTransactionsNet`, `OtherInvestmentChangesNet`, `PurchaseofInvestments`, `RepurchaseofEquity`, `SaleofInvestments`, `ShorttermBorrowings`, `ShorttermInvestments`, `TotalNoncashAdjustments`) VALUES (";
        	$query .= "'".$dates->ticker_id."',";
       		$query .= "'".($rawdata["ChangeinLongtermDebtNet"][23]+$rawdata["ChangeinLongtermDebtNet"][24]+$rawdata["ChangeinLongtermDebtNet"][25]+$rawdata["ChangeinLongtermDebtNet"][26])."',";
       		$query .= "'".($rawdata["ChangeinShorttermBorrowingsNet"][23]+$rawdata["ChangeinShorttermBorrowingsNet"][24]+$rawdata["ChangeinShorttermBorrowingsNet"][25]+$rawdata["ChangeinShorttermBorrowingsNet"][26])."',";
       		$query .= "'".($rawdata["CashandCashEquivalentsBeginningofYear"][23]+$rawdata["CashandCashEquivalentsBeginningofYear"][24]+$rawdata["CashandCashEquivalentsBeginningofYear"][25]+$rawdata["CashandCashEquivalentsBeginningofYear"][26])."',";
       		$query .= "'".($rawdata["CashandCashEquivalentsEndofYear"][23]+$rawdata["CashandCashEquivalentsEndofYear"][24]+$rawdata["CashandCashEquivalentsEndofYear"][25]+$rawdata["CashandCashEquivalentsEndofYear"][26])."',";
       		$query .= "'".($rawdata["CashPaidforIncomeTaxes"][23]+$rawdata["CashPaidforIncomeTaxes"][24]+$rawdata["CashPaidforIncomeTaxes"][25]+$rawdata["CashPaidforIncomeTaxes"][26])."',";
      		$query .= "'".($rawdata["CashPaidforInterestExpense"][23]+$rawdata["CashPaidforInterestExpense"][24]+$rawdata["CashPaidforInterestExpense"][25]+$rawdata["CashPaidforInterestExpense"][26])."',";
       		$query .= "'".($rawdata["CFNetIncome"][23]+$rawdata["CFNetIncome"][24]+$rawdata["CFNetIncome"][25]+$rawdata["CFNetIncome"][26])."',";
       		$query .= "'".($rawdata["IssuanceofEquity"][23]+$rawdata["IssuanceofEquity"][24]+$rawdata["IssuanceofEquity"][25]+$rawdata["IssuanceofEquity"][26])."',";
       		$query .= "'".($rawdata["LongtermDebtPayments"][23]+$rawdata["LongtermDebtPayments"][24]+$rawdata["LongtermDebtPayments"][25]+$rawdata["LongtermDebtPayments"][26])."',";
       		$query .= "'".($rawdata["LongtermDebtProceeds"][23]+$rawdata["LongtermDebtProceeds"][24]+$rawdata["LongtermDebtProceeds"][25]+$rawdata["LongtermDebtProceeds"][26])."',";
      		$query .= "'".($rawdata["OtherDebtNet"][23]+$rawdata["OtherDebtNet"][24]+$rawdata["OtherDebtNet"][25]+$rawdata["OtherDebtNet"][26])."',";
       		$query .= "'".($rawdata["OtherEquityTransactionsNet"][23]+$rawdata["OtherEquityTransactionsNet"][24]+$rawdata["OtherEquityTransactionsNet"][25]+$rawdata["OtherEquityTransactionsNet"][26])."',";
       		$query .= "'".($rawdata["OtherInvestmentChangesNet"][23]+$rawdata["OtherInvestmentChangesNet"][24]+$rawdata["OtherInvestmentChangesNet"][25]+$rawdata["OtherInvestmentChangesNet"][26])."',";
       		$query .= "'".($rawdata["PurchaseofInvestments"][23]+$rawdata["PurchaseofInvestments"][24]+$rawdata["PurchaseofInvestments"][25]+$rawdata["PurchaseofInvestments"][26])."',";
       		$query .= "'".($rawdata["RepurchaseofEquity"][23]+$rawdata["RepurchaseofEquity"][24]+$rawdata["RepurchaseofEquity"][25]+$rawdata["RepurchaseofEquity"][26])."',";
       		$query .= "'".($rawdata["SaleofInvestments"][23]+$rawdata["SaleofInvestments"][24]+$rawdata["SaleofInvestments"][25]+$rawdata["SaleofInvestments"][26])."',";
       		$query .= "'".($rawdata["ShorttermBorrowings"][23]+$rawdata["ShorttermBorrowings"][24]+$rawdata["ShorttermBorrowings"][25]+$rawdata["ShorttermBorrowings"][26])."',";
       		$query .= "'".($rawdata["ShorttermInvestments"][23]+$rawdata["ShorttermInvestments"][24]+$rawdata["ShorttermInvestments"][25]+$rawdata["ShorttermInvestments"][26])."',";
       		$query .= "'".($rawdata["TotalNoncashAdjustments"][23]+$rawdata["TotalNoncashAdjustments"][24]+$rawdata["TotalNoncashAdjustments"][25]+$rawdata["TotalNoncashAdjustments"][26])."'";
       		$query .= ")";
        	mysql_query($query) or die (mysql_error());

		$query = "INSERT INTO `pttm_cashflowfull` (`ticker_id`, `ChangeinLongtermDebtNet`, `ChangeinShorttermBorrowingsNet`, `CashandCashEquivalentsBeginningofYear`, `CashandCashEquivalentsEndofYear`, `CashPaidforIncomeTaxes`, `CashPaidforInterestExpense`, `CFNetIncome`, `IssuanceofEquity`, `LongtermDebtPayments`, `LongtermDebtProceeds`, `OtherDebtNet`, `OtherEquityTransactionsNet`, `OtherInvestmentChangesNet`, `PurchaseofInvestments`, `RepurchaseofEquity`, `SaleofInvestments`, `ShorttermBorrowings`, `ShorttermInvestments`, `TotalNoncashAdjustments`) VALUES (";
        	$query .= "'".$dates->ticker_id."',";
       		$query .= "'".($rawdata["ChangeinLongtermDebtNet"][19]+$rawdata["ChangeinLongtermDebtNet"][20]+$rawdata["ChangeinLongtermDebtNet"][21]+$rawdata["ChangeinLongtermDebtNet"][22])."',";
       		$query .= "'".($rawdata["ChangeinShorttermBorrowingsNet"][19]+$rawdata["ChangeinShorttermBorrowingsNet"][20]+$rawdata["ChangeinShorttermBorrowingsNet"][21]+$rawdata["ChangeinShorttermBorrowingsNet"][22])."',";
       		$query .= "'".($rawdata["CashandCashEquivalentsBeginningofYear"][19]+$rawdata["CashandCashEquivalentsBeginningofYear"][20]+$rawdata["CashandCashEquivalentsBeginningofYear"][21]+$rawdata["CashandCashEquivalentsBeginningofYear"][22])."',";
       		$query .= "'".($rawdata["CashandCashEquivalentsEndofYear"][19]+$rawdata["CashandCashEquivalentsEndofYear"][20]+$rawdata["CashandCashEquivalentsEndofYear"][21]+$rawdata["CashandCashEquivalentsEndofYear"][22])."',";
       		$query .= "'".($rawdata["CashPaidforIncomeTaxes"][19]+$rawdata["CashPaidforIncomeTaxes"][20]+$rawdata["CashPaidforIncomeTaxes"][21]+$rawdata["CashPaidforIncomeTaxes"][22])."',";
      		$query .= "'".($rawdata["CashPaidforInterestExpense"][19]+$rawdata["CashPaidforInterestExpense"][20]+$rawdata["CashPaidforInterestExpense"][21]+$rawdata["CashPaidforInterestExpense"][22])."',";
       		$query .= "'".($rawdata["CFNetIncome"][19]+$rawdata["CFNetIncome"][20]+$rawdata["CFNetIncome"][21]+$rawdata["CFNetIncome"][22])."',";
       		$query .= "'".($rawdata["IssuanceofEquity"][19]+$rawdata["IssuanceofEquity"][20]+$rawdata["IssuanceofEquity"][21]+$rawdata["IssuanceofEquity"][22])."',";
       		$query .= "'".($rawdata["LongtermDebtPayments"][19]+$rawdata["LongtermDebtPayments"][20]+$rawdata["LongtermDebtPayments"][21]+$rawdata["LongtermDebtPayments"][22])."',";
       		$query .= "'".($rawdata["LongtermDebtProceeds"][19]+$rawdata["LongtermDebtProceeds"][20]+$rawdata["LongtermDebtProceeds"][21]+$rawdata["LongtermDebtProceeds"][22])."',";
      		$query .= "'".($rawdata["OtherDebtNet"][19]+$rawdata["OtherDebtNet"][20]+$rawdata["OtherDebtNet"][21]+$rawdata["OtherDebtNet"][22])."',";
       		$query .= "'".($rawdata["OtherEquityTransactionsNet"][19]+$rawdata["OtherEquityTransactionsNet"][20]+$rawdata["OtherEquityTransactionsNet"][21]+$rawdata["OtherEquityTransactionsNet"][22])."',";
       		$query .= "'".($rawdata["OtherInvestmentChangesNet"][19]+$rawdata["OtherInvestmentChangesNet"][20]+$rawdata["OtherInvestmentChangesNet"][21]+$rawdata["OtherInvestmentChangesNet"][22])."',";
       		$query .= "'".($rawdata["PurchaseofInvestments"][19]+$rawdata["PurchaseofInvestments"][20]+$rawdata["PurchaseofInvestments"][21]+$rawdata["PurchaseofInvestments"][22])."',";
       		$query .= "'".($rawdata["RepurchaseofEquity"][19]+$rawdata["RepurchaseofEquity"][20]+$rawdata["RepurchaseofEquity"][21]+$rawdata["RepurchaseofEquity"][22])."',";
       		$query .= "'".($rawdata["SaleofInvestments"][19]+$rawdata["SaleofInvestments"][20]+$rawdata["SaleofInvestments"][21]+$rawdata["SaleofInvestments"][22])."',";
       		$query .= "'".($rawdata["ShorttermBorrowings"][19]+$rawdata["ShorttermBorrowings"][20]+$rawdata["ShorttermBorrowings"][21]+$rawdata["ShorttermBorrowings"][22])."',";
       		$query .= "'".($rawdata["ShorttermInvestments"][19]+$rawdata["ShorttermInvestments"][20]+$rawdata["ShorttermInvestments"][21]+$rawdata["ShorttermInvestments"][22])."',";
       		$query .= "'".($rawdata["TotalNoncashAdjustments"][19]+$rawdata["TotalNoncashAdjustments"][20]+$rawdata["TotalNoncashAdjustments"][21]+$rawdata["TotalNoncashAdjustments"][22])."'";
       		$query .= ")";
        	mysql_query($query) or die (mysql_error());

		$query = "INSERT INTO `ttm_incomeconsolidated` (`ticker_id`, `EBIT`, `CostofRevenue`, `DepreciationAmortizationExpense`, `DilutedEPSNetIncome`, `DiscontinuedOperations`, `EquityEarnings`, `AccountingChange`, `BasicEPSNetIncome`, `ExtraordinaryItems`, `GrossProfit`, `IncomebeforeExtraordinaryItems`, `IncomeBeforeTaxes`, `IncomeTaxes`, `InterestExpense`, `InterestIncome`, `MinorityInterestEquityEarnings`, `NetIncome`, `NetIncomeApplicabletoCommon`, `OperatingProfit`, `OtherNonoperatingIncomeExpense`, `OtherOperatingExpenses`, `ResearchDevelopmentExpense`, `RestructuringRemediationImpairmentProvisions`, `TotalRevenue`, `SellingGeneralAdministrativeExpenses`) VALUES (";
        	$query .= "'".$dates->ticker_id."',";
       		$query .= "'".($rawdata["EBIT"][23]+$rawdata["EBIT"][24]+$rawdata["EBIT"][25]+$rawdata["EBIT"][26])."',";
       		$query .= "'".($rawdata["CostofRevenue"][23]+$rawdata["CostofRevenue"][24]+$rawdata["CostofRevenue"][25]+$rawdata["CostofRevenue"][26])."',";
       		$query .= "'".($rawdata["DepreciationAmortizationExpense"][23]+$rawdata["DepreciationAmortizationExpense"][24]+$rawdata["DepreciationAmortizationExpense"][25]+$rawdata["DepreciationAmortizationExpense"][26])."',";
      		$query .= "'".($rawdata["DilutedEPSNetIncome"][23]+$rawdata["DilutedEPSNetIncome"][24]+$rawdata["DilutedEPSNetIncome"][25]+$rawdata["DilutedEPSNetIncome"][26])."',";
       		$query .= "'".($rawdata["DiscontinuedOperations"][23]+$rawdata["DiscontinuedOperations"][24]+$rawdata["DiscontinuedOperations"][25]+$rawdata["DiscontinuedOperations"][23])."',";
       		$query .= "'".($rawdata["EquityEarnings"][23]+$rawdata["EquityEarnings"][24]+$rawdata["EquityEarnings"][25]+$rawdata["EquityEarnings"][26])."',";
      		$query .= "'".($rawdata["AccountingChange"][23]+$rawdata["AccountingChange"][24]+$rawdata["AccountingChange"][25]+$rawdata["AccountingChange"][26])."',";
       		$query .= "'".($rawdata["BasicEPSNetIncome"][23]+$rawdata["BasicEPSNetIncome"][24]+$rawdata["BasicEPSNetIncome"][25]+$rawdata["BasicEPSNetIncome"][26])."',";
       		$query .= "'".($rawdata["ExtraordinaryItems"][23]+$rawdata["ExtraordinaryItems"][24]+$rawdata["ExtraordinaryItems"][25]+$rawdata["ExtraordinaryItems"][26])."',";
       		$query .= "'".($rawdata["GrossProfit"][23]+$rawdata["GrossProfit"][24]+$rawdata["GrossProfit"][25]+$rawdata["GrossProfit"][26])."',";
       		$query .= "'".($rawdata["IncomebeforeExtraordinaryItems"][23]+$rawdata["IncomebeforeExtraordinaryItems"][24]+$rawdata["IncomebeforeExtraordinaryItems"][25]+$rawdata["IncomebeforeExtraordinaryItems"][26])."',";
       		$query .= "'".($rawdata["IncomeBeforeTaxes"][23]+$rawdata["IncomeBeforeTaxes"][24]+$rawdata["IncomeBeforeTaxes"][25]+$rawdata["IncomeBeforeTaxes"][26])."',";
       		$query .= "'".($rawdata["IncomeTaxes"][23]+$rawdata["IncomeTaxes"][24]+$rawdata["IncomeTaxes"][25]+$rawdata["IncomeTaxes"][26])."',";
       		$query .= "'".($rawdata["InterestExpense"][23]+$rawdata["InterestExpense"][24]+$rawdata["InterestExpense"][25]+$rawdata["InterestExpense"][26])."',";
       		$query .= "'".($rawdata["InterestIncome"][23]+$rawdata["InterestIncome"][24]+$rawdata["InterestIncome"][25]+$rawdata["InterestIncome"][26])."',";
       		$query .= "'".($rawdata["MinorityInterestEquityEarnings"][23]+$rawdata["MinorityInterestEquityEarnings"][24]+$rawdata["MinorityInterestEquityEarnings"][25]+$rawdata["MinorityInterestEquityEarnings"][26])."',";
       		$query .= "'".($rawdata["NetIncome"][23]+$rawdata["NetIncome"][24]+$rawdata["NetIncome"][25]+$rawdata["NetIncome"][26])."',";
       		$query .= "'".($rawdata["NetIncomeApplicabletoCommon"][23]+$rawdata["NetIncomeApplicabletoCommon"][24]+$rawdata["NetIncomeApplicabletoCommon"][25]+$rawdata["NetIncomeApplicabletoCommon"][26])."',";
       		$query .= "'".($rawdata["OperatingProfit"][23]+$rawdata["OperatingProfit"][24]+$rawdata["OperatingProfit"][25]+$rawdata["OperatingProfit"][26])."',";
       		$query .= "'".($rawdata["OtherNonoperatingIncomeExpense"][23]+$rawdata["OtherNonoperatingIncomeExpense"][24]+$rawdata["OtherNonoperatingIncomeExpense"][25]+$rawdata["OtherNonoperatingIncomeExpense"][26])."',";
      		$query .= "'".($rawdata["OtherOperatingExpenses"][23]+$rawdata["OtherOperatingExpenses"][24]+$rawdata["OtherOperatingExpenses"][25]+$rawdata["OtherOperatingExpenses"][26])."',";
       		$query .= "'".($rawdata["ResearchDevelopmentExpense"][23]+$rawdata["ResearchDevelopmentExpense"][24]+$rawdata["ResearchDevelopmentExpense"][25]+$rawdata["ResearchDevelopmentExpense"][26])."',";
       		$query .= "'".($rawdata["RestructuringRemediationImpairmentProvisions"][23]+$rawdata["RestructuringRemediationImpairmentProvisions"][24]+$rawdata["RestructuringRemediationImpairmentProvisions"][25]+$rawdata["RestructuringRemediationImpairmentProvisions"][26])."',";
       		$query .= "'".($rawdata["TotalRevenue"][23]+$rawdata["TotalRevenue"][24]+$rawdata["TotalRevenue"][25]+$rawdata["TotalRevenue"][26])."',";
       		$query .= "'".($rawdata["SellingGeneralAdministrativeExpenses"][23]+$rawdata["SellingGeneralAdministrativeExpenses"][24]+$rawdata["SellingGeneralAdministrativeExpenses"][25]+$rawdata["SellingGeneralAdministrativeExpenses"][26])."'";
       		$query .= ")";
        	mysql_query($query) or die (mysql_error());

		$query = "INSERT INTO `pttm_incomeconsolidated` (`ticker_id`, `EBIT`, `CostofRevenue`, `DepreciationAmortizationExpense`, `DilutedEPSNetIncome`, `DiscontinuedOperations`, `EquityEarnings`, `AccountingChange`, `BasicEPSNetIncome`, `ExtraordinaryItems`, `GrossProfit`, `IncomebeforeExtraordinaryItems`, `IncomeBeforeTaxes`, `IncomeTaxes`, `InterestExpense`, `InterestIncome`, `MinorityInterestEquityEarnings`, `NetIncome`, `NetIncomeApplicabletoCommon`, `OperatingProfit`, `OtherNonoperatingIncomeExpense`, `OtherOperatingExpenses`, `ResearchDevelopmentExpense`, `RestructuringRemediationImpairmentProvisions`, `TotalRevenue`, `SellingGeneralAdministrativeExpenses`) VALUES (";
        	$query .= "'".$dates->ticker_id."',";
       		$query .= "'".($rawdata["EBIT"][19]+$rawdata["EBIT"][20]+$rawdata["EBIT"][21]+$rawdata["EBIT"][22])."',";
       		$query .= "'".($rawdata["CostofRevenue"][19]+$rawdata["CostofRevenue"][20]+$rawdata["CostofRevenue"][21]+$rawdata["CostofRevenue"][22])."',";
       		$query .= "'".($rawdata["DepreciationAmortizationExpense"][19]+$rawdata["DepreciationAmortizationExpense"][20]+$rawdata["DepreciationAmortizationExpense"][21]+$rawdata["DepreciationAmortizationExpense"][22])."',";
      		$query .= "'".($rawdata["DilutedEPSNetIncome"][19]+$rawdata["DilutedEPSNetIncome"][20]+$rawdata["DilutedEPSNetIncome"][21]+$rawdata["DilutedEPSNetIncome"][22])."',";
       		$query .= "'".($rawdata["DiscontinuedOperations"][19]+$rawdata["DiscontinuedOperations"][20]+$rawdata["DiscontinuedOperations"][21]+$rawdata["DiscontinuedOperations"][19])."',";
       		$query .= "'".($rawdata["EquityEarnings"][19]+$rawdata["EquityEarnings"][20]+$rawdata["EquityEarnings"][21]+$rawdata["EquityEarnings"][22])."',";
      		$query .= "'".($rawdata["AccountingChange"][19]+$rawdata["AccountingChange"][20]+$rawdata["AccountingChange"][21]+$rawdata["AccountingChange"][22])."',";
       		$query .= "'".($rawdata["BasicEPSNetIncome"][19]+$rawdata["BasicEPSNetIncome"][20]+$rawdata["BasicEPSNetIncome"][21]+$rawdata["BasicEPSNetIncome"][22])."',";
       		$query .= "'".($rawdata["ExtraordinaryItems"][19]+$rawdata["ExtraordinaryItems"][20]+$rawdata["ExtraordinaryItems"][21]+$rawdata["ExtraordinaryItems"][22])."',";
       		$query .= "'".($rawdata["GrossProfit"][19]+$rawdata["GrossProfit"][20]+$rawdata["GrossProfit"][21]+$rawdata["GrossProfit"][22])."',";
       		$query .= "'".($rawdata["IncomebeforeExtraordinaryItems"][19]+$rawdata["IncomebeforeExtraordinaryItems"][20]+$rawdata["IncomebeforeExtraordinaryItems"][21]+$rawdata["IncomebeforeExtraordinaryItems"][22])."',";
       		$query .= "'".($rawdata["IncomeBeforeTaxes"][19]+$rawdata["IncomeBeforeTaxes"][20]+$rawdata["IncomeBeforeTaxes"][21]+$rawdata["IncomeBeforeTaxes"][22])."',";
       		$query .= "'".($rawdata["IncomeTaxes"][19]+$rawdata["IncomeTaxes"][20]+$rawdata["IncomeTaxes"][21]+$rawdata["IncomeTaxes"][22])."',";
       		$query .= "'".($rawdata["InterestExpense"][19]+$rawdata["InterestExpense"][20]+$rawdata["InterestExpense"][21]+$rawdata["InterestExpense"][22])."',";
       		$query .= "'".($rawdata["InterestIncome"][19]+$rawdata["InterestIncome"][20]+$rawdata["InterestIncome"][21]+$rawdata["InterestIncome"][22])."',";
       		$query .= "'".($rawdata["MinorityInterestEquityEarnings"][19]+$rawdata["MinorityInterestEquityEarnings"][20]+$rawdata["MinorityInterestEquityEarnings"][21]+$rawdata["MinorityInterestEquityEarnings"][22])."',";
       		$query .= "'".($rawdata["NetIncome"][19]+$rawdata["NetIncome"][20]+$rawdata["NetIncome"][21]+$rawdata["NetIncome"][22])."',";
       		$query .= "'".($rawdata["NetIncomeApplicabletoCommon"][19]+$rawdata["NetIncomeApplicabletoCommon"][20]+$rawdata["NetIncomeApplicabletoCommon"][21]+$rawdata["NetIncomeApplicabletoCommon"][22])."',";
       		$query .= "'".($rawdata["OperatingProfit"][19]+$rawdata["OperatingProfit"][20]+$rawdata["OperatingProfit"][21]+$rawdata["OperatingProfit"][22])."',";
       		$query .= "'".($rawdata["OtherNonoperatingIncomeExpense"][19]+$rawdata["OtherNonoperatingIncomeExpense"][20]+$rawdata["OtherNonoperatingIncomeExpense"][21]+$rawdata["OtherNonoperatingIncomeExpense"][22])."',";
      		$query .= "'".($rawdata["OtherOperatingExpenses"][19]+$rawdata["OtherOperatingExpenses"][20]+$rawdata["OtherOperatingExpenses"][21]+$rawdata["OtherOperatingExpenses"][22])."',";
       		$query .= "'".($rawdata["ResearchDevelopmentExpense"][19]+$rawdata["ResearchDevelopmentExpense"][20]+$rawdata["ResearchDevelopmentExpense"][21]+$rawdata["ResearchDevelopmentExpense"][22])."',";
       		$query .= "'".($rawdata["RestructuringRemediationImpairmentProvisions"][19]+$rawdata["RestructuringRemediationImpairmentProvisions"][20]+$rawdata["RestructuringRemediationImpairmentProvisions"][21]+$rawdata["RestructuringRemediationImpairmentProvisions"][22])."',";
       		$query .= "'".($rawdata["TotalRevenue"][19]+$rawdata["TotalRevenue"][20]+$rawdata["TotalRevenue"][21]+$rawdata["TotalRevenue"][22])."',";
       		$query .= "'".($rawdata["SellingGeneralAdministrativeExpenses"][19]+$rawdata["SellingGeneralAdministrativeExpenses"][20]+$rawdata["SellingGeneralAdministrativeExpenses"][21]+$rawdata["SellingGeneralAdministrativeExpenses"][22])."'";
       		$query .= ")";
        	mysql_query($query) or die (mysql_error());

		$query = "INSERT INTO `ttm_incomefull` (`ticker_id`, `AdjustedEBIT`, `AdjustedEBITDA`, `AdjustedNetIncome`, `AftertaxMargin`, `EBITDA`, `GrossMargin`, `NetOperatingProfitafterTax`, `OperatingMargin`, `RevenueFQ`, `RevenueFY`, `RevenueTTM`, `CostOperatingExpenses`, `DepreciationExpense`, `DilutedEPSNetIncomefromContinuingOperations`, `DilutedWeightedAverageShares`, `AmortizationExpense`, `BasicEPSNetIncomefromContinuingOperations`, `BasicWeightedAverageShares`, `GeneralAdministrativeExpense`, `IncomeAfterTaxes`, `LaborExpense`, `NetIncomefromContinuingOperationsApplicabletoCommon`, `InterestIncomeExpenseNet`, `NoncontrollingInterest`, `NonoperatingGainsLosses`, `OperatingExpenses`, `OtherGeneralAdministrativeExpense`, `OtherInterestIncomeExpenseNet`, `OtherRevenue`, `OtherSellingGeneralAdministrativeExpenses`, `PreferredDividends`, `SalesMarketingExpense`, `TotalNonoperatingIncomeExpense`, `TotalOperatingExpenses`, `OperatingRevenue`) VALUES (";
        	$query .= "'".$dates->ticker_id."',";
       		$query .= "'".($rawdata["AdjustedEBIT"][23]+$rawdata["AdjustedEBIT"][24]+$rawdata["AdjustedEBIT"][25]+$rawdata["AdjustedEBIT"][26])."',";
       		$query .= "'".($rawdata["AdjustedEBITDA"][23]+$rawdata["AdjustedEBITDA"][24]+$rawdata["AdjustedEBITDA"][25]+$rawdata["AdjustedEBITDA"][26])."',";
      		$query .= "'".($rawdata["AdjustedNetIncome"][23]+$rawdata["AdjustedNetIncome"][24]+$rawdata["AdjustedNetIncome"][25]+$rawdata["AdjustedNetIncome"][26])."',";
       		$query .= "'".($rawdata["AftertaxMargin"][23]+$rawdata["AftertaxMargin"][24]+$rawdata["AftertaxMargin"][25]+$rawdata["AftertaxMargin"][26])."',";
       		$query .= "'".($rawdata["EBITDA"][23]+$rawdata["EBITDA"][24]+$rawdata["EBITDA"][25]+$rawdata["EBITDA"][26])."',";
      		$query .= "'".($rawdata["GrossMargin"][23]+$rawdata["GrossMargin"][24]+$rawdata["GrossMargin"][25]+$rawdata["GrossMargin"][26])."',";
       		$query .= "'".($rawdata["NetOperatingProfitafterTax"][23]+$rawdata["NetOperatingProfitafterTax"][24]+$rawdata["NetOperatingProfitafterTax"][25]+$rawdata["NetOperatingProfitafterTax"][26])."',";
       		$query .= "'".($rawdata["OperatingMargin"][23]+$rawdata["OperatingMargin"][24]+$rawdata["OperatingMargin"][25]+$rawdata["OperatingMargin"][26])."',";
       		$query .= "'".($rawdata["RevenueFQ"][23]+$rawdata["RevenueFQ"][24]+$rawdata["RevenueFQ"][25]+$rawdata["RevenueFQ"][26])."',";
      		$query .= "'".($rawdata["RevenueFY"][23]+$rawdata["RevenueFY"][24]+$rawdata["RevenueFY"][25]+$rawdata["RevenueFY"][26])."',";
       		$query .= "'".($rawdata["RevenueTTM"][23]+$rawdata["RevenueTTM"][24]+$rawdata["RevenueTTM"][25]+$rawdata["RevenueTTM"][26])."',";
       		$query .= "'".($rawdata["CostOperatingExpenses"][23]+$rawdata["CostOperatingExpenses"][24]+$rawdata["CostOperatingExpenses"][25]+$rawdata["CostOperatingExpenses"][26])."',";
       		$query .= "'".($rawdata["DepreciationExpense"][23]+$rawdata["DepreciationExpense"][24]+$rawdata["DepreciationExpense"][25]+$rawdata["DepreciationExpense"][26])."',";
      		$query .= "'".($rawdata["DilutedEPSNetIncomefromContinuingOperations"][23]+$rawdata["DilutedEPSNetIncomefromContinuingOperations"][24]+$rawdata["DilutedEPSNetIncomefromContinuingOperations"][25]+$rawdata["DilutedEPSNetIncomefromContinuingOperations"][26])."',";
                $query .= "'".$rawdata["DilutedWeightedAverageShares"][$MRQRow]."',";
       		$query .= "'".($rawdata["AmortizationExpense"][23]+$rawdata["AmortizationExpense"][24]+$rawdata["AmortizationExpense"][25]+$rawdata["AmortizationExpense"][26])."',";
       		$query .= "'".($rawdata["BasicEPSNetIncomefromContinuingOperations"][23]+$rawdata["BasicEPSNetIncomefromContinuingOperations"][24]+$rawdata["BasicEPSNetIncomefromContinuingOperations"][25]+$rawdata["BasicEPSNetIncomefromContinuingOperations"][26])."',";
                $query .= "'".$rawdata["BasicWeightedAverageShares"][$MRQRow]."',";
      		$query .= "'".($rawdata["GeneralAdministrativeExpense"][23]+$rawdata["GeneralAdministrativeExpense"][24]+$rawdata["GeneralAdministrativeExpense"][25]+$rawdata["GeneralAdministrativeExpense"][26])."',";
       		$query .= "'".($rawdata["IncomeAfterTaxes"][23]+$rawdata["IncomeAfterTaxes"][24]+$rawdata["IncomeAfterTaxes"][25]+$rawdata["IncomeAfterTaxes"][26])."',";
       		$query .= "'".($rawdata["LaborExpense"][23]+$rawdata["LaborExpense"][24]+$rawdata["LaborExpense"][25]+$rawdata["LaborExpense"][26])."',";
       		$query .= "'".($rawdata["NetIncomefromContinuingOperationsApplicabletoCommon"][23]+$rawdata["NetIncomefromContinuingOperationsApplicabletoCommon"][24]+$rawdata["NetIncomefromContinuingOperationsApplicabletoCommon"][25]+$rawdata["NetIncomefromContinuingOperationsApplicabletoCommon"][26])."',";
       		$query .= "'".($rawdata["InterestIncomeExpenseNet"][23]+$rawdata["InterestIncomeExpenseNet"][24]+$rawdata["InterestIncomeExpenseNet"][25]+$rawdata["InterestIncomeExpenseNet"][26])."',";
       		$query .= "'".($rawdata["NoncontrollingInterest"][23]+$rawdata["NoncontrollingInterest"][24]+$rawdata["NoncontrollingInterest"][25]+$rawdata["NoncontrollingInterest"][26])."',";
       		$query .= "'".($rawdata["NonoperatingGainsLosses"][23]+$rawdata["NonoperatingGainsLosses"][24]+$rawdata["NonoperatingGainsLosses"][25]+$rawdata["NonoperatingGainsLosses"][26])."',";
       		$query .= "'".($rawdata["OperatingExpenses"][23]+$rawdata["OperatingExpenses"][24]+$rawdata["OperatingExpenses"][25]+$rawdata["OperatingExpenses"][26])."',";
       		$query .= "'".($rawdata["OtherGeneralAdministrativeExpense"][23]+$rawdata["OtherGeneralAdministrativeExpense"][24]+$rawdata["OtherGeneralAdministrativeExpense"][25]+$rawdata["OtherGeneralAdministrativeExpense"][26])."',";
       		$query .= "'".($rawdata["OtherInterestIncomeExpenseNet"][23]+$rawdata["OtherInterestIncomeExpenseNet"][24]+$rawdata["OtherInterestIncomeExpenseNet"][25]+$rawdata["OtherInterestIncomeExpenseNet"][26])."',";
       		$query .= "'".($rawdata["OtherRevenue"][23]+$rawdata["OtherRevenue"][24]+$rawdata["OtherRevenue"][25]+$rawdata["OtherRevenue"][26])."',";
       		$query .= "'".($rawdata["OtherSellingGeneralAdministrativeExpenses"][23]+$rawdata["OtherSellingGeneralAdministrativeExpenses"][24]+$rawdata["OtherSellingGeneralAdministrativeExpenses"][25]+$rawdata["OtherSellingGeneralAdministrativeExpenses"][26])."',";
      		$query .= "'".($rawdata["PreferredDividends"][23]+$rawdata["PreferredDividends"][24]+$rawdata["PreferredDividends"][25]+$rawdata["PreferredDividends"][26])."',";
       		$query .= "'".($rawdata["SalesMarketingExpense"][23]+$rawdata["SalesMarketingExpense"][24]+$rawdata["SalesMarketingExpense"][25]+$rawdata["SalesMarketingExpense"][26])."',";
       		$query .= "'".($rawdata["TotalNonoperatingIncomeExpense"][23]+$rawdata["TotalNonoperatingIncomeExpense"][24]+$rawdata["TotalNonoperatingIncomeExpense"][25]+$rawdata["TotalNonoperatingIncomeExpense"][26])."',";
       		$query .= "'".($rawdata["TotalOperatingExpenses"][23]+$rawdata["TotalOperatingExpenses"][24]+$rawdata["TotalOperatingExpenses"][25]+$rawdata["TotalOperatingExpenses"][26])."',";
       		$query .= "'".($rawdata["OperatingRevenue"][23]+$rawdata["OperatingRevenue"][24]+$rawdata["OperatingRevenue"][25]+$rawdata["OperatingRevenue"][26])."'";
       		$query .= ")";
        	mysql_query($query) or die (mysql_error());

		$query = "INSERT INTO `pttm_incomefull` (`ticker_id`, `AdjustedEBIT`, `AdjustedEBITDA`, `AdjustedNetIncome`, `AftertaxMargin`, `EBITDA`, `GrossMargin`, `NetOperatingProfitafterTax`, `OperatingMargin`, `RevenueFQ`, `RevenueFY`, `RevenueTTM`, `CostOperatingExpenses`, `DepreciationExpense`, `DilutedEPSNetIncomefromContinuingOperations`, `DilutedWeightedAverageShares`, `AmortizationExpense`, `BasicEPSNetIncomefromContinuingOperations`, `BasicWeightedAverageShares`, `GeneralAdministrativeExpense`, `IncomeAfterTaxes`, `LaborExpense`, `NetIncomefromContinuingOperationsApplicabletoCommon`, `InterestIncomeExpenseNet`, `NoncontrollingInterest`, `NonoperatingGainsLosses`, `OperatingExpenses`, `OtherGeneralAdministrativeExpense`, `OtherInterestIncomeExpenseNet`, `OtherRevenue`, `OtherSellingGeneralAdministrativeExpenses`, `PreferredDividends`, `SalesMarketingExpense`, `TotalNonoperatingIncomeExpense`, `TotalOperatingExpenses`, `OperatingRevenue`) VALUES (";
        	$query .= "'".$dates->ticker_id."',";
       		$query .= "'".($rawdata["AdjustedEBIT"][19]+$rawdata["AdjustedEBIT"][20]+$rawdata["AdjustedEBIT"][21]+$rawdata["AdjustedEBIT"][22])."',";
       		$query .= "'".($rawdata["AdjustedEBITDA"][19]+$rawdata["AdjustedEBITDA"][20]+$rawdata["AdjustedEBITDA"][21]+$rawdata["AdjustedEBITDA"][22])."',";
      		$query .= "'".($rawdata["AdjustedNetIncome"][19]+$rawdata["AdjustedNetIncome"][20]+$rawdata["AdjustedNetIncome"][21]+$rawdata["AdjustedNetIncome"][22])."',";
       		$query .= "'".($rawdata["AftertaxMargin"][19]+$rawdata["AftertaxMargin"][20]+$rawdata["AftertaxMargin"][21]+$rawdata["AftertaxMargin"][22])."',";
       		$query .= "'".($rawdata["EBITDA"][19]+$rawdata["EBITDA"][20]+$rawdata["EBITDA"][21]+$rawdata["EBITDA"][22])."',";
      		$query .= "'".($rawdata["GrossMargin"][19]+$rawdata["GrossMargin"][20]+$rawdata["GrossMargin"][21]+$rawdata["GrossMargin"][22])."',";
       		$query .= "'".($rawdata["NetOperatingProfitafterTax"][19]+$rawdata["NetOperatingProfitafterTax"][20]+$rawdata["NetOperatingProfitafterTax"][21]+$rawdata["NetOperatingProfitafterTax"][22])."',";
       		$query .= "'".($rawdata["OperatingMargin"][19]+$rawdata["OperatingMargin"][20]+$rawdata["OperatingMargin"][21]+$rawdata["OperatingMargin"][22])."',";
       		$query .= "'".($rawdata["RevenueFQ"][19]+$rawdata["RevenueFQ"][20]+$rawdata["RevenueFQ"][21]+$rawdata["RevenueFQ"][22])."',";
      		$query .= "'".($rawdata["RevenueFY"][19]+$rawdata["RevenueFY"][20]+$rawdata["RevenueFY"][21]+$rawdata["RevenueFY"][22])."',";
       		$query .= "'".($rawdata["RevenueTTM"][19]+$rawdata["RevenueTTM"][20]+$rawdata["RevenueTTM"][21]+$rawdata["RevenueTTM"][22])."',";
       		$query .= "'".($rawdata["CostOperatingExpenses"][19]+$rawdata["CostOperatingExpenses"][20]+$rawdata["CostOperatingExpenses"][21]+$rawdata["CostOperatingExpenses"][22])."',";
       		$query .= "'".($rawdata["DepreciationExpense"][19]+$rawdata["DepreciationExpense"][20]+$rawdata["DepreciationExpense"][21]+$rawdata["DepreciationExpense"][22])."',";
      		$query .= "'".($rawdata["DilutedEPSNetIncomefromContinuingOperations"][19]+$rawdata["DilutedEPSNetIncomefromContinuingOperations"][20]+$rawdata["DilutedEPSNetIncomefromContinuingOperations"][21]+$rawdata["DilutedEPSNetIncomefromContinuingOperations"][22])."',";
                $query .= "'".$rawdata["DilutedWeightedAverageShares"][$PMRQRow]."',";
       		$query .= "'".($rawdata["AmortizationExpense"][19]+$rawdata["AmortizationExpense"][20]+$rawdata["AmortizationExpense"][21]+$rawdata["AmortizationExpense"][22])."',";
       		$query .= "'".($rawdata["BasicEPSNetIncomefromContinuingOperations"][19]+$rawdata["BasicEPSNetIncomefromContinuingOperations"][20]+$rawdata["BasicEPSNetIncomefromContinuingOperations"][21]+$rawdata["BasicEPSNetIncomefromContinuingOperations"][22])."',";
                $query .= "'".$rawdata["BasicWeightedAverageShares"][$PMRQRow]."',";
      		$query .= "'".($rawdata["GeneralAdministrativeExpense"][19]+$rawdata["GeneralAdministrativeExpense"][20]+$rawdata["GeneralAdministrativeExpense"][21]+$rawdata["GeneralAdministrativeExpense"][22])."',";
       		$query .= "'".($rawdata["IncomeAfterTaxes"][19]+$rawdata["IncomeAfterTaxes"][20]+$rawdata["IncomeAfterTaxes"][21]+$rawdata["IncomeAfterTaxes"][22])."',";
       		$query .= "'".($rawdata["LaborExpense"][19]+$rawdata["LaborExpense"][20]+$rawdata["LaborExpense"][21]+$rawdata["LaborExpense"][22])."',";
       		$query .= "'".($rawdata["NetIncomefromContinuingOperationsApplicabletoCommon"][19]+$rawdata["NetIncomefromContinuingOperationsApplicabletoCommon"][20]+$rawdata["NetIncomefromContinuingOperationsApplicabletoCommon"][21]+$rawdata["NetIncomefromContinuingOperationsApplicabletoCommon"][22])."',";
       		$query .= "'".($rawdata["InterestIncomeExpenseNet"][19]+$rawdata["InterestIncomeExpenseNet"][20]+$rawdata["InterestIncomeExpenseNet"][21]+$rawdata["InterestIncomeExpenseNet"][22])."',";
       		$query .= "'".($rawdata["NoncontrollingInterest"][19]+$rawdata["NoncontrollingInterest"][20]+$rawdata["NoncontrollingInterest"][21]+$rawdata["NoncontrollingInterest"][22])."',";
       		$query .= "'".($rawdata["NonoperatingGainsLosses"][19]+$rawdata["NonoperatingGainsLosses"][20]+$rawdata["NonoperatingGainsLosses"][21]+$rawdata["NonoperatingGainsLosses"][22])."',";
       		$query .= "'".($rawdata["OperatingExpenses"][19]+$rawdata["OperatingExpenses"][20]+$rawdata["OperatingExpenses"][21]+$rawdata["OperatingExpenses"][22])."',";
       		$query .= "'".($rawdata["OtherGeneralAdministrativeExpense"][19]+$rawdata["OtherGeneralAdministrativeExpense"][20]+$rawdata["OtherGeneralAdministrativeExpense"][21]+$rawdata["OtherGeneralAdministrativeExpense"][22])."',";
       		$query .= "'".($rawdata["OtherInterestIncomeExpenseNet"][19]+$rawdata["OtherInterestIncomeExpenseNet"][20]+$rawdata["OtherInterestIncomeExpenseNet"][21]+$rawdata["OtherInterestIncomeExpenseNet"][22])."',";
       		$query .= "'".($rawdata["OtherRevenue"][19]+$rawdata["OtherRevenue"][20]+$rawdata["OtherRevenue"][21]+$rawdata["OtherRevenue"][22])."',";
       		$query .= "'".($rawdata["OtherSellingGeneralAdministrativeExpenses"][19]+$rawdata["OtherSellingGeneralAdministrativeExpenses"][20]+$rawdata["OtherSellingGeneralAdministrativeExpenses"][21]+$rawdata["OtherSellingGeneralAdministrativeExpenses"][22])."',";
      		$query .= "'".($rawdata["PreferredDividends"][19]+$rawdata["PreferredDividends"][20]+$rawdata["PreferredDividends"][21]+$rawdata["PreferredDividends"][22])."',";
       		$query .= "'".($rawdata["SalesMarketingExpense"][19]+$rawdata["SalesMarketingExpense"][20]+$rawdata["SalesMarketingExpense"][21]+$rawdata["SalesMarketingExpense"][22])."',";
       		$query .= "'".($rawdata["TotalNonoperatingIncomeExpense"][19]+$rawdata["TotalNonoperatingIncomeExpense"][20]+$rawdata["TotalNonoperatingIncomeExpense"][21]+$rawdata["TotalNonoperatingIncomeExpense"][22])."',";
       		$query .= "'".($rawdata["TotalOperatingExpenses"][19]+$rawdata["TotalOperatingExpenses"][20]+$rawdata["TotalOperatingExpenses"][21]+$rawdata["TotalOperatingExpenses"][22])."',";
       		$query .= "'".($rawdata["OperatingRevenue"][19]+$rawdata["OperatingRevenue"][20]+$rawdata["OperatingRevenue"][21]+$rawdata["OperatingRevenue"][22])."'";
       		$query .= ")";
        	mysql_query($query) or die (mysql_error());

                $query = "INSERT INTO `ttm_financialscustom` (`ticker_id`, `COGSPercent`, `GrossMarginPercent`, `SGAPercent`, `RDPercent`, `DepreciationAmortizationPercent`, `EBITDAPercent`, `OperatingMarginPercent`, `EBITPercent`, `TaxRatePercent`, `IncomeAfterTaxes`, `NetMarginPercent`, `DividendsPerShare`, `ShortTermDebtAndCurrentPortion`, `TotalLongTermDebtAndNotesPayable`, `NetChangeLongTermDebt`, `CapEx`, `FreeCashFlow`, `OwnerEarningsFCF`) VALUES (";
                $query .= "'".$dates->ticker_id."',";
                $query .= "'".(($rawdata["CostofRevenue"][23]+$rawdata["CostofRevenue"][24]+$rawdata["CostofRevenue"][25]+$rawdata["CostofRevenue"][26])/($rawdata["TotalRevenue"][23]+$rawdata["TotalRevenue"][24]+$rawdata["TotalRevenue"][25]+$rawdata["TotalRevenue"][26]))."',";
                $query .= "'".(($rawdata["GrossProfit"][23]+$rawdata["GrossProfit"][24]+$rawdata["GrossProfit"][25]+$rawdata["GrossProfit"][26])/($rawdata["TotalRevenue"][23]+$rawdata["TotalRevenue"][24]+$rawdata["TotalRevenue"][25]+$rawdata["TotalRevenue"][26]))."',";
                $query .= "'".(($rawdata["SellingGeneralAdministrativeExpenses"][23]+$rawdata["SellingGeneralAdministrativeExpenses"][24]+$rawdata["SellingGeneralAdministrativeExpenses"][25]+$rawdata["SellingGeneralAdministrativeExpenses"][26])/($rawdata["TotalRevenue"][23]+$rawdata["TotalRevenue"][24]+$rawdata["TotalRevenue"][25]+$rawdata["TotalRevenue"][26]))."',";
                $query .= "'".(($rawdata["ResearchDevelopmentExpense"][23]+$rawdata["ResearchDevelopmentExpense"][24]+$rawdata["ResearchDevelopmentExpense"][25]+$rawdata["ResearchDevelopmentExpense"][26])/($rawdata["TotalRevenue"][23]+$rawdata["TotalRevenue"][24]+$rawdata["TotalRevenue"][25]+$rawdata["TotalRevenue"][26]))."',";
                $query .= "'".(($rawdata["CFDepreciationAmortization"][23]+$rawdata["CFDepreciationAmortization"][24]+$rawdata["CFDepreciationAmortization"][25]+$rawdata["CFDepreciationAmortization"][26])/($rawdata["TotalRevenue"][23]+$rawdata["TotalRevenue"][24]+$rawdata["TotalRevenue"][25]+$rawdata["TotalRevenue"][26]))."',";
                $query .= "'".(($rawdata["EBITDA"][23]+$rawdata["EBITDA"][24]+$rawdata["EBITDA"][25]+$rawdata["EBITDA"][26])/($rawdata["TotalRevenue"][23]+$rawdata["TotalRevenue"][24]+$rawdata["TotalRevenue"][25]+$rawdata["TotalRevenue"][26]))."',";
                $query .= "'".(($rawdata["OperatingProfit"][23]+$rawdata["OperatingProfit"][24]+$rawdata["OperatingProfit"][25]+$rawdata["OperatingProfit"][26])/($rawdata["TotalRevenue"][23]+$rawdata["TotalRevenue"][24]+$rawdata["TotalRevenue"][25]+$rawdata["TotalRevenue"][26]))."',";
                $query .= "'".(($rawdata["EBIT"][23]+$rawdata["EBIT"][24]+$rawdata["EBIT"][25]+$rawdata["EBIT"][26])/($rawdata["TotalRevenue"][23]+$rawdata["TotalRevenue"][24]+$rawdata["TotalRevenue"][25]+$rawdata["TotalRevenue"][26]))."',";
                $query .= "'".(($rawdata["IncomeTaxes"][23]+$rawdata["IncomeTaxes"][24]+$rawdata["IncomeTaxes"][25]+$rawdata["IncomeTaxes"][26])/($rawdata["IncomeBeforeTaxes"][23]+$rawdata["IncomeBeforeTaxes"][24]+$rawdata["IncomeBeforeTaxes"][25]+$rawdata["IncomeBeforeTaxes"][26]))."',";
                $query .= "'".(($rawdata["IncomeBeforeTaxes"][23]+$rawdata["IncomeBeforeTaxes"][24]+$rawdata["IncomeBeforeTaxes"][25]+$rawdata["IncomeBeforeTaxes"][26])-($rawdata["IncomeTaxes"][23]+$rawdata["IncomeTaxes"][24]+$rawdata["IncomeTaxes"][25]+$rawdata["IncomeTaxes"][26]))."',";
                $query .= "'".(($rawdata["NetIncome"][23]+$rawdata["NetIncome"][24]+$rawdata["NetIncome"][25]+$rawdata["NetIncome"][26])/($rawdata["TotalRevenue"][23]+$rawdata["TotalRevenue"][24]+$rawdata["TotalRevenue"][25]+$rawdata["TotalRevenue"][26]))."',";
		$query .= "'".(-($rawdata["DividendsPaid"][23]/(toFloat($rawdata["SharesOutstandingBasic"][23])*1000000))-($rawdata["DividendsPaid"][24]/(toFloat($rawdata["SharesOutstandingBasic"][24])*1000000))-($rawdata["DividendsPaid"][25]/(toFloat($rawdata["SharesOutstandingBasic"][25])*1000000))-($rawdata["DividendsPaid"][26]/(toFloat($rawdata["SharesOutstandingBasic"][26])*1000000)))."',";
		$query .= "'".($rawdata["CurrentPortionofLongtermDebt"][$MRQRow]+$rawdata["ShorttermBorrowings"][$MRQRow])."',";
		$query .= "'".($rawdata["TotalLongtermDebt"][$MRQRow]+$rawdata["NotesPayable"][$MRQRow])."',";
                $query .= "'".(($rawdata["LongtermDebtProceeds"][23]+$rawdata["LongtermDebtProceeds"][24]+$rawdata["LongtermDebtProceeds"][25]+$rawdata["LongtermDebtProceeds"][26])+($rawdata["LongtermDebtPayments"][23]+$rawdata["LongtermDebtPayments"][24]+$rawdata["LongtermDebtPayments"][25]+$rawdata["LongtermDebtPayments"][26]))."',";
                $query .= "'".(-($rawdata["CapitalExpenditures"][23]+$rawdata["CapitalExpenditures"][24]+$rawdata["CapitalExpenditures"][25]+$rawdata["CapitalExpenditures"][26]))."',";
                $query .= "'".(($rawdata["CashfromOperatingActivities"][23]+$rawdata["CashfromOperatingActivities"][24]+$rawdata["CashfromOperatingActivities"][25]+$rawdata["CashfromOperatingActivities"][26])+($rawdata["CapitalExpenditures"][23]+$rawdata["CapitalExpenditures"][24]+$rawdata["CapitalExpenditures"][25]+$rawdata["CapitalExpenditures"][26]))."',";
                $query .= "'".(($rawdata["CFNetIncome"][23]+$rawdata["CFNetIncome"][24]+$rawdata["CFNetIncome"][25]+$rawdata["CFNetIncome"][26])+($rawdata["CFDepreciationAmortization"][23]+$rawdata["CFDepreciationAmortization"][24]+$rawdata["CFDepreciationAmortization"][25]+$rawdata["CFDepreciationAmortization"][26])+($rawdata["EmployeeCompensation"][23]+$rawdata["EmployeeCompensation"][24]+$rawdata["EmployeeCompensation"][25]+$rawdata["EmployeeCompensation"][26])+($rawdata["AdjustmentforSpecialCharges"][23]+$rawdata["AdjustmentforSpecialCharges"][24]+$rawdata["AdjustmentforSpecialCharges"][25]+$rawdata["AdjustmentforSpecialCharges"][26])+($rawdata["DeferredIncomeTaxes"][23]+$rawdata["DeferredIncomeTaxes"][24]+$rawdata["DeferredIncomeTaxes"][25]+$rawdata["DeferredIncomeTaxes"][26])+($rawdata["CapitalExpenditures"][23]+$rawdata["CapitalExpenditures"][24]+$rawdata["CapitalExpenditures"][25]+$rawdata["CapitalExpenditures"][26])-(($rawdata["ChangeinCurrentAssets"][23]+$rawdata["ChangeinCurrentAssets"][24]+$rawdata["ChangeinCurrentAssets"][25]+$rawdata["ChangeinCurrentAssets"][26])-($rawdata["ChangeinCurrentLiabilities"][23]+$rawdata["ChangeinCurrentLiabilities"][24]+$rawdata["ChangeinCurrentLiabilities"][25]+$rawdata["ChangeinCurrentLiabilities"][26])))."'";
        	$query .= ")";
	       	mysql_query($query) or die (mysql_error());

                $query = "INSERT INTO `pttm_financialscustom` (`ticker_id`, `COGSPercent`, `GrossMarginPercent`, `SGAPercent`, `RDPercent`, `DepreciationAmortizationPercent`, `EBITDAPercent`, `OperatingMarginPercent`, `EBITPercent`, `TaxRatePercent`, `IncomeAfterTaxes`, `NetMarginPercent`, `DividendsPerShare`, `ShortTermDebtAndCurrentPortion`, `TotalLongTermDebtAndNotesPayable`, `NetChangeLongTermDebt`, `CapEx`, `FreeCashFlow`, `OwnerEarningsFCF`) VALUES (";
                $query .= "'".$dates->ticker_id."',";
                $query .= "'".(($rawdata["CostofRevenue"][19]+$rawdata["CostofRevenue"][20]+$rawdata["CostofRevenue"][21]+$rawdata["CostofRevenue"][22])/($rawdata["TotalRevenue"][19]+$rawdata["TotalRevenue"][20]+$rawdata["TotalRevenue"][21]+$rawdata["TotalRevenue"][22]))."',";
                $query .= "'".(($rawdata["GrossProfit"][19]+$rawdata["GrossProfit"][20]+$rawdata["GrossProfit"][21]+$rawdata["GrossProfit"][22])/($rawdata["TotalRevenue"][19]+$rawdata["TotalRevenue"][20]+$rawdata["TotalRevenue"][21]+$rawdata["TotalRevenue"][22]))."',";
                $query .= "'".(($rawdata["SellingGeneralAdministrativeExpenses"][19]+$rawdata["SellingGeneralAdministrativeExpenses"][20]+$rawdata["SellingGeneralAdministrativeExpenses"][21]+$rawdata["SellingGeneralAdministrativeExpenses"][22])/($rawdata["TotalRevenue"][19]+$rawdata["TotalRevenue"][20]+$rawdata["TotalRevenue"][21]+$rawdata["TotalRevenue"][22]))."',";
                $query .= "'".(($rawdata["ResearchDevelopmentExpense"][19]+$rawdata["ResearchDevelopmentExpense"][20]+$rawdata["ResearchDevelopmentExpense"][21]+$rawdata["ResearchDevelopmentExpense"][22])/($rawdata["TotalRevenue"][19]+$rawdata["TotalRevenue"][20]+$rawdata["TotalRevenue"][21]+$rawdata["TotalRevenue"][22]))."',";
                $query .= "'".(($rawdata["CFDepreciationAmortization"][19]+$rawdata["CFDepreciationAmortization"][20]+$rawdata["CFDepreciationAmortization"][21]+$rawdata["CFDepreciationAmortization"][22])/($rawdata["TotalRevenue"][19]+$rawdata["TotalRevenue"][20]+$rawdata["TotalRevenue"][21]+$rawdata["TotalRevenue"][22]))."',";
                $query .= "'".(($rawdata["EBITDA"][19]+$rawdata["EBITDA"][20]+$rawdata["EBITDA"][21]+$rawdata["EBITDA"][22])/($rawdata["TotalRevenue"][19]+$rawdata["TotalRevenue"][20]+$rawdata["TotalRevenue"][21]+$rawdata["TotalRevenue"][22]))."',";
                $query .= "'".(($rawdata["OperatingProfit"][19]+$rawdata["OperatingProfit"][20]+$rawdata["OperatingProfit"][21]+$rawdata["OperatingProfit"][22])/($rawdata["TotalRevenue"][19]+$rawdata["TotalRevenue"][20]+$rawdata["TotalRevenue"][21]+$rawdata["TotalRevenue"][22]))."',";
                $query .= "'".(($rawdata["EBIT"][19]+$rawdata["EBIT"][20]+$rawdata["EBIT"][21]+$rawdata["EBIT"][22])/($rawdata["TotalRevenue"][19]+$rawdata["TotalRevenue"][20]+$rawdata["TotalRevenue"][21]+$rawdata["TotalRevenue"][22]))."',";
                $query .= "'".(($rawdata["IncomeTaxes"][19]+$rawdata["IncomeTaxes"][20]+$rawdata["IncomeTaxes"][21]+$rawdata["IncomeTaxes"][22])/($rawdata["IncomeBeforeTaxes"][19]+$rawdata["IncomeBeforeTaxes"][20]+$rawdata["IncomeBeforeTaxes"][21]+$rawdata["IncomeBeforeTaxes"][22]))."',";
                $query .= "'".(($rawdata["IncomeBeforeTaxes"][19]+$rawdata["IncomeBeforeTaxes"][20]+$rawdata["IncomeBeforeTaxes"][21]+$rawdata["IncomeBeforeTaxes"][22])-($rawdata["IncomeTaxes"][19]+$rawdata["IncomeTaxes"][20]+$rawdata["IncomeTaxes"][21]+$rawdata["IncomeTaxes"][22]))."',";
                $query .= "'".(($rawdata["NetIncome"][19]+$rawdata["NetIncome"][20]+$rawdata["NetIncome"][21]+$rawdata["NetIncome"][22])/($rawdata["TotalRevenue"][19]+$rawdata["TotalRevenue"][20]+$rawdata["TotalRevenue"][21]+$rawdata["TotalRevenue"][22]))."',";
		$query .= "'".(-($rawdata["DividendsPaid"][19]/(toFloat($rawdata["SharesOutstandingBasic"][19])*1000000))-($rawdata["DividendsPaid"][20]/(toFloat($rawdata["SharesOutstandingBasic"][20])*1000000))-($rawdata["DividendsPaid"][21]/(toFloat($rawdata["SharesOutstandingBasic"][21])*1000000))-($rawdata["DividendsPaid"][22]/(toFloat($rawdata["SharesOutstandingBasic"][22])*1000000)))."',";
                $query .= "'".($rawdata["CurrentPortionofLongtermDebt"][$PMRQRow]+$rawdata["ShorttermBorrowings"][$PMRQRow])."',";
                $query .= "'".($rawdata["TotalLongtermDebt"][$PMRQRow]+$rawdata["NotesPayable"][$PMRQRow])."',";
                $query .= "'".(($rawdata["LongtermDebtProceeds"][19]+$rawdata["LongtermDebtProceeds"][20]+$rawdata["LongtermDebtProceeds"][21]+$rawdata["LongtermDebtProceeds"][22])+($rawdata["LongtermDebtPayments"][19]+$rawdata["LongtermDebtPayments"][20]+$rawdata["LongtermDebtPayments"][21]+$rawdata["LongtermDebtPayments"][22]))."',";
                $query .= "'".(-($rawdata["CapitalExpenditures"][19]+$rawdata["CapitalExpenditures"][20]+$rawdata["CapitalExpenditures"][21]+$rawdata["CapitalExpenditures"][22]))."',";
                $query .= "'".(($rawdata["CashfromOperatingActivities"][19]+$rawdata["CashfromOperatingActivities"][20]+$rawdata["CashfromOperatingActivities"][21]+$rawdata["CashfromOperatingActivities"][22])+($rawdata["CapitalExpenditures"][19]+$rawdata["CapitalExpenditures"][20]+$rawdata["CapitalExpenditures"][21]+$rawdata["CapitalExpenditures"][22]))."',";
                $query .= "'".(($rawdata["CFNetIncome"][19]+$rawdata["CFNetIncome"][20]+$rawdata["CFNetIncome"][21]+$rawdata["CFNetIncome"][22])+($rawdata["CFDepreciationAmortization"][19]+$rawdata["CFDepreciationAmortization"][20]+$rawdata["CFDepreciationAmortization"][21]+$rawdata["CFDepreciationAmortization"][22])+($rawdata["EmployeeCompensation"][19]+$rawdata["EmployeeCompensation"][20]+$rawdata["EmployeeCompensation"][21]+$rawdata["EmployeeCompensation"][22])+($rawdata["AdjustmentforSpecialCharges"][19]+$rawdata["AdjustmentforSpecialCharges"][20]+$rawdata["AdjustmentforSpecialCharges"][21]+$rawdata["AdjustmentforSpecialCharges"][22])+($rawdata["DeferredIncomeTaxes"][19]+$rawdata["DeferredIncomeTaxes"][20]+$rawdata["DeferredIncomeTaxes"][21]+$rawdata["DeferredIncomeTaxes"][22])+($rawdata["CapitalExpenditures"][19]+$rawdata["CapitalExpenditures"][20]+$rawdata["CapitalExpenditures"][21]+$rawdata["CapitalExpenditures"][22])-(($rawdata["ChangeinCurrentAssets"][19]+$rawdata["ChangeinCurrentAssets"][20]+$rawdata["ChangeinCurrentAssets"][21]+$rawdata["ChangeinCurrentAssets"][22])-($rawdata["ChangeinCurrentLiabilities"][19]+$rawdata["ChangeinCurrentLiabilities"][20]+$rawdata["ChangeinCurrentLiabilities"][21]+$rawdata["ChangeinCurrentLiabilities"][22])))."'";
        	$query .= ")";
	       	mysql_query($query) or die (mysql_error());
	}
}

function toFloat($num) {
    $dotPos = strrpos($num, '.');
    $commaPos = strrpos($num, ',');
    $sep = (($dotPos > $commaPos) && $dotPos) ? $dotPos : 
        ((($commaPos > $dotPos) && $commaPos) ? $commaPos : false);
   
    if (!$sep) {
        return floatval(preg_replace("/[^\-0-9]/", "", $num));
    } 

    return floatval(
        preg_replace("/[^\-0-9]/", "", substr($num, 0, $sep)) . '.' .
        preg_replace("/[^\-0-9]/", "", substr($num, $sep+1, strlen($num)))
    );
}
?>
